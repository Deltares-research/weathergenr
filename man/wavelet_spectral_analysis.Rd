% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelet_spectral_analysis.R
\name{wavelet_spectral_analysis}
\alias{wavelet_spectral_analysis}
\title{Wavelet Spectral Analysis with Significance Testing}
\usage{
wavelet_spectral_analysis(
  variable,
  signif.level = 0.9,
  noise.type = "red",
  period.lower.limit = 2,
  detrend = FALSE
)
}
\arguments{
\item{variable}{Numeric vector representing the time series (e.g., annual precipitation).
Must have at least 32 observations for reliable wavelet analysis.}

\item{signif.level}{Numeric between 0 and 1. Significance level for test (default = 0.90).}

\item{noise.type}{Character: "white" or "red" (default). Background noise model for
significance testing. For "red", lag-1 autocorrelation is computed from the data.}

\item{period.lower.limit}{Numeric; minimum period (in time units) to consider
significant (default = 2). Filters out very high-frequency noise.}
}
\value{
A list with:
  \item{GWS}{Numeric vector: Global Wavelet Spectrum (average power across time)}
  \item{GWS_signif}{Numeric vector: Significance threshold for GWS at each period}
  \item{GWS_period}{Numeric vector: Period (in time units) corresponding to each scale}
  \item{signif_periods}{Integer vector: Indices of periods with significant power, or NULL if none}
  \item{wave}{Complex matrix: Wavelet transform coefficients (scales x time)}
  \item{power}{Numeric matrix: Wavelet power spectrum (scales x time)}
  \item{COMPS}{Data frame: Reconstructed components for each significant period band,
    plus residual NOISE component. NULL if no significant periods found.}
}
\description{
Performs continuous wavelet transform analysis using the Morlet mother wavelet
on a time series. Computes the global wavelet spectrum with significance levels
and optionally reconstructs signal components from significant frequency bands.
}
\details{
The function tests wavelet power against a background noise spectrum (white or red)
and identifies periods with statistically significant power. Component extraction
reconstructs the time series contributions from significant frequency bands.


This implementation uses the Morlet mother wavelet with omega0 = 6. Significance
testing follows Torrence and Compo (1998). For red noise, the lag-1 autocorrelation
is estimated from the input time series. Cone of influence and edge effects are
accounted for during significance calculations.
}
\examples{
set.seed(123)
# Simulate AR(1) process with 8-year periodicity
years <- 1:128
signal <- 2 * sin(2 * pi * years / 8) + arima.sim(n = 128, model = list(ar = 0.7))
res <- wavelet_spectral_analysis(signal, noise.type = "red")

# Display significant periods
if (!is.null(res$signif_periods)) {
  cat("Significant periods (years):",
      round(res$GWS_period[res$signif_periods], 2), "\n")
}

}
\references{
Torrence C and Compo GP (1998): A Practical Guide to Wavelet Analysis.
Bull. Amer. Meteor. Soc., 79, 61-78.
}
