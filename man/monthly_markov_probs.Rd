% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/monthly_markov_probs.R
\name{monthly_markov_probs}
\alias{monthly_markov_probs}
\title{Estimate Monthly Occurrence-State Markov Transition Probabilities}
\usage{
monthly_markov_probs(
  PRCP_LAG0,
  PRCP_LAG1,
  MONTH_LAG0,
  MONTH_LAG1,
  YEAR_LAG0 = NULL,
  YEAR_LAG1 = NULL,
  wet_threshold,
  extreme_threshold,
  month_list,
  MONTH_SIM,
  WATER_YEAR_SIM,
  y,
  START_YEAR_SIM,
  dry.spell.change,
  wet.spell.change,
  SIM_LENGTH,
  alpha = 1
)
}
\arguments{
\item{PRCP_LAG0}{Numeric vector. Observed daily precipitation at lag 0
(current day) used to estimate state transitions.}

\item{PRCP_LAG1}{Numeric vector. Observed daily precipitation at lag 1
(previous day) used to estimate state transitions.}

\item{MONTH_LAG0}{Integer vector (1-12). Calendar month corresponding to
PRCP_LAG0.}

\item{MONTH_LAG1}{Integer vector (1-12). Calendar month corresponding to
PRCP_LAG1.}

\item{YEAR_LAG0}{Optional integer vector. Calendar year or water year
corresponding to PRCP_LAG0. If provided together with YEAR_LAG1,
transitions are restricted to same-year pairs.}

\item{YEAR_LAG1}{Optional integer vector. Calendar year or water year
corresponding to PRCP_LAG1.}

\item{wet_threshold}{Numeric vector of length 12. Monthly precipitation
thresholds separating dry and wet states, aligned to month_list.}

\item{extreme_threshold}{Numeric vector of length 12. Monthly precipitation
thresholds separating wet and very wet states, aligned to month_list.}

\item{month_list}{Integer vector of length 12 defining the simulated ordering
of months (for example 1:12 for calendar years or c(10:12, 1:9) for
October-start water years).}

\item{MONTH_SIM}{Integer vector. Calendar month for each simulated day.}

\item{WATER_YEAR_SIM}{Integer vector. Simulation year (calendar or water year,
depending on regime) for each simulated day.}

\item{y}{Integer. Index of the current simulated year (1-based).}

\item{START_YEAR_SIM}{Integer. First year of the simulation, interpreted as a
calendar year or water year depending on the simulation regime.}

\item{dry.spell.change}{Numeric vector of length 12. Monthly multiplicative
factors controlling dry-state persistence.}

\item{wet.spell.change}{Numeric vector of length 12. Monthly multiplicative
factors controlling wet-state persistence.}

\item{SIM_LENGTH}{Integer. Total number of simulated days. Determines the
length of the returned probability vectors.}

\item{alpha}{Numeric. Base smoothing strength for transition-probability
estimation. The effective smoothing applied in each month is
alpha / sqrt(N_m), where N_m is the number of observed transitions
in that month.}
}
\value{
A named list of nine numeric vectors, each of length SIM_LENGTH,
representing time-varying transition probabilities:
\itemize{
  \item p00_final: P(dry to dry)
  \item p01_final: P(dry to wet)
  \item p02_final: P(dry to very wet)
  \item p10_final: P(wet to dry)
  \item p11_final: P(wet to wet)
  \item p12_final: P(wet to very wet)
  \item p20_final: P(very wet to dry)
  \item p21_final: P(very wet to wet)
  \item p22_final: P(very wet to very wet)
}
}
\description{
Estimates month-specific transition probabilities for a three-state
precipitation occurrence Markov chain (dry, wet, very wet) from observed
daily precipitation data, and maps these probabilities onto a simulated
time axis.

Transition probabilities are inferred from observed lag-1 to lag-0
precipitation pairs using month-dependent wet and extreme thresholds.
A Dirichlet-type smoothing is applied to avoid zero-probability transitions,
with the effective smoothing strength decreasing automatically with the
number of observed transitions per month.

The function supports both calendar-year and water-year simulations.
The regime is inferred from month_list: if month_list[1] == 1,
calendar-year logic is used; otherwise, water-year logic is assumed.

Optional spell-persistence modifiers are applied to dry and wet states to
influence transition persistence. After these adjustments, transition
probabilities are explicitly normalized to ensure stochastic validity
(non-negativity and rows summing to one).

The estimated monthly transition probabilities are assigned to all simulated
days that fall within the target simulation year and corresponding calendar
month.
}
\details{
Precipitation occurrence states are defined as:
\describe{
  \item{Dry}{Precipitation less than or equal to the monthly wet threshold}
  \item{Wet}{Precipitation greater than the wet threshold and less than or
             equal to the extreme threshold}
  \item{Very wet}{Precipitation greater than the extreme threshold}
}

All transition-probability rows are explicitly normalized after smoothing and
spell adjustments to ensure valid Markov-chain behavior.
}
