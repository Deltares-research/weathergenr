% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/climate_perturbations.R
\name{apply_climate_perturbations}
\alias{apply_climate_perturbations}
\title{Apply monthly climate perturbations to gridded daily weather series}
\usage{
apply_climate_perturbations(
  data = NULL,
  grid = NULL,
  date = NULL,
  prcp_mean_factor = NULL,
  prcp_var_factor = NULL,
  temp_delta = NULL,
  temp_transient = TRUE,
  prcp_transient = TRUE,
  compute_pet = TRUE,
  pet_method = "hargreaves",
  qm_fit_method = "mme",
  verbose = FALSE
)
}
\arguments{
\item{data}{List of data.frames, one per grid cell. Each data.frame must contain:
\itemize{
  \item \code{prcp} (daily precipitation)
  \item \code{temp} (daily mean temperature)
  \item \code{temp_min} (daily minimum temperature)
  \item \code{temp_max} (daily maximum temperature)
}
If \code{compute_pet = TRUE}, \code{pet} is added or overwritten.}

\item{grid}{data.frame of grid metadata with \code{nrow(grid) == length(data)}.
Must include column \code{lat} (latitude in decimal degrees).}

\item{date}{Date vector of length \code{nrow(data[[i]])} (identical across cells).}

\item{prcp_mean_factor}{Numeric vector length 12. Monthly multiplicative factors
for precipitation mean.}

\item{prcp_var_factor}{Numeric vector length 12. Monthly multiplicative factors
for precipitation variance.}

\item{temp_delta}{Numeric vector length 12. Monthly additive temperature deltas (degC)
applied to \code{temp}, \code{temp_min}, and \code{temp_max}.}

\item{temp_transient}{Logical. If \code{TRUE}, temperature deltas ramp linearly
from 0 to \code{2 * temp_delta} over years (mean equals \code{temp_delta}).}

\item{prcp_transient}{Logical. If \code{TRUE}, precipitation factors ramp linearly
from 1 to \code{(factor - 1) * 2 + 1} over years.}

\item{compute_pet}{Logical. If \code{TRUE}, recompute PET using
\code{\link{calculate_monthly_pet}}.}

\item{pet_method}{Character. PET method passed to
\code{\link{calculate_monthly_pet}} (default: \code{"hargreaves"}).}

\item{qm_fit_method}{Character. Distribution-fitting method for
\code{perturb_prcp_qm()}.}

\item{verbose}{Logical. Emit progress logs.}
}
\value{
List of data.frames with perturbed variables.
}
\description{
Applies **monthly** climate perturbations to **daily** gridded weather series:
\itemize{
  \item **Precipitation** is perturbed using quantile mapping with monthly
  mean and variance factors via \code{perturb_prcp_qm()}.
  \item **Temperature** (\code{temp}, \code{temp_min}, \code{temp_max}) is perturbed
  using monthly additive deltas (step or transient).
  \item **Potential evapotranspiration (PET)** can be recomputed from perturbed
  temperatures using \code{calculate_monthly_pet()}.
}

Perturbations can be applied as a **step change** (constant in time) or as a
**transient change** (linearly ramping over years) while preserving the same
*mean* change over the simulation period.
}
\seealso{
\code{\link{perturb_prcp_qm}}, \code{\link{diagnose_prcp_qm}},
  \code{\link{calculate_monthly_pet}}
}
