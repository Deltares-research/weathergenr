% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/climate_perturbations.R
\name{apply_climate_perturbations}
\alias{apply_climate_perturbations}
\title{Apply climate-change perturbations to gridded daily weather data}
\usage{
apply_climate_perturbations(
  climate.data = NULL,
  climate.grid = NULL,
  sim.dates = NULL,
  change.factor.precip.mean = NULL,
  change.factor.precip.variance = NULL,
  change.factor.temp.mean = NULL,
  transient.temp.change = TRUE,
  transient.precip.change = TRUE,
  calculate.pet = TRUE,
  fit.method = "mme",
  verbose = FALSE
)
}
\arguments{
\item{climate.data}{List of data.frames, one per grid cell. Each data.frame must
contain columns \code{precip}, \code{temp}, \code{temp_min}, \code{temp_max}.
If \code{calculate.pet = TRUE}, \code{pet} will be (re)computed and added/overwritten.}

\item{climate.grid}{data.frame of grid metadata. Must have \code{nrow(climate.grid) == length(climate.data)}
and include column \code{y} (latitude in decimal degrees).}

\item{sim.dates}{Date vector of length \code{nrow(climate.data[[i]])} for all cells.}

\item{change.factor.precip.mean}{Numeric vector length 12. Monthly multiplicative factors
for precipitation mean (target mean change over the simulation period).}

\item{change.factor.precip.variance}{Numeric vector length 12. Monthly multiplicative factors
for precipitation variance.}

\item{change.factor.temp.mean}{Numeric vector length 12. Monthly additive temperature deltas (Â°C).}

\item{transient.temp.change}{Logical. If TRUE, temperature deltas ramp linearly from 0 to
\code{2 * change.factor.temp.mean} over years (so the average over years equals the specified delta).
If FALSE, applies step deltas (constant over years).}

\item{transient.precip.change}{Logical. If TRUE, precipitation factors ramp linearly from 1 to
\code{(factor - 1) * 2 + 1} over years (so the average over years equals the specified factor).
If FALSE, applies step factors (constant over years).}

\item{calculate.pet}{Logical. If TRUE, recompute PET using \code{\link{pet_hargreaves}} from perturbed temperatures.}

\item{fit.method}{Character. Distribution fitting method passed to \code{\link{quantile_mapping}}.}

\item{verbose}{Logical scalar. If TRUE, emit progress logs via \code{.log_info()}.}
}
\value{
List of data.frames, same length and row counts as \code{climate.data}, containing perturbed variables.
}
\description{
Applies monthly climate-change perturbations to gridded daily weather data by:
\itemize{
  \item adjusting precipitation via quantile mapping with monthly mean/variance factors, and
  \item shifting temperature (mean/min/max) via monthly additive deltas.
}

Perturbations can be applied as a step change (constant over time) or a transient
change (linearly ramping over years) while preserving the same *mean* change over
the simulation period.
}
\details{
Transient precipitation factors are constrained to be at least 0.01 to avoid numerical issues.
After perturbations, any \code{Inf} or \code{NaN} values are replaced with 0 (for all columns).
}
\seealso{
\code{\link{quantile_mapping}}, \code{\link{pet_hargreaves}}
}
