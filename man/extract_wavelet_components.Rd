% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelet_helpers.R
\name{extract_wavelet_components}
\alias{extract_wavelet_components}
\title{Extract and Reconstruct Wavelet Components from Significant Periods}
\usage{
extract_wavelet_components(
  wave,
  signif_periods,
  scale,
  dj = 0.25,
  dt = 1,
  variable_sd,
  Cdelta = 0.776,
  w0_0 = pi^(-1/4)
)
}
\arguments{
\item{wave}{Complex matrix. Wavelet transform coefficients with dimensions
(scales x time). Output from continuous wavelet transform.}

\item{signif_periods}{Integer vector. Indices of significant period scales
to reconstruct. Each index corresponds to a row in \code{wave}.}

\item{scale}{Numeric vector. Scale values corresponding to rows of \code{wave}.}

\item{dj}{Numeric scalar. Scale resolution parameter used in wavelet transform
(default = 0.25). Smaller values give finer resolution.}

\item{dt}{Numeric scalar. Time step of the original series (default = 1).}

\item{variable_sd}{Numeric scalar. Standard deviation of the original time series
before standardization. Used to restore original units.}

\item{Cdelta}{Numeric scalar. Reconstruction constant for Morlet wavelet
(default = 0.776). Depends on wavelet type; see Torrence & Compo (1998) Table 2.}

\item{w0_0}{Numeric scalar. Normalization constant \eqn{\psi_0(0) = \pi^{-1/4}}
for Morlet wavelet (default = \code{pi^(-1/4)}).}
}
\value{
A tibble with one column per significant period component.
  Column names are \code{Component_1}, \code{Component_2}, etc.
  Number of rows equals the length of the original time series.
}
\description{
Reconstructs time series components from the wavelet transform for
user-specified significant periods. Uses the inverse continuous wavelet
transform formula to convert wavelet coefficients back to time domain.
}
\details{
The reconstruction formula (Torrence & Compo 1998, Eq. 11) is:
\deqn{x_n = \frac{\delta j \sqrt{\delta t}}{C_\delta \psi_0(0)}
      \sum_{j=0}^{J} \frac{\text{Re}(W_n(s_j))}{\sqrt{s_j}}}

Each component represents the contribution of a specific frequency band
to the original time series. Components can be summed to approximate
the original signal (within the limits of the selected periods).
}
\examples{
\dontrun{
# After performing wavelet analysis
components <- extract_wavelet_components(
  wave = wave_transform,
  signif_periods = c(5, 10, 20),  # indices of significant scales
  scale = scale_vector,
  dj = 0.25,
  dt = 1,
  variable_sd = sd(original_data),
  Cdelta = 0.776
)

# Components sum to approximate original signal
reconstructed <- rowSums(components)
}

}
\references{
Torrence, C. and Compo, G.P. (1998). A Practical Guide to Wavelet Analysis.
\emph{Bulletin of the American Meteorological Society}, 79(1), 61-78.
See Section 3i and Table 2.
}
\keyword{internal}
