% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelet_cwt.R
\name{analyze_wavelet_spectrum}
\alias{analyze_wavelet_spectrum}
\title{Continuous Wavelet Spectral Analysis with COI-Aware Significance}
\usage{
analyze_wavelet_spectrum(
  series,
  signif = 0.9,
  noise = "red",
  min_period = 2,
  detrend = FALSE,
  mode = c("fast", "complete"),
  diagnostics = FALSE,
  lag1_ci = FALSE,
  lag1_ci_level = 0.95,
  lag1_boot_n = 500,
  seed = NULL,
  warn_neff = FALSE,
  neff_warn_min = 5,
  neff_warn_frac = 0.6
)
}
\arguments{
\item{series}{Numeric vector. Input time series (regularly spaced, no missing values).
Minimum length is 16 observations.}

\item{signif}{Numeric scalar in (0, 1). Significance level for wavelet power and GWS
tests. Default is 0.90.}

\item{noise}{Character. Background noise model for significance testing. One of
\code{"white"} or \code{"red"} (default). For red noise, an AR(1) model is estimated.}

\item{min_period}{Numeric scalar. Minimum Fourier period (in time units) used when
identifying significant scales (default: 2).}

\item{detrend}{Logical. If \code{TRUE}, removes a linear-trend slope only (mean preserved)
prior to analysis (default: \code{FALSE}).}

\item{mode}{Character. \code{"fast"} (default) returns essential outputs only; \code{"complete"}
additionally returns pointwise significance and (optionally) reconstruction products.}

\item{diagnostics}{Logical. If \code{TRUE}, returns an additional \code{diagnostics} list.
When \code{mode = "complete"}, diagnostics also include reconstruction error metrics
when reconstructed components are computed.}

\item{lag1_ci}{Logical. If \code{TRUE}, computes a bootstrap confidence interval for the AR(1)
coefficient (diagnostic only; does not affect inference).}

\item{lag1_ci_level}{Numeric scalar in (0, 1). Confidence level for the AR(1) bootstrap interval.}

\item{lag1_boot_n}{Integer. Number of bootstrap replicates for the AR(1) interval (>= 50).}

\item{seed}{Optional numeric scalar. Random seed used for bootstrap diagnostics.}

\item{warn_neff}{Logical. If \code{TRUE}, warns when effective sample size is small for
most scales.}

\item{neff_warn_min}{Numeric scalar. Threshold below which neff is considered small.}

\item{neff_warn_frac}{Numeric scalar in (0, 1). Fraction of scales with \code{neff < neff_warn_min}
required to trigger a warning.}
}
\value{
A list. Always includes (at minimum):
\describe{
  \item{gws}{Numeric vector. COI-masked global wavelet spectrum.}
  \item{gws_unmasked}{Numeric vector. Unmasked global wavelet spectrum (plotting only).}
  \item{period}{Numeric vector. Fourier periods corresponding to wavelet scales.}
  \item{gws_signif}{Numeric vector. COI- and neff-corrected GWS significance threshold (inference).}
  \item{gws_signif_unmasked}{Numeric vector. Unmasked GWS significance threshold (plotting only).}
  \item{has_significance}{Logical. Whether any significant scales were detected.}
  \item{signif_periods}{Integer vector. Indices of significant scales retained (one per contiguous band).}
  \item{coi}{Numeric vector. Cone of influence in time units.}
  \item{power}{Numeric matrix. Wavelet power spectrum (scales x time).}
}

In \code{mode = "complete"}, additional fields may include:
\describe{
  \item{power_coi}{Numeric matrix. COI-masked wavelet power.}
  \item{sigm}{Numeric matrix. Pointwise significance ratio.}
  \item{sigm_coi}{Numeric matrix. COI-masked pointwise significance ratio.}
  \item{power_signif_coi}{Logical matrix. COI-masked pointwise significance mask.}
  \item{wave}{Complex matrix. Wavelet coefficients (scales x time).}
  \item{comps}{Numeric matrix. Reconstructed significant-scale components plus residual (if computed).}
  \item{comps_names}{Character vector. Component names.}
  \item{gws_n_coi}{Numeric vector. Number of time points inside COI per scale.}
  \item{neff}{Numeric vector. Effective sample size per scale (masked).}
  \item{neff_unmasked}{Numeric vector. Effective sample size per scale (unmasked).}
  \item{diagnostics}{List. Returned only when \code{diagnostics = TRUE}.}
}
}
\description{
Performs continuous wavelet transform (CWT) analysis using a Morlet mother wavelet
(Torrence & Compo, 1998) and returns wavelet power, cone of influence (COI),
global wavelet spectrum (GWS), and significance thresholds. The implementation includes:
\itemize{
  \item COI-aware global spectrum estimation,
  \item effective sample size (\code{neff}) based significance testing,
  \item AR(1) red-noise background estimation (Yule-Walker),
  \item optional scale-component reconstruction in \code{mode = "complete"}.
}

This function is intended for detection and diagnostic analysis of dominant
time scales. Reconstructed scale components are additive but not orthogonal.
For truly orthogonal decomposition suitable for ARIMA modeling, see
\code{\link{analyze_wavelet_orthogonal}} which combines CWT diagnostics with
MODWT-based orthogonal component extraction.
}
\references{
Torrence, C., & Compo, G. P. (1998). A practical guide to wavelet analysis.
\emph{Bulletin of the American Meteorological Society}, 79(1), 61-78.
}
\seealso{
\code{\link{morlet_wavelet}}, \code{\link{extract_wavelet_components}},
  \code{\link{analyze_wavelet_orthogonal}},
  \code{\link{plot_wavelet_power}}, \code{\link{plot_wavelet_global_spectrum}}
}
