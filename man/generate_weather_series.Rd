% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/generate_weather_series.R
\name{generate_weather_series}
\alias{generate_weather_series}
\title{Generate Synthetic Gridded Daily Weather Series}
\usage{
generate_weather_series(
  weather.data = NULL,
  weather.grid = NULL,
  weather.date = NULL,
  variables = NULL,
  sim.year.num = NULL,
  sim.year.start = 2020,
  month.start = 1,
  realization.num = 5,
  warm.variable = "precip",
  warm.signif.level = 0.9,
  warm.sample.num = 5000,
  warm.subset.criteria = list(mean = 0.1, sd = 0.1, min = 0.1, max = 0.1, sig.thr = 0.8,
    nsig.thr = 1.5),
  knn.sample.num = 120,
  mc.wet.quantile = 0.3,
  mc.extreme.quantile = 0.8,
  dry.spell.change = rep(1, 12),
  wet.spell.change = rep(1, 12),
  output.path = tempdir(),
  seed = NULL,
  compute.parallel = FALSE,
  num.cores = NULL
)
}
\arguments{
\item{weather.data}{A named list of data frames containing observed daily weather for each grid
cell. Each data frame must have one row per day (no leap days) and one column
per variable listed in \code{variables}.}

\item{weather.grid}{Data frame describing the spatial layout of grid cells. Must include at least
columns \code{id}, \code{xind}, \code{yind}, and spatial coordinates
\code{x}, \code{y}. Currently used for bookkeeping only.}

\item{weather.date}{Vector of class \code{Date} giving the observation dates corresponding to
\code{weather.data}. Must be identical for all grid cells.}

\item{variables}{Character vector giving the names of daily weather variables to simulate
(for example \code{c("precip", "temp")}).}

\item{sim.year.num}{Integer. Number of years to simulate. If \code{NULL}, defaults to the number
of complete historical years available.}

\item{sim.year.start}{Integer. First simulation year. Interpreted as a calendar year if
\code{month.start == 1}, otherwise as the first water year.}

\item{month.start}{Integer in \code{1:12}. First month of the simulation year. Use \code{1} for
calendar-year simulations, or another month (for example \code{10}) for
water-year simulations.}

\item{realization.num}{Integer. Number of independent stochastic realizations to generate.}

\item{warm.variable}{Character string giving the variable used for annual WARM modeling.
Typically a low-frequency driver such as precipitation.}

\item{warm.signif.level}{Numeric in (0, 1). Significance level used to retain low-frequency wavelet
components during WARM analysis.}

\item{warm.sample.num}{Integer. Number of candidate annual traces generated by the WARM model before
subsetting.}

\item{warm.subset.criteria}{Named list of numeric thresholds used to filter annual WARM traces based on
summary statistics (for example \code{mean}, \code{sd}, \code{min}, \code{max},
\code{sig.thr}, \code{nsig.thr}).}

\item{knn.sample.num}{Integer. Number of historical years sampled in the annual KNN step during
daily disaggregation.}

\item{mc.wet.quantile}{Numeric in (0, 1). Quantile used to define the wet-day threshold for the daily
Markov chain.}

\item{mc.extreme.quantile}{Numeric in (0, 1). Quantile used to define the extreme wet-day threshold for
the daily Markov chain.}

\item{dry.spell.change}{Numeric vector of length 12. Monthly adjustment factors controlling dry-spell
persistence in the Markov chain (\code{1} = no change).}

\item{wet.spell.change}{Numeric vector of length 12. Monthly adjustment factors controlling wet-spell
persistence in the Markov chain (\code{1} = no change).}

\item{output.path}{Character string. Directory where diagnostic figures and intermediate CSV
files (simulated dates and resampled dates) are written.}

\item{seed}{Optional integer. Base random seed for reproducibility.}

\item{compute.parallel}{Logical. If \code{TRUE}, daily disaggregation across realizations is performed
in parallel.}

\item{num.cores}{Integer. Number of CPU cores to use for parallel execution. If \code{NULL},
all available cores minus one are used.}
}
\value{
A list with two elements:
\describe{
  \item{resampled}{A data frame with one column per realization, giving the
  resampled historical dates corresponding to each simulated day.}
  \item{dates}{A \code{Date} vector giving the simulated daily time axis
  (365-day calendar, no leap days).}
}
}
\description{
Generates stochastic daily weather time series for one or more grid cells by
combining:
\itemize{
  \item annual low-frequency variability simulated using Wavelet
        Autoregressive Modeling (WARM),
  \item annual K-nearest-neighbor (KNN) selection of historical years,
  \item a three-state (dry, wet, extreme) daily Markov chain for spell
        persistence,
  \item daily KNN resampling of precipitation and temperature anomalies.
}

The function supports both calendar-year and water-year simulations.
The simulation regime is inferred automatically from \code{month.start}:
\itemize{
  \item \code{month.start == 1}: calendar-year simulation (January to December),
  \item \code{month.start != 1}: water-year simulation starting in the specified month.
}
}
\details{
The workflow consists of four main stages:

\enumerate{
  \item \strong{Preprocessing of historical data:}
        Leap days are removed, water years are computed, and grid-cell data
        are aggregated to basin or domain averages for annual modeling.

  \item \strong{Annual-scale simulation (WARM):}
        Low-frequency variability in the selected \code{warm.variable}
        (typically precipitation) is modeled using wavelet decomposition and
        autoregressive resampling. A subset of annual traces is retained based
        on user-defined summary-statistic criteria.

  \item \strong{Daily disaggregation:}
        For each simulated year, historical years are selected using annual
        KNN matching. Daily weather is generated sequentially using a
        three-state Markov chain (dry, wet, extreme) and daily KNN resampling
        of anomalies.

  \item \strong{Output construction:}
        For each realization, the function returns the sequence of resampled
        historical dates corresponding to the simulated daily weather.
}

All simulations are performed on a 365-day calendar (no leap days).
}
\references{
Steinschneider, S., Brown, C., & Lall, U. (2013).
A semiparametric multivariate, multisite weather generator with low-frequency
variability for use in climate risk assessments streamflow generators. \emph{Water Resources Research}.
}
