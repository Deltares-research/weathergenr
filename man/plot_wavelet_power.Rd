% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wavelet_plots.R
\name{plot_wavelet_power}
\alias{plot_wavelet_power}
\title{Plot Wavelet Power and Global Wavelet Spectrum}
\usage{
plot_wavelet_power(
  series,
  time = NULL,
  period,
  power,
  gws,
  gws_signif,
  coi,
  signif_mask,
  unit = "mm"
)
}
\arguments{
\item{series}{Numeric vector. The time series used to define the time dimension
(length must match the number of columns in \code{power}).}

\item{time}{Optional numeric vector of length \code{length(series)} used for the x-axis.
Must be strictly increasing. If \code{NULL}, uses \code{seq_len(length(series))}.}

\item{period}{Numeric vector of wavelet periods (scales), typically in years (or days),
strictly increasing.}

\item{power}{Numeric matrix of wavelet power with dimensions
\code{length(period) x length(series)}.}

\item{gws}{Numeric vector. Global wavelet spectrum (mean power for each \code{period}).
Must have length \code{length(period)}.}

\item{gws_signif}{Numeric vector. Significance threshold for \code{gws}. Must have length
\code{length(period)}.}

\item{coi}{Numeric vector of length \code{length(series)} giving the cone of influence
in the same units as \code{period}. Values outside the plotted period range are ignored.}

\item{signif_mask}{Numeric matrix with dimensions \code{length(period) x length(series)}.
A contour is drawn at \code{1}. This is typically a significance ratio or a binary mask
encoded as 0/1 (or NA).}

\item{unit}{Character. Unit label used in the global spectrum axis label (default: \code{"mm"}).}
}
\value{
A \code{patchwork} object combining the power-field panel and the global spectrum panel.
}
\description{
Produces a two-panel diagnostic figure for a 1D time series wavelet analysis:
(1) the time-period wavelet power field and (2) the global wavelet spectrum
(time-averaged power by period) with its significance threshold.
}
\details{
\strong{What this plot is for}
\itemize{
  \item Identify when specific periodicities are active in time (power field).
  \item Summarize dominant variability scales across the full record (global spectrum).
  \item Check edge effects and statistical significance (COI and contour).
}

\strong{Key plotting choices}
\itemize{
  \item Power is shown on a \eqn{\log_2} scale after discarding non-finite values and
  non-positive power.
  \item The power field is drawn on the native wavelet grid (no interpolation) using
  explicit cell boundaries, which avoids smoothing artifacts.
  \item Color limits are set using robust quantiles (5th-95th percentile) to avoid
  low-contrast fields when dynamic range is large.
}

\strong{Inputs must be consistent}
\itemize{
  \item \code{n_time = length(series)} and \code{n_period = length(period)}.
  \item \code{power} and \code{signif_mask} must have dimensions
  \code{n_period x n_time}.
  \item \code{coi} must have length \code{n_time}.
  \item \code{period} must be strictly increasing.
  \item If supplied, \code{time} must be strictly increasing and have length \code{n_time}.
}
}
\examples{
\dontrun{
# Assuming you computed wavelet outputs elsewhere:
# w <- analyze_wavelet_spectrum(series)
p <- plot_wavelet_power(
  series      = series,
  time        = years,
  period      = w$period,
  power       = w$power,
  gws         = w$gws,
  gws_signif  = w$gws_signif,
  coi         = w$coi,
  signif_mask = w$signif_mask,
  unit        = "mm"
)
print(p)
}

}
\seealso{
\code{\link{plot_wavelet_global_spectrum}} for a standalone global spectrum plot.
}
