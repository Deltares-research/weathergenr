% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qmap_diagnostics.R
\name{compute_monthly_diagnostics}
\alias{compute_monthly_diagnostics}
\title{Compute month-by-month diagnostics for quantile-mapped precipitation}
\usage{
compute_monthly_diagnostics(
  value.original,
  value.adjusted,
  mon.ts,
  mean.change = NULL,
  var.change = NULL,
  year.ts = NULL
)
}
\arguments{
\item{value.original}{Numeric vector. Original precipitation values.}

\item{value.adjusted}{Numeric vector. Adjusted precipitation values, same length as
\code{value.original}.}

\item{mon.ts}{Integer vector. Month index (1--12) for each observation.}

\item{mean.change}{Optional numeric matrix (n_years x 12). Target mean change factors
by year and month. If provided with \code{var.change} and \code{year.ts}, the function
computes mean absolute error to targets.}

\item{var.change}{Optional numeric matrix (n_years x 12). Target variance change factors
by year and month.}

\item{year.ts}{Optional integer vector. Year index for each observation. Required only
when comparing to \code{mean.change} and \code{var.change}.}
}
\value{
A data.frame with one row per month and columns including:
\code{original.mean}, \code{adjusted.mean}, \code{original.var}, \code{adjusted.var},
\code{n.obs}, \code{mean.ratio}, \code{var.ratio}. If targets are provided,
additional columns \code{target.mean.ratio}, \code{target.var.ratio}, \code{mean.error},
\code{var.error}, \code{mean.assessment}, \code{var.assessment} are included.
}
\description{
Computes monthly mean/variance diagnostics for original and adjusted precipitation,
optionally comparing achieved changes against target mean/variance change factors.
}
\details{
Monthly statistics are computed on indices where both series are strictly positive
(\code{value.original > 0 & value.adjusted > 0}) for each month. This isolates intensity
behavior from frequency effects. If target change matrices are provided, targets are
averaged across years using \code{colMeans(..., na.rm = TRUE)}.
}
\keyword{internal}
