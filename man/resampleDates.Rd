% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/resampleDates.R
\name{resampleDates}
\alias{resampleDates}
\title{Resample Daily Dates for Stochastic Weather Generation}
\usage{
resampleDates(
  PRCP_FINAL_ANNUAL_SIM,
  ANNUAL_PRCP,
  PRCP,
  TEMP,
  START_YEAR_SIM,
  k1,
  ymax,
  dates.d,
  sim.dates.d,
  YEAR_D,
  month.start = 1,
  knn.annual.sample.num = 50,
  wet.quantile = 0.2,
  extreme.quantile = 0.8,
  dry.spell.change = rep(1, 12),
  wet.spell.change = rep(1, 12),
  seed = NULL
)
}
\arguments{
\item{PRCP_FINAL_ANNUAL_SIM}{Numeric vector. Simulated annual precipitation totals, one per simulation year.}

\item{ANNUAL_PRCP}{Numeric vector. Observed historical annual precipitation totals, one per observed year.}

\item{PRCP}{Numeric vector. Observed daily precipitation series (length must match `dates.d`).}

\item{TEMP}{Numeric vector. Observed daily temperature series (e.g., mean temperature; length must match `dates.d`).}

\item{START_YEAR_SIM}{Integer. First year of the simulation period.}

\item{k1}{Integer. Simulation trace index (used as a seed modifier for reproducibility).}

\item{ymax}{Integer. Number of years to simulate (simulation period length).}

\item{dates.d}{Data frame. Observed period with columns: `date`, `month`, `day`, `wyear` (water year).}

\item{sim.dates.d}{Data frame. Simulation period with columns: `month`, `day`, `wyear`.}

\item{YEAR_D}{Integer vector. Water year for each observed day (length must match `dates.d`).}

\item{month.start}{Integer (1-12). First month of the water year (e.g., 1 for January).}

\item{knn.annual.sample.num}{Integer. Number of nearest neighbors to sample for annual KNN matching (default: 50).}

\item{wet.quantile}{Numeric (0-1). Quantile threshold for defining wet days (default: 0.2).}

\item{extreme.quantile}{Numeric (0-1). Quantile threshold for defining extreme wet days (default: 0.8).}

\item{dry.spell.change}{Numeric vector (length 12). Monthly adjustment factors for dry spell lengths (default: rep(1, 12)).}

\item{wet.spell.change}{Numeric vector (length 12). Monthly adjustment factors for wet spell lengths (default: rep(1, 12)).}

\item{seed}{Optional integer. Seed for random number generation to ensure reproducibility.}
}
\value{
A vector of `Date` objects representing the resampled daily dates for the simulation period.
}
\description{
Generates a simulated daily weather date sequence using a Markov Chain model and K-Nearest Neighbors (KNN) resampling,
conditioned on annual precipitation and climate statistics. This function is intended for stochastic weather generators,
producing daily dates that preserve the statistical characteristics and persistence of observed wet/dry/extreme spells.
}
\details{
This function resamples daily weather dates to create a synthetic weather sequence that matches both annual
and daily precipitation/temperature statistics of the observed record. The process involves:

1. **Annual selection:** For each simulation year, similar observed years are identified using KNN based on annual precipitation.
2. **Markov Chain simulation:** Daily precipitation states (dry, wet, extreme) are generated using a Markov Chain model, with transition probabilities estimated from the observed years and adjusted for each month.
3. **Daily KNN resampling:** For each simulated day, a corresponding observed day is selected via KNN based on standardized anomalies of precipitation and temperature, to match the simulated state and maintain realistic temporal structure.
4. **Spell adjustments:** `dry.spell.change` and `wet.spell.change` allow monthly control over the lengths of dry and wet spells in the synthetic sequence.

The result is a vector of `Date` objects for the synthetic daily weather sequence, preserving the statistical
properties of both annual and sub-annual (spell and state) variability.
}
\examples{
\dontrun{
sim_dates <- resampleDates(
  PRCP_FINAL_ANNUAL_SIM = runif(3, 900, 1100),
  ANNUAL_PRCP = runif(20, 900, 1100),
  PRCP = rnorm(7300, 3, 5),
  TEMP = rnorm(7300, 18, 5),
  START_YEAR_SIM = 2001,
  k1 = 1,
  ymax = 3,
  dates.d = data.frame(
    date = seq.Date(as.Date("2000-01-01"), as.Date("2019-12-31"), by = "day"),
    month = rep(1:12, each = 365, length.out = 7300),
    day = rep(1:31, length.out = 7300),
    wyear = rep(2000:2019, each = 365)
  ),
  sim.dates.d = data.frame(
    month = rep(1:12, each = 365, length.out = 1095),
    day = rep(1:31, length.out = 1095),
    wyear = rep(2001:2003, each = 365)
  ),
  YEAR_D = rep(2000:2019, each = 365),
  month.start = 1,
  seed = 123
)
head(sim_dates)
}

}
