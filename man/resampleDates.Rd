% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/resampleDates.R
\name{resampleDates}
\alias{resampleDates}
\title{Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic}
\usage{
resampleDates(
  PRCP_FINAL_ANNUAL_SIM,
  ANNUAL_PRCP,
  PRCP,
  TEMP,
  START_YEAR_SIM,
  k1,
  ymax,
  dates.d,
  sim.dates.d,
  month.start = 1,
  knn.annual.sample.num = 50,
  wet.quantile = 0.2,
  extreme.quantile = 0.8,
  dry.spell.change = rep(1, 12),
  wet.spell.change = rep(1, 12),
  seed = NULL
)
}
\arguments{
\item{PRCP_FINAL_ANNUAL_SIM}{Numeric vector of length `ymax`. Synthetic
annual precipitation totals generated by the annual model (for example
WARM), indexed by simulated year.}

\item{ANNUAL_PRCP}{Numeric vector. Observed annual precipitation totals
corresponding to historical water years.}

\item{PRCP}{Numeric vector. Observed daily precipitation values (no leap
days), aligned with `dates.d`.}

\item{TEMP}{Numeric vector. Observed daily temperature values (no leap
days), aligned with `dates.d`.}

\item{START_YEAR_SIM}{Integer. First simulation year (calendar year if
`month.start == 1`, otherwise first water year).}

\item{k1}{Integer. Realization index, used to perturb the random seed so
that multiple realizations are independent.}

\item{ymax}{Integer. Number of simulated years.}

\item{dates.d}{Data frame containing observed date information. Must
include columns `date`, `month`, `day`, and `wyear`.}

\item{sim.dates.d}{Data frame containing simulated date information
(no leap days). Must include columns `month`, `day`, and `wyear`.}

\item{month.start}{Integer in 1:12. First month of the simulation year.
Use 1 for calendar-year simulations, or another month for water-year
simulations.}

\item{knn.annual.sample.num}{Integer. Number of historical years sampled
in the annual KNN step.}

\item{wet.quantile}{Numeric between 0 and 1. Quantile used to define the
wet threshold for daily precipitation states.}

\item{extreme.quantile}{Numeric between 0 and 1. Quantile used to define
the very wet (extreme) precipitation threshold.}

\item{dry.spell.change}{Numeric vector of length 12. Monthly adjustment
factors controlling dry spell persistence in the Markov chain.}

\item{wet.spell.change}{Numeric vector of length 12. Monthly adjustment
factors controlling wet spell persistence in the Markov chain.}

\item{seed}{Optional integer. Base random seed for reproducibility.}
}
\value{
A `Date` vector of length equal to `nrow(sim.dates.d)`, giving the
resampled observed dates corresponding to each simulated day.
}
\description{
Resamples daily precipitation and temperature sequences by combining:
\itemize{
  \item annual K-nearest-neighbor (KNN) selection of observed years,
  \item a three-state Markov chain for wet and dry spell persistence,
  \item daily KNN resampling on precipitation and temperature anomalies.
}

The function supports both calendar-year and water-year simulations.
The regime is inferred automatically from `month.start`:
if `month.start == 1`, calendar-year logic is used; otherwise, water-year
logic is assumed.
}
\details{
For each simulated year, a subset of observed water years is selected
using annual KNN matching against `PRCP_FINAL_ANNUAL_SIM`. Daily weather
is then generated sequentially:

\enumerate{
  \item The first day of each simulated year is sampled from observed
        days matching the simulated month and day.
  \item Subsequent days are generated using a Markov chain to simulate
        wet and dry states.
  \item Conditional on the simulated state, candidate observed days are
        selected using calendar constraints and expanded search windows.
  \item A daily KNN step on precipitation and temperature anomalies is
        used to select the next-day weather values.
}

In calendar-year mode (`month.start == 1`), transitions that cross
December to January are explicitly excluded to avoid cross-year
contamination.
}
