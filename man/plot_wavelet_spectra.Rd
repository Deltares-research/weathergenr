% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_wavelet_spectra.R
\name{plot_wavelet_spectra}
\alias{plot_wavelet_spectra}
\title{Plot Wavelet Power Spectrum and Global Wavelet Spectrum}
\usage{
plot_wavelet_spectra(
  variable,
  variable.year = NULL,
  period,
  POWER,
  GWS,
  GWS_signif,
  coi,
  sigm,
  variable.unit = "mm"
)
}
\arguments{
\item{variable}{Numeric vector. The original time series (for length).}

\item{variable.year}{Numeric vector. Year labels for x-axis (optional).}

\item{period}{Numeric vector. Periods (scales) used in the wavelet transform.}

\item{POWER}{Matrix. Wavelet power spectrum (periods x time).}

\item{GWS}{Numeric vector. Global wavelet spectrum (mean power at each period).}

\item{GWS_signif}{Numeric vector. Significance threshold for the global wavelet spectrum.}

\item{coi}{Numeric vector. Cone of influence for each time point.}

\item{sigm}{Matrix. Significance mask or ratio (periods x time). Contour is drawn at 1.}

\item{variable.unit}{Character. Unit label for the variable (default is "mm").}
}
\value{
A patchwork plot object with the time-period power spectrum and global wavelet spectrum.
}
\description{
Creates a two-panel figure showing (i) the time-period wavelet power spectrum
(with cone of influence and significance contour) and (ii) the global wavelet
spectrum for a time series.
}
\details{
Key plotting choices for interpretability:
\itemize{
  \item Power is plotted on a log2 scale with robust color limits (5th-95th percentiles)
        to avoid a "washed out" field when the dynamic range is large.
  \item The spectrum is plotted on the native wavelet grid (no interpolation), avoiding
        smoothing/extrapolation artifacts that can flatten contrast.
  \item Uses a perceptually uniform \code{viridis} color scale.
}
}
