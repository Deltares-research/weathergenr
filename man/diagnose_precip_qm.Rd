% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/qm_diagnostics.R
\name{diagnose_precip_qm}
\alias{diagnose_precip_qm}
\title{Compute Diagnostics for Precipitation Quantile Mapping}
\usage{
diagnose_precip_qm(
  precip_ref,
  precip_adj,
  month = NULL,
  year = NULL,
  mean_factor = NULL,
  var_factor = NULL,
  wet_thresh = 0.1,
  probs = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99)
)
}
\arguments{
\item{precip_ref}{Numeric vector. Reference (original) precipitation values.}

\item{precip_adj}{Numeric vector. Adjusted precipitation values (same length as `precip_ref`).}

\item{month}{Integer vector (optional). Month index (1--12) for each observation.}

\item{year}{Integer vector (optional). Year index (1..n_years) for each observation.}

\item{mean_factor}{Numeric matrix (optional). Target mean scaling factors (n_years x 12).}

\item{var_factor}{Numeric matrix (optional). Target variance scaling factors (n_years x 12).}

\item{wet_thresh}{Numeric. Threshold for defining wet days (default = 0.1 mm).}

\item{probs}{Numeric vector. Quantile probabilities to evaluate.}
}
\value{
A list of class `precip_qm_diagnostics` with elements:
\itemize{
  \item `moments`: moment diagnostics table
  \item `quantiles`: quantile comparison table
  \item `extremes`: tail metrics table
  \item `temporal`: temporal metrics table (optional)
  \item `monthly`: month-by-month diagnostics table (optional)
  \item `spells`: wet/dry spell diagnostics table
  \item `drydays`: wet/dry frequency diagnostics table
  \item `summary`: compact summary list
}
}
\description{
Computes diagnostics comparing reference and quantile-mapped precipitation series.
Reports moment changes, quantiles, tail metrics, dry/wet-day frequencies, spell lengths,
and optional temporal/monthly patterns. When `mean_factor`/`var_factor` are provided
together with `month` and `year`, moment and monthly diagnostics are compared against
the intended perturbations (scenario-aware null hypothesis).
}
