% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/warm_filtering.R
\name{identify_significant_peaks}
\alias{identify_significant_peaks}
\title{Identify significant peaks in an observed global wavelet spectrum}
\usage{
identify_significant_peaks(gws, gws_signif, period, n_max = 3L)
}
\arguments{
\item{gws}{Numeric vector. Observed global wavelet spectrum values.}

\item{gws_signif}{Numeric vector or NULL. Significance curve aligned to
\code{gws}. Must have the same length as \code{gws}.}

\item{period}{Numeric vector. Period values associated with \code{gws}. Must
have the same length as \code{gws}.}

\item{n_max}{Integer scalar. Maximum number of significant peaks to return.}
}
\value{
Data frame with one row per selected peak and columns:
  \code{idx} index in the spectrum,
  \code{period} the period at the peak,
  \code{power} the peak power,
  \code{signif} the significance curve value at the peak,
  \code{snr} signal to noise ratio.
  Returns a data frame with zero rows if no significant peaks are found.
}
\description{
Detects local maxima in an observed global wavelet spectrum and keeps only
those peaks whose power exceeds the corresponding significance curve value.

Peaks are ranked by signal to noise ratio defined as power divided by
significance, then by power. Up to \code{n_max} peaks are returned.

If the significance curve is missing or is not aligned to \code{gws}, the
function returns an empty result, treating the significance information as
unavailable.
}
\keyword{internal}
