% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_markov_probs.R
\name{calculateMarkovProbs}
\alias{calculateMarkovProbs}
\title{Calculate Monthly Markov Transition Probabilities (Vectorized)}
\usage{
calculateMarkovProbs(
  PRCP_LAG0,
  PRCP_LAG1,
  MONTH_LAG0,
  MONTH_LAG1,
  wet_threshold,
  extreme_threshold,
  month_list,
  MONTH_SIM,
  WATER_YEAR_SIM,
  y,
  START_YEAR_SIM,
  dry.spell.change,
  wet.spell.change,
  SIM_LENGTH
)
}
\arguments{
\item{PRCP_LAG0}{Numeric vector, lag 0 (current day) precipitation for all days.}

\item{PRCP_LAG1}{Numeric vector, lag 1 (previous day) precipitation for all days.}

\item{MONTH_LAG0}{Integer vector, month (1-12) for lag 0 (current day) for all days.}

\item{MONTH_LAG1}{Integer vector, month (1-12) for lag 1 (previous day) for all days.}

\item{wet_threshold}{Numeric vector of length 12, monthly thresholds separating dry/wet.}

\item{extreme_threshold}{Numeric vector of length 12, monthly thresholds for "very wet" state.}

\item{month_list}{Integer vector of length 12, mapping simulation months to calendar months.}

\item{MONTH_SIM}{Integer vector, simulation months for each simulated day.}

\item{WATER_YEAR_SIM}{Integer vector, simulation water year for each simulated day.}

\item{y}{Integer, current simulated year index.}

\item{START_YEAR_SIM}{Integer, simulation's starting year.}

\item{dry.spell.change}{Numeric vector of length 12, adjustment factors for dry spell persistence.}

\item{wet.spell.change}{Numeric vector of length 12, adjustment factors for wet spell persistence.}

\item{SIM_LENGTH}{Integer, length of the simulation time series.}
}
\value{
A list with nine elements, each a numeric vector of length `SIM_LENGTH`:
  \item{p00_final}{P(dry???dry)}
  \item{p01_final}{P(dry???wet)}
  \item{p02_final}{P(dry???very wet)}
  \item{p10_final}{P(wet???dry)}
  \item{p11_final}{P(wet???wet)}
  \item{p12_final}{P(wet???very wet)}
  \item{p20_final}{P(very wet???dry)}
  \item{p21_final}{P(very wet???wet)}
  \item{p22_final}{P(very wet???very wet)}
}
\description{
Computes the monthly transition probabilities for a three-state Markov chain (dry, wet, very wet),
using daily lagged precipitation data and monthly thresholds. This function is fully vectorized for efficiency
and is designed for use within daily stochastic weather generators.
}
\details{
The function computes monthly state transition probabilities for a 3-state weather occurrence Markov chain,
with states defined by precipitation thresholds (dry, wet, very wet). Probabilities are adjusted
for spell persistence via user-supplied adjustment vectors.
}
