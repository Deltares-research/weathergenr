% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_markov_probs.R
\name{calculateMarkovProbs}
\alias{calculateMarkovProbs}
\title{Calculate Monthly Markov Transition Probabilities for a 3-State Chain}
\usage{
calculateMarkovProbs(
  PRCP_LAG0,
  PRCP_LAG1,
  MONTH_LAG0,
  MONTH_LAG1,
  YEAR_LAG0 = NULL,
  YEAR_LAG1 = NULL,
  wet_threshold,
  extreme_threshold,
  month_list,
  MONTH_SIM,
  WATER_YEAR_SIM,
  y,
  START_YEAR_SIM,
  dry.spell.change,
  wet.spell.change,
  SIM_LENGTH
)
}
\arguments{
\item{PRCP_LAG0}{Numeric vector. Precipitation at lag 0 (current day)
for observed transitions.}

\item{PRCP_LAG1}{Numeric vector. Precipitation at lag 1 (previous day)
for observed transitions.}

\item{MONTH_LAG0}{Integer vector (1-12). Calendar month corresponding
to `PRCP_LAG0`.}

\item{MONTH_LAG1}{Integer vector (1-12). Calendar month corresponding
to `PRCP_LAG1`.}

\item{YEAR_LAG0}{Optional integer vector. Year or water-year
corresponding to `PRCP_LAG0`. Used to enforce same-year lag filtering.}

\item{YEAR_LAG1}{Optional integer vector. Year or water-year
corresponding to `PRCP_LAG1`. Used to enforce same-year lag filtering.}

\item{wet_threshold}{Numeric vector of length 12. Monthly precipitation
thresholds separating dry and wet states, aligned to `month_list`.}

\item{extreme_threshold}{Numeric vector of length 12. Monthly
precipitation thresholds separating wet and very wet states, aligned
to `month_list`.}

\item{month_list}{Integer vector of length 12. Defines the simulated
year ordering of months (for example 1:12 for calendar year, or
c(10:12, 1:9) for an October-start water year).}

\item{MONTH_SIM}{Integer vector. Simulation calendar months for each
simulated day.}

\item{WATER_YEAR_SIM}{Integer vector. Simulation year (calendar or
water year, depending on regime) for each simulated day.}

\item{y}{Integer. Index of the current simulated year (1-based).}

\item{START_YEAR_SIM}{Integer. Starting year of the simulation.
Interpreted as a calendar year or water year depending on regime.}

\item{dry.spell.change}{Numeric vector of length 12. Monthly adjustment
factors controlling dry-spell persistence.}

\item{wet.spell.change}{Numeric vector of length 12. Monthly adjustment
factors controlling wet-spell persistence.}

\item{SIM_LENGTH}{Integer. Total number of simulated days. Determines
the length of the returned probability vectors.}
}
\value{
A named list of nine numeric vectors, each of length `SIM_LENGTH`:
\itemize{
  \item p00_final: P(dry to dry)
  \item p01_final: P(dry to wet)
  \item p02_final: P(dry to very wet)
  \item p10_final: P(wet to dry)
  \item p11_final: P(wet to wet)
  \item p12_final: P(wet to very wet)
  \item p20_final: P(very wet to dry)
  \item p21_final: P(very wet to wet)
  \item p22_final: P(very wet to very wet)
}
}
\description{
Computes month-specific transition probabilities for a three-state
precipitation occurrence Markov chain (dry, wet, very wet) using
lagged daily precipitation and month-dependent thresholds.

The function supports both calendar-year and water-year simulations.
The regime is inferred automatically from `month_list`:
if `month_list[1] == 1`, calendar-year logic is used; otherwise,
water-year logic is assumed.

Transition probabilities are estimated from observed lag-1 to lag-0
precipitation pairs, optionally filtered to enforce same-year lags
(recommended for calendar-year mode). Probabilities are then adjusted
for dry- and wet-spell persistence and assigned to the appropriate
simulated days of the target simulation year.
}
\details{
States are defined as:
\describe{
  \item{Dry}{Precipitation less than or equal to the monthly wet threshold}
  \item{Wet}{Precipitation greater than the wet threshold and less than
             or equal to the extreme threshold}
  \item{Very wet}{Precipitation greater than the extreme threshold}
}

If `YEAR_LAG0` and `YEAR_LAG1` are provided, transitions are filtered to
same-year pairs. If they are not provided and calendar-year mode is
active, a weaker month-based guard is applied to avoid December-January
cross-year contamination.

The estimated probabilities are assigned to all simulated days that fall
within the target simulation year and corresponding month.
}
