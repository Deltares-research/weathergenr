% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/waveletDecompose.R
\name{waveletDecompose}
\alias{waveletDecompose}
\title{Wavelet Decomposition of Time Series into Low-Frequency Components and Noise}
\usage{
waveletDecompose(
  variable = NULL,
  signif.periods = NULL,
  noise.type = "white",
  signif.level = 0.9,
  plot = TRUE,
  output.path = NULL
)
}
\arguments{
\item{variable}{Numeric vector. The time series to be decomposed (e.g., annual precipitation).}

\item{signif.periods}{List. Each element is a vector of integer scale indices representing significant periods,
as returned by \code{waveletAnalysis()} (see its \code{signif_periods} output).}

\item{noise.type}{Character string. Background noise type: either `"white"` (default) or `"red"`.}

\item{signif.level}{Numeric between 0 and 1. Significance level for wavelet significance testing (default 0.90).}

\item{plot}{Logical. If TRUE, saves a plot of decomposition (default TRUE).}

\item{output.path}{String. Directory to save the plot if `plot=TRUE` (default: NULL).}
}
\value{
A tibble (data frame) with columns:
  \item{Component_1, Component_2, ...}{Numeric vectors: extracted low-frequency signals for each significant period.}
  \item{NOISE}{Numeric vector: residual high-frequency noise.}
}
\description{
Decomposes a univariate time series into significant low-frequency (periodic) components and residual noise
using Morlet wavelet analysis, based on periods identified as significant by prior wavelet analysis.
Each significant periodic component is extracted and returned as a column, along with the reconstructed "noise" (high-frequency residual).
}
\details{
This function is used in the Wavelet Autoregressive Modeling (WARM) framework to isolate low-frequency signals
(such as decadal or multi-annual climate cycles) for separate stochastic modeling, while treating the remaining noise
as a stationary process. The decomposition uses a Morlet wavelet transform and reconstructs time series components
at each significant period (as found by prior `waveletAnalysis`), plus a residual ("noise") component.
}
\examples{
\dontrun{
# Example usage:
x <- as.numeric(scale(rnorm(50))) # Example annual series
sig_periods <- list(c(3, 5))      # Assume periods 3 and 5 are significant (from waveletAnalysis)
comp <- waveletDecompose(
  variable = x,
  signif.periods = sig_periods,
  plot = FALSE
)
head(comp)
}

}
\seealso{
\code{\link{waveletAnalysis}} for identification of significant periods.
}
