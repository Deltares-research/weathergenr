% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/evaluate_generator.R
\name{prepare_evaluation_data}
\alias{prepare_evaluation_data}
\title{Prepare Generator Output for Evaluation}
\usage{
prepare_evaluation_data(
  gen_output,
  obs_data,
  obs_dates,
  grid_ids,
  variables,
  min_days_per_year = 365L,
  verbose = TRUE
)
}
\arguments{
\item{gen_output}{List returned by \code{\link{generate_weather}}, containing
\code{resampled} (tibble of resampled observation dates per realization)
and \code{dates} (vector of simulated dates).}

\item{obs_data}{Named list of data frames from \code{\link{read_netcdf}$data},
one per grid cell. Each data frame must contain columns for all variables.}

\item{obs_dates}{Date vector corresponding to rows in each \code{obs_data}
element. Typically from \code{read_netcdf()$date}.}

\item{grid_ids}{Character or integer vector of grid cell identifiers to
include in the evaluation. Must match names or indices in \code{obs_data}.}

\item{variables}{Character vector of variable names to extract
(e.g., \code{c("precip", "temp")}).}

\item{min_days_per_year}{Integer. Minimum number of days required to consider
a year complete. Default is 365. Use 360 for 360-day calendars.}

\item{verbose}{Logical. If \code{TRUE}, prints progress messages to console
via the internal \code{.log()} function. Default is \code{TRUE}.}
}
\value{
A list with two elements:
\describe{
  \item{sim_data}{List of length \code{n_realizations}. Each element is a
    list of data frames (one per grid cell) with columns \code{date} followed
    by the requested \code{variables}.}
  \item{obs_data}{List of data frames (one per grid cell) with columns
    \code{date} followed by the requested \code{variables}.}
}
}
\description{
Transforms the output from \code{\link{generate_weather}} into the format
required by \code{\link{evaluate_weather_generator}}. This helper function
handles the date resampling, complete-year filtering, and data extraction
that is typically needed between generation and evaluation steps.
}
\details{
The function performs the following transformations:
\enumerate{
  \item Maps resampled dates back to row indices in the original observations
  \item Filters the simulation period to complete years only (>= 365 days)
  \item Extracts the specified variables from observed data using resampled indices
  \item Formats both simulated and observed data as required by the evaluator
}

Complete years are identified by calendar year boundaries. For water-year
simulations, users should ensure the simulation spans full water years.
}
\examples{
\dontrun{
# After running generate_weather()
ncdata <- read_netcdf("climate_data.nc")
gen_output <- generate_weather(
  obs_data = ncdata$data,
  obs_grid = ncdata$grid,
  obs_dates = ncdata$date,
  ...
)

# Prepare data for evaluation
eval_data <- prepare_evaluation_data(
  gen_output = gen_output,
  obs_data   = ncdata$data,
  obs_dates  = ncdata$date,
  grid_ids   = ncdata$grid$id,
  variables  = c("precip", "temp")
)

# Run evaluation
results <- evaluate_weather_generator(
  daily_sim = eval_data$sim_data,
  daily_obs = eval_data$obs_data,
  ...
)
}

}
\seealso{
\code{\link{generate_weather}}, \code{\link{evaluate_weather_generator}}
}
