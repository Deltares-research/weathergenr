---
title: "weathergenr"
format: gfm
---

[![R-CMD-check](https://github.com/Deltares-research/weathergenr/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/Deltares-research/weathergenr/actions)
[![CRAN status](https://www.r-pkg.org/badges/version/weathergenr.png)](https://CRAN.R-project.org/package=weathergenr)
[![License: MIT](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html)

# Overview

**weathergenr** is an R package that implements a semiparametric, multivariate, multisite stochastic weather generator designed for climate risk and stress-testing applications. The approach is conceptually based on the framework of Steinschneider & Brown (2013) and is adapted here for gridded datasets and modern NetCDF-based workflows.

The package is intended for workflows such as:

- climate risk and stress testing
- hydrological and water-resources modelling
- scenario analysis for climate adaptation studies

## Methodological framework

The generator explicitly represents climate variability across multiple temporal scales and couples long-term variability with realistic daily weather sequences.The procedure consists of three main components:

1. Low-frequency variability (WARM): Interannual to decadal climate variability is simulated using wavelet autoregressive modeling (WARM) applied to annual climate aggregates (typically precipitation). Wavelet decomposition isolates low-frequency components of the observed signal, which are stochastically simulated using autoregressive processes and recombined to generate synthetic annual sequences that preserve observed persistence and spectral structure. These annual simulations condition the daily generator, ensuring that low-frequency variability is coherently embedded in daily weather realizations.

2. Daily weather generation (Markov chain + KNN): Daily precipitation occurrence is simulated using a multi-state Markov chain to reproduce wet and dry spell persistence, while daily values of precipitation and temperature are generated using k-nearest-neighbour (KNN) resampling. The KNN approach preserves cross-variable dependence, seasonality, and spatial correlations across grid cells. Historical years are selected conditionally based on similarity to the simulated annual climate state, linking daily variability to interannual conditions without imposing restrictive parametric assumptions.

3. Climate perturbations and quantile mapping: Simulated weather series can be modified using quantile-based perturbation methods (e.g. quantile mapping) to impose controlled changes in temperature and precipitation distributions. These perturbations allow systematic exploration of climate stressors-such as shifts in means, variability, or extremes-while retaining the internally consistent temporal and spatial structure generated by the stochastic model.

## Intended use

The resulting framework is intended for bottom-up climate vulnerability assessments to explore system response under a wide range of plausible climate conditions.

## Key features

- support for **gridded NetCDF inputs** and outputs
- multivariate and multisite weather generation
- explicit representation of low-frequency climate variability
- efficient filtering and selection of stochastic realizations
- designed for reproducible, scenario-based workflows

# Installation

To install the development version from GitHub:

```{r, eval = FALSE}
# install.packages("devtools")
# devtools::install_github("Deltares-research/weathergenr")
```

# Getting started

A worked end-to-end tutorial is available here:

- ðŸ“˜ **Getting Started**  
  https://deltares-research.github.io/weathergenr/articles/getting_started.html

Additional vignettes and advanced examples will be added as the package evolves.

# Reference

> Steinschneider, S., & Brown, C. (2013). *A semiparametric multivariate, multisite weather generator with low-frequency variability for use in climate risk assessments.* **Water Resources Research**, 49(11), 7205â€“7220. (https://doi.org/10.1002/wrcr.20528)

# License

Licensed under the MIT License. See `LICENSE` for details.
