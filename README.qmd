---
title: "weathergenr"
---

[![R-CMD-check](https://github.com/Deltares-research/weathergenr/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/Deltares-research/weathergenr/actions)
[![CRAN status](https://www.r-pkg.org/badges/version/weathergenr.png)](https://CRAN.R-project.org/package=weathergenr)
[![License: MIT](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html)

# Overview

**weathergenr** is an R package for generating **synthetic, multivariate, gridded daily weather series** for climate and hydrological impact studies. It implements a stochastic weather generator designed to preserve **temporal persistence, spatial coherence, and low-frequency climate variability**, while remaining computationally efficient and reproducible.

The package is intended for workflows such as:

- climate risk and stress testing
- hydrological and water-resources modelling
- scenario analysis for climate adaptation studies

## Methodological framework

The generator combines multiple statistical components across temporal scales:

### Low-frequency variability (WARM)

Interannual to decadal variability is represented using **Wavelet Autoregressive Modeling (WARM)** applied to annual aggregates (typically precipitation). Wavelet decomposition isolates significant low-frequency modes, which are then stochastically simulated using autoregressive processes.

### Daily persistence (Markov chain)

Daily precipitation occurrence is controlled using a **three-state Markov chain** (dry, wet, extreme), with month-varying transition probabilities. This component reproduces wet/dry spell lengths and persistence characteristics that strongly influence hydrological response.

### Multivariate resampling (KNN)

Daily weather variables (e.g., precipitation and temperature) are resampled using **K-nearest-neighbour (KNN)** selection conditioned on annual-scale similarity. This preserves cross-variable dependence, seasonality, and spatial correlations across grid cells.

### Climate perturbations and quantile mapping

Synthetic series can be modified using **quantile-based perturbation methods** (quantile mappingâ€“style transformations), enabling scenario-consistent changes (e.g., temperature shifts, precipitation scaling) while keeping stochastic variability and imposed trends separable.

## Key features

- support for **gridded NetCDF inputs** and outputs
- multivariate and multisite weather generation
- explicit representation of low-frequency climate variability
- efficient filtering and selection of stochastic realizations
- designed for reproducible, scenario-based workflows

# Installation

To install the development version from GitHub:

```{r, eval = FALSE}
# install.packages("devtools")
# devtools::install_github("Deltares-research/weathergenr")
```

# Getting started

A worked end-to-end tutorial is available here:

- ðŸ“˜ **Getting Started**  
  https://deltares-research.github.io/weathergenr/articles/getting_started.html

Additional vignettes and advanced examples will be added as the package evolves.

# Methodological reference

The stochastic weather generator implemented in **weathergenr** is conceptually based on the semiparametric, multisite framework developed by Steinschneider and Brown (2013). The present package provides an independent implementation and extension of these ideas, adapted for gridded datasets, modern NetCDF-based workflows, and large-scale stochastic simulation.

Users interested in the theoretical foundations of the approach are encouraged to consult the original paper:

> Steinschneider, S., & Brown, C. (2013).  
> *A semiparametric multivariate, multisite weather generator with low-frequency variability for use in climate risk assessments.*  
> **Water Resources Research**, 49(11), 7205â€“7220.  
> https://doi.org/10.1002/wrcr.20528

# License

Copyright (c) 2019, Deltares

Licensed under the MIT License. See `LICENSE` for details.
