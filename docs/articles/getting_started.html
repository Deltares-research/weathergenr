<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>getting_started • weathergenr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="getting_started_files/libs/quarto-html/popper.min.js"></script><script src="getting_started_files/libs/quarto-html/tippy.umd.min.js"></script><link href="getting_started_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="getting_started_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="getting_started">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weathergenr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Deltares-research/weathergenr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1></h1>




      <small class="dont-index">Source: <a href="https://github.com/Deltares-research/weathergenr/blob/HEAD/vignettes/getting_started.qmd" class="external-link"><code>vignettes/getting_started.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p>title: “Getting Started with weathergenr” description: “Read NetCDF inputs, generate stochastic realizations, and evaluate generator skill.” format: html: toc: true toc-location: left toc-title: “Contents” toc-depth: 2 toc-expand: 2 page-layout: full code-fold: true code-tools: true df-print: tibble execute: echo: true warning: false message: false cache: false freeze: auto vignette: &gt; % % % —</p>
<section class="section level2"><h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <strong>weathergenr</strong> package provides a comprehensive toolkit for stochastic weather generation and climate data analysis. It implements sophisticated statistical methods to create synthetic daily weather series that preserve the statistical properties of observed climate data while enabling scenario-based climate impact assessments.</p>
<p>This vignette demonstrates the core workflow:</p>
<ol type="1">
<li>Reading gridded meteorological data from NetCDF files</li>
<li>Generating synthetic weather realizations using coupled statistical methods<br>
</li>
<li>Evaluating the quality of synthetic weather against historical observations</li>
</ol>
<section class="level2"><h3 id="load-required-packages">Load Required Packages<a class="anchor" aria-label="anchor" href="#load-required-packages"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://deltares-research.github.io/weathergenr">weathergenr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div>
<blockquote>
<p><strong>Related functions</strong></p>
<ul>
<li>[<code><a href="../reference/read_netcdf.html">read_netcdf()</a></code>]</li>
<li>[<code><a href="../reference/generate_weather.html">generate_weather()</a></code>]</li>
<li>[<code><a href="../reference/evaluate_weather_generator.html">evaluate_weather_generator()</a></code>]</li>
<li>[<code><a href="../reference/write_netcdf.html">write_netcdf()</a></code>]</li>
<li>[<code><a href="../reference/apply_climate_perturbations.html">apply_climate_perturbations()</a></code>]</li>
<li>[<code><a href="../reference/analyze_wavelet_spectrum.html">analyze_wavelet_spectrum()</a></code>]</li>
</ul>
</blockquote>
</div>
</section></section><section class="section level2"><h2 id="reading-gridded-multivariate-weather-data">Reading Gridded Multivariate Weather Data<a class="anchor" aria-label="anchor" href="#reading-gridded-multivariate-weather-data"></a>
</h2>
<section class="level2"><h3 id="about-the-example-dataset">About the Example Dataset<a class="anchor" aria-label="anchor" href="#about-the-example-dataset"></a>
</h3>
<p>For this tutorial, we use the ERA5 dataset (ECMWF Reanalysis v5) included with the package. The data covers the Ntoum Basin in Gabon, a tropical watershed in West Central Africa. The dataset includes daily precipitation, mean temperature, minimum temperature, and maximum temperature at a 0.25-degree spatial resolution.</p>
<div class="quarto-figure quarto-figure-left">
<figure><p><img src="figures/ntoum_basin.png" style="width:40.0%"></p>
<figcaption>Map of Ntoum Basin, Gabon</figcaption></figure>
</div>
</section><section class="level2"><h3 id="loading-netcdf-data">Loading NetCDF Data<a class="anchor" aria-label="anchor" href="#loading-netcdf-data"></a>
</h3>
<p>The <code><a href="../reference/read_netcdf.html">read_netcdf()</a></code> function provides an efficient interface for extracting meteorological data from NetCDF files. It handles the complexities of NetCDF format and returns data in a tidy, analysis-ready structure optimized for the weathergenr workflow.</p>
<section class="level3"><h4 id="key-features">Key Features<a class="anchor" aria-label="anchor" href="#key-features"></a>
</h4>
<p>The function performs several important operations:</p>
<ul>
<li>Extracts spatial coordinates and temporal information</li>
<li>Organizes data into per-grid-cell time series</li>
<li>Handles calendar systems including leap day management</li>
<li>Provides variable renaming capabilities</li>
<li>Optionally drops variables with all missing values to reduce memory usage</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Locate the example NetCDF file</span></span>
<span><span class="va">ncfile</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ntoum_era5_data.nc"</span>, package <span class="op">=</span> <span class="st">"weathergenr"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Read the NetCDF file with default settings</span></span>
<span><span class="va">ncdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_netcdf.html">read_netcdf</a></span><span class="op">(</span><span class="va">ncfile</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level3"><h4 id="understanding-the-output-structure">Understanding the Output Structure<a class="anchor" aria-label="anchor" href="#understanding-the-output-structure"></a>
</h4>
<p>The <code><a href="../reference/read_netcdf.html">read_netcdf()</a></code> function returns a list with five components that organize different aspects of the climate data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the top-level structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data"       "grid"       "date"       "dimensions" "attributes"</code></pre>
</div>
</div>
<section class="level4"><h5 id="time-series-data">1. Time Series Data<a class="anchor" aria-label="anchor" href="#time-series-data"></a>
</h5>
<p>The <code>data</code> element contains a list of data frames, one for each grid cell. Each data frame represents a daily time series with columns for each meteorological variable:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine the first grid cell's time series</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  press_msl      kin temp_min temp_max     temp     kout precip
1  1008.232 173.8779 24.39999 28.13000 25.89001 409.9045   9.12
2  1008.105 161.9229 23.67999 28.08002 24.89001 410.2427  15.59
3  1007.561 201.3387 23.58002 27.89001 25.64001 410.5097   4.84
4  1007.602 176.7380 25.04001 28.31000 26.13000 410.7956   5.20
5  1007.330 217.5677 24.61002 28.12000 26.13000 411.1073   1.54
6  1007.161 198.7215 25.02002 28.17999 26.34000 411.4271   8.35</code></pre>
</div>
</div>
<p>This structure allows efficient access to complete time series for individual locations while maintaining a compact memory footprint.</p>
</section><section class="level4"><h5 id="spatial-grid-information">2. Spatial Grid Information<a class="anchor" aria-label="anchor" href="#spatial-grid-information"></a>
</h5>
<p>The <code>grid</code> element provides spatial metadata for each grid cell:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View grid metadata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
     id  xind  yind         x         y
  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl[1d]&gt; &lt;dbl[1d]&gt;
1     1     1     1      9.5       0.5
2     2     2     1      9.75      0.5
3     3     3     1     10         0.5
4     4     1     2      9.5       0.25
5     5     2     2      9.75      0.25
6     6     3     2     10         0.25</code></pre>
</div>
</div>
<p>Each row describes a grid cell with:</p>
<ul>
<li>
<code>id</code>: Sequential identifier for the grid cell</li>
<li>
<code>xind</code>, <code>yind</code>: Array indices in the original NetCDF file</li>
<li>
<code>x</code>, <code>y</code>: Spatial coordinates (longitude/latitude or projected coordinates)</li>
</ul></section><section class="level4"><h5 id="temporal-information">3. Temporal Information<a class="anchor" aria-label="anchor" href="#temporal-information"></a>
</h5>
<p>The <code>date</code> element contains the complete time axis as a vector of Date objects:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display the first and last few dates</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2000-01-01" "2000-01-02" "2000-01-03" "2000-01-04" "2000-01-05"
[6] "2000-01-06"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-12-26" "2020-12-27" "2020-12-28" "2020-12-29" "2020-12-30"
[6] "2020-12-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confirm the total number of days</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7671</code></pre>
</div>
</div>
</section><section class="level4"><h5 id="dimension-vectors">4. Dimension Vectors<a class="anchor" aria-label="anchor" href="#dimension-vectors"></a>
</h5>
<p>The <code>dimensions</code> element stores the raw dimension vectors from the NetCDF file:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View available dimensions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">dimensions</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "longitude" "latitude"  "time"     </code></pre>
</div>
</div>
</section><section class="level4"><h5 id="metadata-attributes">5. Metadata Attributes<a class="anchor" aria-label="anchor" href="#metadata-attributes"></a>
</h5>
<p>The <code>attributes</code> element preserves variable attributes, spatial reference information, and global metadata from the NetCDF file, ensuring traceability and documentation.</p>
</section></section><section class="level3"><h4 id="advanced-usage">Advanced Usage<a class="anchor" aria-label="anchor" href="#advanced-usage"></a>
</h4>
<p>The <code><a href="../reference/read_netcdf.html">read_netcdf()</a></code> function supports several optional parameters for customized data loading:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Load specific variables and rename them</span></span>
<span><span class="va">ncdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_netcdf.html">read_netcdf</a></span><span class="op">(</span></span>
<span>  nc_path <span class="op">=</span> <span class="va">ncfile</span>,</span>
<span>  var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"precip"</span>, <span class="st">"temp"</span><span class="op">)</span>,</span>
<span>  var_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>precip <span class="op">=</span> <span class="st">"precipitation"</span>, temp <span class="op">=</span> <span class="st">"temperature"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example: Handle 365-day calendar data (no leap days)</span></span>
<span><span class="va">ncdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_netcdf.html">read_netcdf</a></span><span class="op">(</span></span>
<span>  nc_path <span class="op">=</span> <span class="va">ncfile</span>,</span>
<span>  keep_leap_day <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Example: Round values to reduce precision and memory</span></span>
<span><span class="va">ncdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_netcdf.html">read_netcdf</a></span><span class="op">(</span></span>
<span>  nc_path <span class="op">=</span> <span class="va">ncfile</span>,</span>
<span>  signif_digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  drop_all_na <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section></section></section><section class="section level2"><h2 id="generating-stochastic-weather-realizations">Generating Stochastic Weather Realizations<a class="anchor" aria-label="anchor" href="#generating-stochastic-weather-realizations"></a>
</h2>
<section class="level2"><h3 id="overview-of-the-weather-generation-method">Overview of the Weather Generation Method<a class="anchor" aria-label="anchor" href="#overview-of-the-weather-generation-method"></a>
</h3>
<p>The <code><a href="../reference/generate_weather.html">generate_weather()</a></code> function implements a sophisticated multi-scale weather generation framework that combines several statistical methods:</p>
<section class="level3"><h4 id="statistical-components">Statistical Components<a class="anchor" aria-label="anchor" href="#statistical-components"></a>
</h4>
<ol type="1">
<li><p><strong>Wavelet Autoregressive Modeling (WARM)</strong>: Captures low-frequency (annual to multi-year) climate variability by decomposing annual precipitation signals into wavelet components and simulating their temporal evolution using ARIMA models.</p></li>
<li><p><strong>Markov Chain Model</strong>: Controls the persistence of wet and dry spells at the daily scale by modeling transitions between three precipitation states (dry, wet, extreme) with monthly-varying transition probabilities.</p></li>
<li><p><strong>K-Nearest Neighbors (KNN) Resampling</strong>: Selects historical analogue years based on similarity in annual precipitation patterns and resamples daily weather sequences from these analogues while preserving spatial and temporal correlations.</p></li>
</ol>
<p>This coupled approach ensures that synthetic weather series preserve both:</p>
<ul>
<li>
<strong>Temporal structure</strong>: Day-to-day persistence, seasonal cycles, and interannual variability</li>
<li>
<strong>Spatial coherence</strong>: Correlations between grid cells and co-occurrence patterns of weather events</li>
<li>
<strong>Statistical properties</strong>: Means, variances, extremes, and distributional characteristics</li>
</ul>
<p>The method is described in detail by <a href="https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/wrcr.20528" class="external-link">Steinschneider and Brown (2013)</a>.</p>
</section></section><section class="level2"><h3 id="setting-up-the-simulation">Setting Up the Simulation<a class="anchor" aria-label="anchor" href="#setting-up-the-simulation"></a>
</h3>
<p>First, define the output directory and specify which meteorological variables to simulate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a temporary directory for outputs</span></span>
<span><span class="va">output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Define variables to simulate</span></span>
<span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"precip"</span>, <span class="st">"temp"</span>, <span class="st">"temp_min"</span>, <span class="st">"temp_max"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Labels for plotting (optional)</span></span>
<span><span class="va">variable_labels</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Precipitation"</span>, <span class="st">"Temperature (mean)"</span>, </span>
<span>                     <span class="st">"Temperature (min)"</span>, <span class="st">"Temperature (max)"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Number of stochastic realizations to generate</span></span>
<span><span class="va">realization_num</span> <span class="op">&lt;-</span> <span class="fl">3</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="understanding-simulation-parameters">Understanding Simulation Parameters<a class="anchor" aria-label="anchor" href="#understanding-simulation-parameters"></a>
</h4>
<p>Key parameters control different aspects of the weather generation:</p>
<ul>
<li>
<strong>Temporal scope</strong>: <code>n_years</code> and <code>start_year</code> define the simulation period</li>
<li>
<strong>Realization count</strong>: <code>n_realizations</code> specifies how many independent synthetic series to create</li>
<li>
<strong>WARM parameters</strong>: Control annual-scale variability simulation
<ul>
<li>
<code>warm_var</code>: The primary driver variable (typically precipitation)</li>
<li>
<code>warm_signif</code>: Significance threshold for retaining wavelet components (0.90 = 90% confidence)</li>
<li>
<code>warm_pool_size</code>: Number of candidate annual traces to generate before filtering</li>
</ul>
</li>
<li>
<strong>KNN parameters</strong>: Control daily-scale resampling
<ul>
<li>
<code>annual_knn_n</code>: Number of historical analogue years to consider</li>
</ul>
</li>
<li>
<strong>Markov Chain parameters</strong>: Define precipitation state thresholds
<ul>
<li>
<code>wet_q</code>: Threshold for wet day classification (0.3 = 30th percentile)</li>
<li>
<code>extreme_q</code>: Threshold for extreme precipitation (0.8 = 80th percentile)</li>
</ul>
</li>
</ul></section></section><section class="level2"><h3 id="running-the-weather-generator">Running the Weather Generator<a class="anchor" aria-label="anchor" href="#running-the-weather-generator"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set a seed for reproducibility</span></span>
<span><span class="va">seed</span> <span class="op">&lt;-</span> <span class="fl">123</span></span>
<span></span>
<span><span class="co"># Generate synthetic weather series</span></span>
<span><span class="va">stochastic_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_weather.html">generate_weather</a></span><span class="op">(</span></span>
<span>  obs_data <span class="op">=</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  obs_grid <span class="op">=</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span>,</span>
<span>  obs_dates <span class="op">=</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  vars <span class="op">=</span> <span class="va">variables</span>,</span>
<span>  n_years <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  start_year <span class="op">=</span> <span class="fl">2020</span>,</span>
<span>  year_start_month <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n_realizations <span class="op">=</span> <span class="va">realization_num</span>,</span>
<span>  warm_var <span class="op">=</span> <span class="st">"precip"</span>,</span>
<span>  warm_signif <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>  warm_pool_size <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  annual_knn_n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  wet_q <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  extreme_q <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="va">output_path</span>,</span>
<span>  seed <span class="op">=</span> <span class="va">seed</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<section class="level3"><h4 id="understanding-the-output">Understanding the Output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h4>
<p>The function returns a list containing:</p>
<ul>
<li>
<code>resampled</code>: The historical dates selected as analogues for each simulation day</li>
<li>
<code>dates</code>: The simulated daily time axis (always 365-day calendar, Feb 29 excluded)</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View the structure of the output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "resampled" "dates"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check the simulated date range</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2020-01-01" "2020-01-02" "2020-01-03" "2020-01-04" "2020-01-05"
[6] "2020-01-06"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2039-12-26" "2039-12-27" "2039-12-28" "2039-12-29" "2039-12-30"
[6] "2039-12-31"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Examine resampled dates for the first realization</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">resampled</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2016-01-01" "2015-01-01" "2016-01-20" "2015-01-02" "2015-01-03"
[6] "2015-01-07"</code></pre>
</div>
</div>
</section><section class="level3"><h4 id="interpreting-resampled-dates">Interpreting Resampled Dates<a class="anchor" aria-label="anchor" href="#interpreting-resampled-dates"></a>
</h4>
<p>The resampled dates show which historical days were selected as analogues. This information reveals:</p>
<ul>
<li>Whether the generator is drawing from wet or dry historical periods</li>
<li>The diversity of historical conditions being sampled</li>
<li>Temporal clustering patterns in the resampling scheme</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display resampled dates for all realizations</span></span>
<span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">resampled</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 7,300 × 3
   rlz_1      rlz_2      rlz_3
   &lt;date&gt;     &lt;date&gt;     &lt;date&gt;
 1 2016-01-01 2017-01-01 2015-01-01
 2 2015-01-01 2017-01-04 2005-01-28
 3 2016-01-20 2002-01-02 2010-01-29
 4 2015-01-02 2002-01-07 2010-01-16
 5 2015-01-03 2002-01-08 2010-01-04
 6 2015-01-07 2002-01-09 2010-01-05
 7 2015-01-09 2002-01-10 2010-01-06
 8 2015-01-10 2002-01-07 2010-01-11
 9 2015-01-10 2014-01-08 2010-01-12
10 2015-01-10 2014-01-08 2010-01-10
# ℹ 7,290 more rows</code></pre>
</div>
</div>
</section></section><section class="level2"><h3 id="extracting-synthetic-weather-data">Extracting Synthetic Weather Data<a class="anchor" aria-label="anchor" href="#extracting-synthetic-weather-data"></a>
</h3>
<p>To access the actual weather values (not just the resampled dates), you need to extract the corresponding data from the historical record:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Extract synthetic weather for all realizations</span></span>
<span><span class="va">synthetic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">realization_num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Get the day order for this realization</span></span>
<span>  <span class="va">day_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">resampled</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, <span class="va">ncdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Extract corresponding weather data for each grid cell</span></span>
<span>  <span class="va">synthetic_data</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">data</span>, <span class="kw">function</span><span class="op">(</span><span class="va">cell_data</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">cell_data</span><span class="op">[</span><span class="va">day_order</span>, <span class="va">variables</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="evaluating-synthetic-weather-series">Evaluating Synthetic Weather Series<a class="anchor" aria-label="anchor" href="#evaluating-synthetic-weather-series"></a>
</h2>
<section class="level2"><h3 id="purpose-of-evaluation">Purpose of Evaluation<a class="anchor" aria-label="anchor" href="#purpose-of-evaluation"></a>
</h3>
<p>Validating the weather generator’s performance is crucial to ensure that synthetic weather series are suitable for impact modeling. The <code><a href="../reference/evaluate_weather_generator.html">evaluate_weather_generator()</a></code> function provides comprehensive diagnostic comparisons between simulated and observed weather across multiple statistical dimensions.</p>
</section><section class="level2"><h3 id="preparing-data-for-evaluation">Preparing Data for Evaluation<a class="anchor" aria-label="anchor" href="#preparing-data-for-evaluation"></a>
</h3>
<p>The evaluation function requires:</p>
<ol type="1">
<li>Observed weather data in list format (one element per grid cell)</li>
<li>Simulated weather data structured similarly</li>
<li>Matching date columns in both datasets</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create day order indices for each realization</span></span>
<span><span class="va">day_order</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>  <span class="fl">1</span><span class="op">:</span><span class="va">realization_num</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">stochastic_weather</span><span class="op">$</span><span class="va">resampled</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span>, <span class="va">ncdata</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract synthetic weather samples</span></span>
<span><span class="va">rlz_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">n</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">realization_num</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">rlz_sample</span><span class="op">[[</span><span class="va">n</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">id</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">[</span><span class="va">day_order</span><span class="op">[</span>, <span class="va">n</span><span class="op">]</span>, <span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">precip</span>, <span class="va">temp</span>, <span class="va">temp_min</span>, <span class="va">temp_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Prepare observed data</span></span>
<span><span class="va">obs_sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">ncdata</span><span class="op">$</span><span class="va">data</span><span class="op">[</span><span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span><span class="op">$</span><span class="va">id</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">precip</span>, <span class="va">temp</span>, <span class="va">temp_min</span>, <span class="va">temp_max</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">date</span>, .before <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="running-the-evaluation">Running the Evaluation<a class="anchor" aria-label="anchor" href="#running-the-evaluation"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Evaluate weather generator performance</span></span>
<span><span class="va">evaluation_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/evaluate_weather_generator.html">evaluate_weather_generator</a></span><span class="op">(</span></span>
<span>  daily_sim <span class="op">=</span> <span class="va">rlz_sample</span>,</span>
<span>  daily_obs <span class="op">=</span> <span class="va">obs_sample</span>,</span>
<span>  variables <span class="op">=</span> <span class="va">variables</span>,</span>
<span>  variable_labels <span class="op">=</span> <span class="va">variable_labels</span>,</span>
<span>  n_realizations <span class="op">=</span> <span class="va">realization_num</span>,</span>
<span>  wet_quantile <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  extreme_quantile <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  output_path <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_plots <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="understanding-evaluation-metrics">Understanding Evaluation Metrics<a class="anchor" aria-label="anchor" href="#understanding-evaluation-metrics"></a>
</h3>
<p>The evaluation function computes and visualizes several key aspects of weather generator performance:</p>
<section class="level3"><h4 id="daily-statistics">1. Daily Statistics<a class="anchor" aria-label="anchor" href="#daily-statistics"></a>
</h4>
<p>Comparison of mean, standard deviation, and skewness for each variable across all grid cells. This assesses whether the generator preserves the central tendency, variability, and distributional shape of observed weather.</p>
</section><section class="level3"><h4 id="wet-and-dry-day-frequencies">2. Wet and Dry Day Frequencies<a class="anchor" aria-label="anchor" href="#wet-and-dry-day-frequencies"></a>
</h4>
<p>For precipitation, the evaluation examines:</p>
<ul>
<li>Total number of wet days (above the wet threshold)</li>
<li>Number of extreme precipitation days (above the extreme threshold)</li>
<li>Dry day frequencies</li>
</ul>
<p>These metrics reveal whether the generator correctly reproduces precipitation occurrence patterns.</p>
</section><section class="level3"><h4 id="spell-length-distributions">3. Spell Length Distributions<a class="anchor" aria-label="anchor" href="#spell-length-distributions"></a>
</h4>
<p>Analysis of consecutive wet and dry periods:</p>
<ul>
<li>Mean wet spell length</li>
<li>Mean dry spell length</li>
<li>Distribution of spell durations</li>
</ul>
<p>This assesses the generator’s ability to capture persistence in weather patterns.</p>
</section><section class="level3"><h4 id="spatial-correlations">4. Spatial Correlations<a class="anchor" aria-label="anchor" href="#spatial-correlations"></a>
</h4>
<p>Inter-site correlation matrices for each variable, comparing observed versus simulated spatial coherence. This is critical for applications requiring realistic spatial patterns (e.g., regional hydrology).</p>
</section></section><section class="level2"><h3 id="viewing-evaluation-results">Viewing Evaluation Results<a class="anchor" aria-label="anchor" href="#viewing-evaluation-results"></a>
</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Display all diagnostic plots</span></span>
<span><span class="va">evaluation_plots</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$daily_mean</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-1.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$daily_sd</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-2.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$spell_length</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-3.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$wetdry_days_count</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-4.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$crossgrid</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-5.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$intergrid</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-6.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$precip_cond_cor</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-7.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$annual_pattern_precip</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-8.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$annual_pattern_temp</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-9.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$annual_pattern_temp_min</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-10.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$annual_pattern_temp_max</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-11.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$monthly_cycle</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-12.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$annual_precip</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure><p><img src="getting_started_files/figure-html/view_evaluation-13.png" width="960"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
attr(,"class")
[1] "weather_assessment" "list"
attr(,"fit_summary")
# A tibble: 3 × 17
  rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max
  &lt;chr&gt; &lt;int&gt;         &lt;dbl&gt;           &lt;dbl&gt;         &lt;dbl&gt;             &lt;dbl&gt;
1 2         1         0.282            2.63          17.0              19.2
2 3         2         0.541            2.65          17.0              19.2
3 1         3         0.706            2.65          17.0              19.2
# ℹ 11 more variables: mae_mean_temp_min &lt;dbl&gt;, mae_sd_precip &lt;dbl&gt;,
#   mae_sd_temp &lt;dbl&gt;, mae_sd_temp_max &lt;dbl&gt;, mae_sd_temp_min &lt;dbl&gt;,
#   mae_days_Dry &lt;dbl&gt;, mae_days_Wet &lt;dbl&gt;, mae_spell_Dry &lt;dbl&gt;,
#   mae_spell_Wet &lt;dbl&gt;, mae_cor_crossgrid &lt;dbl&gt;, mae_cor_intervariable &lt;dbl&gt;
attr(,"metadata")
attr(,"metadata")$n_grids
[1] 6

attr(,"metadata")$n_realizations
[1] 3

attr(,"metadata")$variables
[1] "precip"   "temp"     "temp_min" "temp_max"

attr(,"metadata")$assessment_date
[1] "2026-01-16"</code></pre>
</div>
</div>
<section class="level3"><h4 id="interpreting-the-plots">Interpreting the Plots<a class="anchor" aria-label="anchor" href="#interpreting-the-plots"></a>
</h4>
<p>Good weather generator performance is indicated by:</p>
<ul>
<li>
<strong>Scatter plots near the 1:1 line</strong>: Simulated statistics closely match observed values</li>
<li>
<strong>Overlapping distributions</strong>: Similar shapes and ranges between observed and simulated</li>
<li>
<strong>Consistent correlation patterns</strong>: Spatial correlations preserved in synthetic data</li>
<li>
<strong>Balanced residuals</strong>: No systematic bias in any direction</li>
</ul>
<p>Discrepancies may indicate:</p>
<ul>
<li>Parameter tuning needed - adjust WARM or Markov chain thresholds</li>
<li>Insufficient historical analogue pool - increase KNN sample size</li>
<li>Structural limitations for specific climate regimes</li>
</ul></section></section></section><section class="section level2"><h2 id="other-features">Other Features<a class="anchor" aria-label="anchor" href="#other-features"></a>
</h2>
<p>The weathergenr package supports additional capabilities not covered in this basic tutorial:</p>
<section class="level2"><h3 id="climate-scenario-analysis">Climate Scenario Analysis<a class="anchor" aria-label="anchor" href="#climate-scenario-analysis"></a>
</h3>
<p>Use <code><a href="../reference/apply_climate_perturbations.html">apply_climate_perturbations()</a></code> to modify synthetic weather based on climate change scenarios:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Apply temperature increase and precipitation changes</span></span>
<span><span class="va">grid_with_lat</span> <span class="op">&lt;-</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span></span>
<span><span class="va">grid_with_lat</span><span class="op">$</span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="va">grid_with_lat</span><span class="op">$</span><span class="va">y</span></span>
<span></span>
<span><span class="va">perturbed_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/apply_climate_perturbations.html">apply_climate_perturbations</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">synthetic_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span><span class="va">df</span>, prcp <span class="op">=</span> <span class="va">precip</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">grid_with_lat</span>,</span>
<span>  date <span class="op">=</span> <span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span>,</span>
<span>  prcp_mean_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.1</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  prcp_var_factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  temp_delta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2.0</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>  temp_transient <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  prcp_transient <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  compute_pet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="wavelet-spectral-analysis">Wavelet Spectral Analysis<a class="anchor" aria-label="anchor" href="#wavelet-spectral-analysis"></a>
</h3>
<p>Explore low-frequency climate variability using wavelet transforms:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Analyze spectral characteristics of annual precipitation</span></span>
<span><span class="va">wavelet_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/analyze_wavelet_spectrum.html">analyze_wavelet_spectrum</a></span><span class="op">(</span></span>
<span>  series <span class="op">=</span> <span class="va">annual_precip</span>,</span>
<span>  signif <span class="op">=</span> <span class="fl">0.90</span>,</span>
<span>  noise <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  min_period <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="st">"fast"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="parallel-computing">Parallel Computing<a class="anchor" aria-label="anchor" href="#parallel-computing"></a>
</h3>
<p>For large spatial domains, enable parallel processing to accelerate computation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate weather using multiple cores</span></span>
<span><span class="va">stochastic_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/generate_weather.html">generate_weather</a></span><span class="op">(</span></span>
<span>  <span class="co"># ... other parameters ...</span></span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section><section class="level2"><h3 id="saving-and-exporting-results">Saving and Exporting Results<a class="anchor" aria-label="anchor" href="#saving-and-exporting-results"></a>
</h3>
<p>Results can be written back to NetCDF format for use in other tools:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Write synthetic weather to NetCDF</span></span>
<span><span class="va">data_to_write</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">synthetic_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">df</span><span class="op">[</span><span class="va">variables</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/write_netcdf.html">write_netcdf</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">data_to_write</span>,</span>
<span>  grid <span class="op">=</span> <span class="va">ncdata</span><span class="op">$</span><span class="va">grid</span>,</span>
<span>  out_dir <span class="op">=</span> <span class="va">output_path</span>,</span>
<span>  origin_date <span class="op">=</span> <span class="va">stochastic_weather</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  calendar <span class="op">=</span> <span class="st">"noleap"</span>,</span>
<span>  template_path <span class="op">=</span> <span class="va">ncfile</span>,</span>
<span>  file_prefix <span class="op">=</span> <span class="st">"synthetic_weather"</span>,</span>
<span>  file_suffix <span class="op">=</span> <span class="st">"rlz1"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</section></section><section class="section level2"><h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<ul>
<li>
<strong>Methodological details</strong>: See Steinschneider and Brown (2013) for the theoretical foundation</li>
<li>
<strong>Package documentation</strong>: Use <code>?function_name</code> to access detailed help for any function</li>
</ul>
<hr>
<p><strong>Session Information</strong></p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.5.2 (2025-10-31 ucrt)
Platform: x86_64-w64-mingw32/x64
Running under: Windows 11 x64 (build 26200)

Matrix products: default
  LAPACK version 3.12.1

locale:
[1] LC_COLLATE=English_United States.utf8
[2] LC_CTYPE=English_United States.utf8
[3] LC_MONETARY=English_United States.utf8
[4] LC_NUMERIC=C
[5] LC_TIME=English_United States.utf8

time zone: Europe/Amsterdam
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base

other attached packages:
[1] ggplot2_4.0.1     dplyr_1.1.4       weathergenr_0.9.0

loaded via a namespace (and not attached):
 [1] gtable_0.3.6       xfun_0.55          lattice_0.22-7     quadprog_1.5-8
 [5] vctrs_0.6.5        tools_4.5.2        generics_0.1.4     curl_7.0.0
 [9] parallel_4.5.2     tibble_3.3.1       proxy_0.4-29       xts_0.14.1
[13] pkgconfig_2.0.3    Matrix_1.7-4       RColorBrewer_1.1-3 S7_0.2.1
[17] lifecycle_1.0.5    compiler_4.5.2     farver_2.1.2       textshaping_1.0.4
[21] codetools_0.2-20   ncdf4_1.24         htmltools_0.5.9    class_7.3-23
[25] pillar_1.11.1      tidyr_1.3.2        MASS_7.3-65        fitdistrplus_1.2-4
[29] iterators_1.0.14   foreach_1.5.2      nlme_3.1-168       fracdiff_1.5-3
[33] tidyselect_1.2.1   digest_0.6.39      purrr_1.2.1        labeling_0.4.3
[37] tseries_0.10-59    splines_4.5.2      fastmap_1.2.0      grid_4.5.2
[41] colorspace_2.1-2   cli_3.6.5          logger_0.4.1       magrittr_2.0.4
[45] patchwork_1.3.2    utf8_1.2.6         survival_3.8-6     e1071_1.7-17
[49] withr_3.0.2        scales_1.4.0       forecast_9.0.0     TTR_0.24.4
[53] rmarkdown_2.30     quantmod_0.4.28    otel_0.2.0         nnet_7.3-20
[57] timeDate_4051.111  gridExtra_2.3      ragg_1.5.0         zoo_1.8-15
[61] urca_1.3-4         evaluate_1.0.5     knitr_1.51         lmtest_0.9-40
[65] viridisLite_0.4.2  rlang_1.1.7        Rcpp_1.1.1         isoband_0.3.0
[69] glue_1.8.0         rstudioapi_0.18.0  jsonlite_2.0.0     R6_2.6.1
[73] systemfonts_1.3.1 </code></pre>
</div>
</div>
</section><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config);
    }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by M.Umit Taner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
