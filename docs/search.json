[{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with weathergenr","text":"weathergenr package provides comprehensive toolkit stochastic weather generation climate data analysis. implements sophisticated statistical methods create synthetic daily weather series preserve statistical properties observed climate data enabling scenario-based climate impact assessments. vignette demonstrates core workflow: Reading gridded meteorological data NetCDF files Generating synthetic weather realizations using coupled statistical methods Evaluating quality synthetic weather historical observations Related functions [read_netcdf()] [generate_weather_series()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [wavelet_spectral_analysis()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"load-required-packages","dir":"Articles","previous_headings":"","what":"Load Required Packages","title":"Getting Started with weathergenr","text":"Related functions [read_netcdf()] [generate_weather_series()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [wavelet_spectral_analysis()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"reading-gridded-multivariate-weather-data","dir":"Articles","previous_headings":"","what":"üìÇ Reading Gridded Multivariate Weather Data","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution.  Map Ntoum Basin, Gabon read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally removes empty grid cells ‚Üí reduces memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list tibbles, one grid cell. tibble represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series ncdata$data[[1]] # A tibble: 7,671 √ó 7    press_msl   kin temp_min temp_max  temp  kout precip        <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl>  1     1008.  174.     24.4     28.1  25.9  410.  9.12  2     1008.  162.     23.7     28.1  24.9  410. 15.6  3     1008.  201.     23.6     27.9  25.6  411.  4.84  4     1008.  177.     25.0     28.3  26.1  411.  5.20  5     1007.  218.     24.6     28.1  26.1  411.  1.54  6     1007.  199.     25.0     28.2  26.3  411.  8.35  7     1008.  195.     24.3     28.3  25.9  412. 14.4  8     1009.  158.     24.6     26.5  25.4  412. 11.4  9     1010.  143.     24.1     27.1  25.1  413.  9.15 10     1009.  220.     23.9     28.6  26.1  413.  0.810 # ‚Ñπ 7,661 more rows # View grid metadata ncdata$grid # A tibble: 6 √ó 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"time\"      \"longitude\" \"latitude\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc.file = ncfile,   variables = c(\"precip\", \"temp\"),   var_rename = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc.file = ncfile,   leap.days = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc.file = ncfile,   signif.digits = 4,   omit.empty = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"about-the-example-dataset","dir":"Articles","previous_headings":"","what":"About the Example Dataset","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution.  Map Ntoum Basin, Gabon","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"loading-netcdf-data","dir":"Articles","previous_headings":"","what":"Loading NetCDF Data","title":"Getting Started with weathergenr","text":"read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally removes empty grid cells ‚Üí reduces memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list tibbles, one grid cell. tibble represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series ncdata$data[[1]] # A tibble: 7,671 √ó 7    press_msl   kin temp_min temp_max  temp  kout precip        <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl>  1     1008.  174.     24.4     28.1  25.9  410.  9.12  2     1008.  162.     23.7     28.1  24.9  410. 15.6  3     1008.  201.     23.6     27.9  25.6  411.  4.84  4     1008.  177.     25.0     28.3  26.1  411.  5.20  5     1007.  218.     24.6     28.1  26.1  411.  1.54  6     1007.  199.     25.0     28.2  26.3  411.  8.35  7     1008.  195.     24.3     28.3  25.9  412. 14.4  8     1009.  158.     24.6     26.5  25.4  412. 11.4  9     1010.  143.     24.1     27.1  25.1  413.  9.15 10     1009.  220.     23.9     28.6  26.1  413.  0.810 # ‚Ñπ 7,661 more rows # View grid metadata ncdata$grid # A tibble: 6 √ó 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"time\"      \"longitude\" \"latitude\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc.file = ncfile,   variables = c(\"precip\", \"temp\"),   var_rename = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc.file = ncfile,   leap.days = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc.file = ncfile,   signif.digits = 4,   omit.empty = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"key-features","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"Key Features","title":"Getting Started with weathergenr","text":"function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally removes empty grid cells ‚Üí reduces memory usage","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile)"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"understanding-the-output-structure","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"Understanding the Output Structure","title":"Getting Started with weathergenr","text":"read_netcdf() function returns list five components organize different aspects climate data: data element contains list tibbles, one grid cell. tibble represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":"# Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series ncdata$data[[1]] # A tibble: 7,671 √ó 7    press_msl   kin temp_min temp_max  temp  kout precip        <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl>  1     1008.  174.     24.4     28.1  25.9  410.  9.12  2     1008.  162.     23.7     28.1  24.9  410. 15.6  3     1008.  201.     23.6     27.9  25.6  411.  4.84  4     1008.  177.     25.0     28.3  26.1  411.  5.20  5     1007.  218.     24.6     28.1  26.1  411.  1.54  6     1007.  199.     25.0     28.2  26.3  411.  8.35  7     1008.  195.     24.3     28.3  25.9  412. 14.4  8     1009.  158.     24.6     26.5  25.4  412. 11.4  9     1010.  143.     24.1     27.1  25.1  413.  9.15 10     1009.  220.     23.9     28.6  26.1  413.  0.810 # ‚Ñπ 7,661 more rows # View grid metadata ncdata$grid # A tibble: 6 √ó 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"time\"      \"longitude\" \"latitude\""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"time-series-data","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"1. Time Series Data","title":"Getting Started with weathergenr","text":"data element contains list tibbles, one grid cell. tibble represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint.","code":"# Examine the first grid cell's time series ncdata$data[[1]] # A tibble: 7,671 √ó 7    press_msl   kin temp_min temp_max  temp  kout precip        <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl>  1     1008.  174.     24.4     28.1  25.9  410.  9.12  2     1008.  162.     23.7     28.1  24.9  410. 15.6  3     1008.  201.     23.6     27.9  25.6  411.  4.84  4     1008.  177.     25.0     28.3  26.1  411.  5.20  5     1007.  218.     24.6     28.1  26.1  411.  1.54  6     1007.  199.     25.0     28.2  26.3  411.  8.35  7     1008.  195.     24.3     28.3  25.9  412. 14.4  8     1009.  158.     24.6     26.5  25.4  412. 11.4  9     1010.  143.     24.1     27.1  25.1  413.  9.15 10     1009.  220.     23.9     28.6  26.1  413.  0.810 # ‚Ñπ 7,661 more rows"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"spatial-grid-information","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"2. Spatial Grid Information","title":"Getting Started with weathergenr","text":"grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates)","code":"# View grid metadata ncdata$grid # A tibble: 6 √ó 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"temporal-information","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"3. Temporal Information","title":"Getting Started with weathergenr","text":"date element contains complete time axis vector Date objects:","code":"# Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"dimension-vectors","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"4. Dimension Vectors","title":"Getting Started with weathergenr","text":"dimensions element stores raw dimension vectors NetCDF file:","code":"# View available dimensions names(ncdata$dimensions) [1] \"time\"      \"longitude\" \"latitude\""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"metadata-attributes","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"5. Metadata Attributes","title":"Getting Started with weathergenr","text":"attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"advanced-usage","dir":"Articles","previous_headings":"üìÇ Reading Gridded Multivariate Weather Data","what":"Advanced Usage","title":"Getting Started with weathergenr","text":"read_netcdf() function supports several optional parameters customized data loading:","code":"# Example: Load specific variables and rename them ncdata <- read_netcdf(   nc.file = ncfile,   variables = c(\"precip\", \"temp\"),   var_rename = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc.file = ncfile,   leap.days = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc.file = ncfile,   signif.digits = 4,   omit.empty = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"generating-stochastic-weather-realizations","dir":"Articles","previous_headings":"","what":"‚öôÔ∏è Generating Stochastic Weather Realizations","title":"Getting Started with weathergenr","text":"generate_weather_series() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components ‚Üí simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns ‚Üí resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013). First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: sim.year.num sim.year.start define simulation period Realization count: realization.num specifies many independent synthetic series create warm.variable: primary driver variable (typically precipitation) warm.signif.level: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm.sample.num: Number candidate annual traces generate filtering knn.sample.num: Number historical analogue years consider mc.wet.quantile: Threshold wet day classification (0.3 = 30th percentile) mc.extreme.quantile: Threshold extreme precipitation (0.8 = 80th percentile) function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Create a temporary directory for outputs output_path <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3 # Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather_series(   weather.data = ncdata$data,   weather.grid = ncdata$grid,   weather.date = ncdata$date,   variables = variables,   sim.year.num = 20,   sim.year.start = 2020,   month.start = 1,   realization.num = realization_num,   warm.variable = \"precip\",   warm.signif.level = 0.90,   warm.sample.num = 10000,   knn.sample.num = 100,   mc.wet.quantile = 0.2,   mc.extreme.quantile = 0.8,   output.path = output_path,   seed = seed,   compute.parallel = FALSE,   num.cores = NULL ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2015-01-01\" \"2011-01-03\" \"2010-01-04\" \"2010-01-04\" \"2010-01-05\" [6] \"2010-01-06\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 √ó 3    rlz_1      rlz_2      rlz_3    <date[1d]> <date[1d]> <date[1d]>  1 2015-01-01 2005-01-01 2013-01-01  2 2011-01-03 2005-01-02 2013-01-05  3 2010-01-04 2010-01-03 2013-01-06  4 2010-01-04 2010-01-04 2013-01-02  5 2010-01-05 2015-01-03 2004-01-05  6 2010-01-06 2005-01-08 2004-01-07  7 2010-01-10 2005-01-09 2004-01-08  8 2010-01-11 2010-01-09 2004-01-25  9 2010-01-12 2010-01-10 2013-01-13 10 2010-01-13 2015-01-11 2004-01-08 # ‚Ñπ 7,290 more rows # Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"overview-of-the-weather-generation-method","dir":"Articles","previous_headings":"","what":"Overview of the Weather Generation Method","title":"Getting Started with weathergenr","text":"generate_weather_series() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components ‚Üí simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns ‚Üí resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"statistical-components","dir":"Articles","previous_headings":"‚öôÔ∏è Generating Stochastic Weather Realizations","what":"Statistical Components","title":"Getting Started with weathergenr","text":"Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components ‚Üí simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns ‚Üí resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"setting-up-the-simulation","dir":"Articles","previous_headings":"","what":"Setting Up the Simulation","title":"Getting Started with weathergenr","text":"First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: sim.year.num sim.year.start define simulation period Realization count: realization.num specifies many independent synthetic series create warm.variable: primary driver variable (typically precipitation) warm.signif.level: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm.sample.num: Number candidate annual traces generate filtering knn.sample.num: Number historical analogue years consider mc.wet.quantile: Threshold wet day classification (0.3 = 30th percentile) mc.extreme.quantile: Threshold extreme precipitation (0.8 = 80th percentile)","code":"# Create a temporary directory for outputs output_path <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"understanding-simulation-parameters","dir":"Articles","previous_headings":"‚öôÔ∏è Generating Stochastic Weather Realizations","what":"Understanding Simulation Parameters","title":"Getting Started with weathergenr","text":"Key parameters control different aspects weather generation: Temporal scope: sim.year.num sim.year.start define simulation period Realization count: realization.num specifies many independent synthetic series create warm.variable: primary driver variable (typically precipitation) warm.signif.level: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm.sample.num: Number candidate annual traces generate filtering knn.sample.num: Number historical analogue years consider mc.wet.quantile: Threshold wet day classification (0.3 = 30th percentile) mc.extreme.quantile: Threshold extreme precipitation (0.8 = 80th percentile)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"running-the-weather-generator","dir":"Articles","previous_headings":"","what":"Running the Weather Generator","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather_series(   weather.data = ncdata$data,   weather.grid = ncdata$grid,   weather.date = ncdata$date,   variables = variables,   sim.year.num = 20,   sim.year.start = 2020,   month.start = 1,   realization.num = realization_num,   warm.variable = \"precip\",   warm.signif.level = 0.90,   warm.sample.num = 10000,   knn.sample.num = 100,   mc.wet.quantile = 0.2,   mc.extreme.quantile = 0.8,   output.path = output_path,   seed = seed,   compute.parallel = FALSE,   num.cores = NULL ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2015-01-01\" \"2011-01-03\" \"2010-01-04\" \"2010-01-04\" \"2010-01-05\" [6] \"2010-01-06\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 √ó 3    rlz_1      rlz_2      rlz_3    <date[1d]> <date[1d]> <date[1d]>  1 2015-01-01 2005-01-01 2013-01-01  2 2011-01-03 2005-01-02 2013-01-05  3 2010-01-04 2010-01-03 2013-01-06  4 2010-01-04 2010-01-04 2013-01-02  5 2010-01-05 2015-01-03 2004-01-05  6 2010-01-06 2005-01-08 2004-01-07  7 2010-01-10 2005-01-09 2004-01-08  8 2010-01-11 2010-01-09 2004-01-25  9 2010-01-12 2010-01-10 2013-01-13 10 2010-01-13 2015-01-11 2004-01-08 # ‚Ñπ 7,290 more rows"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"understanding-the-output","dir":"Articles","previous_headings":"‚öôÔ∏è Generating Stochastic Weather Realizations","what":"Understanding the Output","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded)","code":"# View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2015-01-01\" \"2011-01-03\" \"2010-01-04\" \"2010-01-04\" \"2010-01-05\" [6] \"2010-01-06\""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"interpreting-resampled-dates","dir":"Articles","previous_headings":"‚öôÔ∏è Generating Stochastic Weather Realizations","what":"Interpreting Resampled Dates","title":"Getting Started with weathergenr","text":"resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 √ó 3    rlz_1      rlz_2      rlz_3    <date[1d]> <date[1d]> <date[1d]>  1 2015-01-01 2005-01-01 2013-01-01  2 2011-01-03 2005-01-02 2013-01-05  3 2010-01-04 2010-01-03 2013-01-06  4 2010-01-04 2010-01-04 2013-01-02  5 2010-01-05 2015-01-03 2004-01-05  6 2010-01-06 2005-01-08 2004-01-07  7 2010-01-10 2005-01-09 2004-01-08  8 2010-01-11 2010-01-09 2004-01-25  9 2010-01-12 2010-01-10 2013-01-13 10 2010-01-13 2015-01-11 2004-01-08 # ‚Ñπ 7,290 more rows"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"extracting-synthetic-weather-data","dir":"Articles","previous_headings":"","what":"Extracting Synthetic Weather Data","title":"Getting Started with weathergenr","text":"access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"evaluating-synthetic-weather-series","dir":"Articles","previous_headings":"","what":"üîç Evaluating Synthetic Weather Series","title":"Getting Started with weathergenr","text":"Validating weather generator‚Äôs performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions. evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator‚Äôs ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).              Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed ‚Üí adjust WARM Markov chain thresholds Insufficient historical analogue pool ‚Üí increase KNN sample size Structural limitations specific climate regimes","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) }) # Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily.sim = rlz_sample,   daily.obs = obs_sample,   output.path = NULL,   save.plots = FALSE,   variables = variables,   variable.labels = variable_labels,   realization.num = realization_num,   wet.quantile = 0.3,   extreme.quantile = 0.8 ) # Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\" attr(,\"fit_summary\") # A tibble: 3 √ó 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 3         1         0.215            2.60          17.0              19.2 2 1         2         0.498            2.78          17.0              19.2 3 2         3         0.695            2.72          17.0              19.2 # ‚Ñπ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$realization.num [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment.date [1] \"2026-01-11\""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"purpose-of-evaluation","dir":"Articles","previous_headings":"","what":"Purpose of Evaluation","title":"Getting Started with weathergenr","text":"Validating weather generator‚Äôs performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"preparing-data-for-evaluation","dir":"Articles","previous_headings":"","what":"Preparing Data for Evaluation","title":"Getting Started with weathergenr","text":"evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) })"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"running-the-evaluation","dir":"Articles","previous_headings":"","what":"Running the Evaluation","title":"Getting Started with weathergenr","text":"","code":"# Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily.sim = rlz_sample,   daily.obs = obs_sample,   output.path = NULL,   save.plots = FALSE,   variables = variables,   variable.labels = variable_labels,   realization.num = realization_num,   wet.quantile = 0.3,   extreme.quantile = 0.8 )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"understanding-evaluation-metrics","dir":"Articles","previous_headings":"","what":"Understanding Evaluation Metrics","title":"Getting Started with weathergenr","text":"evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator‚Äôs ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"daily-statistics","dir":"Articles","previous_headings":"üîç Evaluating Synthetic Weather Series","what":"1. Daily Statistics","title":"Getting Started with weathergenr","text":"Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"wet-and-dry-day-frequencies","dir":"Articles","previous_headings":"üîç Evaluating Synthetic Weather Series","what":"2. Wet and Dry Day Frequencies","title":"Getting Started with weathergenr","text":"precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"spell-length-distributions","dir":"Articles","previous_headings":"üîç Evaluating Synthetic Weather Series","what":"3. Spell Length Distributions","title":"Getting Started with weathergenr","text":"Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator‚Äôs ability capture persistence weather patterns.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"spatial-correlations","dir":"Articles","previous_headings":"üîç Evaluating Synthetic Weather Series","what":"4. Spatial Correlations","title":"Getting Started with weathergenr","text":"Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"viewing-evaluation-results","dir":"Articles","previous_headings":"","what":"Viewing Evaluation Results","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed ‚Üí adjust WARM Markov chain thresholds Insufficient historical analogue pool ‚Üí increase KNN sample size Structural limitations specific climate regimes","code":"# Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\" attr(,\"fit_summary\") # A tibble: 3 √ó 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 3         1         0.215            2.60          17.0              19.2 2 1         2         0.498            2.78          17.0              19.2 3 2         3         0.695            2.72          17.0              19.2 # ‚Ñπ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$realization.num [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment.date [1] \"2026-01-11\""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"interpreting-the-plots","dir":"Articles","previous_headings":"üîç Evaluating Synthetic Weather Series","what":"Interpreting the Plots","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed ‚Üí adjust WARM Markov chain thresholds Insufficient historical analogue pool ‚Üí increase KNN sample size Structural limitations specific climate regimes","code":""},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"other-features","dir":"Articles","previous_headings":"","what":"Other Features","title":"Getting Started with weathergenr","text":"weathergenr package supports additional capabilities covered basic tutorial: Use apply_climate_perturbations() modify synthetic weather based climate change scenarios: Explore low-frequency climate variability using wavelet transforms: large spatial domains, enable parallel processing accelerate computation: Results can written back NetCDF format use tools:","code":"# Example: Apply temperature increase and precipitation changes perturbed_weather <- apply_climate_perturbations(   weather.data = synthetic_data[[1]],   temperature.change = 2.0,  # 2¬∞C increase   precipitation.change = 1.1,  # 10% increase   month.start = 1 ) # Analyze spectral characteristics of annual precipitation wavelet_results <- wavelet_spectral_analysis(   annual.series = annual_precip,   signif.level = 0.90,   mode = \"fast\" ) # Generate weather using multiple cores stochastic_weather <- generate_weather_series(   # ... other parameters ...   compute.parallel = TRUE,   num.cores = 4 ) # Example: Write synthetic weather to NetCDF write_netcdf(   weather.data = synthetic_data[[1]],   weather.grid = ncdata$grid,   weather.date = stochastic_weather$dates,   variables = variables,   output.file = file.path(output_path, \"synthetic_weather.nc\") )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"climate-scenario-analysis","dir":"Articles","previous_headings":"","what":"Climate Scenario Analysis","title":"Getting Started with weathergenr","text":"Use apply_climate_perturbations() modify synthetic weather based climate change scenarios:","code":"# Example: Apply temperature increase and precipitation changes perturbed_weather <- apply_climate_perturbations(   weather.data = synthetic_data[[1]],   temperature.change = 2.0,  # 2¬∞C increase   precipitation.change = 1.1,  # 10% increase   month.start = 1 )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"wavelet-spectral-analysis","dir":"Articles","previous_headings":"","what":"Wavelet Spectral Analysis","title":"Getting Started with weathergenr","text":"Explore low-frequency climate variability using wavelet transforms:","code":"# Analyze spectral characteristics of annual precipitation wavelet_results <- wavelet_spectral_analysis(   annual.series = annual_precip,   signif.level = 0.90,   mode = \"fast\" )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"parallel-computing","dir":"Articles","previous_headings":"","what":"Parallel Computing","title":"Getting Started with weathergenr","text":"large spatial domains, enable parallel processing accelerate computation:","code":"# Generate weather using multiple cores stochastic_weather <- generate_weather_series(   # ... other parameters ...   compute.parallel = TRUE,   num.cores = 4 )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"saving-and-exporting-results","dir":"Articles","previous_headings":"","what":"Saving and Exporting Results","title":"Getting Started with weathergenr","text":"Results can written back NetCDF format use tools:","code":"# Example: Write synthetic weather to NetCDF write_netcdf(   weather.data = synthetic_data[[1]],   weather.grid = ncdata$grid,   weather.date = stochastic_weather$dates,   variables = variables,   output.file = file.path(output_path, \"synthetic_weather.nc\") )"},{"path":"https://github.com/Deltares-research/weathergenr/articles/getting_started.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with weathergenr","text":"Methodological details: See Steinschneider Brown (2013) theoretical foundation Package documentation: Use ?function_name access detailed help function Session Information","code":"R version 4.5.2 (2025-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 Running under: Windows 11 x64 (build 26200)  Matrix products: default   LAPACK version 3.12.1  locale: [1] LC_COLLATE=English_United States.utf8 [2] LC_CTYPE=English_United States.utf8 [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C [5] LC_TIME=English_United States.utf8  time zone: Europe/Amsterdam tzcode source: internal  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base  other attached packages: [1] ggplot2_4.0.1     dplyr_1.1.4       weathergenr_0.9.0  loaded via a namespace (and not attached):  [1] gtable_0.3.6       xfun_0.55          lattice_0.22-7     quadprog_1.5-8  [5] vctrs_0.6.5        tools_4.5.2        generics_0.1.4     curl_7.0.0  [9] parallel_4.5.2     tibble_3.3.0       proxy_0.4-28       xts_0.14.1 [13] pkgconfig_2.0.3    Matrix_1.7-4       RColorBrewer_1.1-3 S7_0.2.1 [17] lifecycle_1.0.4    compiler_4.5.2     farver_2.1.2       textshaping_1.0.4 [21] codetools_0.2-20   ncdf4_1.24         htmltools_0.5.9    class_7.3-23 [25] yaml_2.3.12        pillar_1.11.1      tidyr_1.3.2        MASS_7.3-65 [29] fitdistrplus_1.2-4 iterators_1.0.14   foreach_1.5.2      nlme_3.1-168 [33] fracdiff_1.5-3     tidyselect_1.2.1   digest_0.6.39      purrr_1.2.0 [37] labeling_0.4.3     tseries_0.10-58    splines_4.5.2      fastmap_1.2.0 [41] grid_4.5.2         colorspace_2.1-2   cli_3.6.5          logger_0.4.1 [45] magrittr_2.0.4     patchwork_1.3.2    utf8_1.2.6         survival_3.8-3 [49] e1071_1.7-17       withr_3.0.2        scales_1.4.0       forecast_8.24.0 [53] TTR_0.24.4         rmarkdown_2.30     quantmod_0.4.28    otel_0.2.0 [57] nnet_7.3-20        timeDate_4051.111  gridExtra_2.3      ragg_1.5.0 [61] zoo_1.8-15         urca_1.3-4         evaluate_1.0.5     knitr_1.51 [65] lmtest_0.9-40      viridisLite_0.4.2  rlang_1.1.6        Rcpp_1.1.0 [69] isoband_0.3.0      glue_1.8.0         rstudioapi_0.17.1  jsonlite_2.0.0 [73] R6_2.6.1           systemfonts_1.3.1"},{"path":"https://github.com/Deltares-research/weathergenr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"M.Umit Taner. Maintainer.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Taner MU (2026). weathergenr: Gridded semi-parametric weather generator. R package version 0.9.0, https://deltares.github.io/weathergenr/.","code":"@Manual{,   title = {weathergenr: Gridded semi-parametric weather generator},   author = {Mehmet Umit Taner},   year = {2026},   note = {R package version 0.9.0},   url = {https://deltares.github.io/weathergenr/}, }"},{"path":"https://github.com/Deltares-research/weathergenr/index.html","id":"overview","dir":"","previous_headings":"","what":"Gridded semi-parametric weather generator","title":"Gridded semi-parametric weather generator","text":"weathergenr R package generating synthetic weather series using multivariate, gridded, stochastic weather generator. builds methodology introduced Steinscheineder et al (2013), provides efficient, user-friendly implementation tailored climate hydrological studies. Key features include: üìÇ Support gridded NetCDF datasets‚öôÔ∏è Script automation enhanced usability‚ö° Significant performance gains via vectorized parallelized code","code":""},{"path":"https://github.com/Deltares-research/weathergenr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Gridded semi-parametric weather generator","text":"installing, make sure : R installed R IDE RStudio install development version weathergenr GitHub:","code":"# install.packages(\"devtools\") # devtools::install_github(\"Deltares/weathergenr\")"},{"path":"https://github.com/Deltares-research/weathergenr/index.html","id":"quick-start","dir":"","previous_headings":"","what":"Quick start","title":"Gridded semi-parametric weather generator","text":"Work--progress tutorials examples available : üìò Getting Started Stay tuned - vignettes usage examples added package evolves.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/index.html","id":"licence","dir":"","previous_headings":"","what":"Licence","title":"Gridded semi-parametric weather generator","text":"Copyright (c) 2019, Deltares Licensed MIT License. Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Deltares Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"Applies climate change perturbations gridded daily weather data modifying precipitation temperature using monthly change factors. Perturbations can applied step changes gradual transient changes. approaches constructed yield mean change simulation period.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"","code":"apply_climate_perturbations(   climate.data = NULL,   climate.grid = NULL,   sim.dates = NULL,   change.factor.precip.mean = NULL,   change.factor.precip.variance = NULL,   change.factor.temp.mean = NULL,   transient.temp.change = TRUE,   transient.precip.change = TRUE,   calculate.pet = TRUE,   fit.method = \"mme\",   verbose = FALSE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"climate.data List data frames, one per grid cell. data frame must contain columns precip, temp, temp_min, temp_max, optionally pet. climate.grid Data frame containing grid cell metadata. Must include column y representing latitude decimal degrees. sim.dates Vector Date objects corresponding rows element climate.data. change.factor.precip.mean Numeric vector length 12. Monthly multiplicative factors precipitation mean representing desired average change simulation period. change.factor.precip.variance Numeric vector length 12. Monthly multiplicative factors applied precipitation variance. change.factor.temp.mean Numeric vector length 12. Monthly additive temperature changes degrees Celsius representing desired average change. transient.temp.change Logical. TRUE, temperature changes increase linearly zero twice specified factor target mean change achieved. FALSE, full factor applied uniformly. transient.precip.change Logical. TRUE, precipitation change factors increase linearly 1.0 calculated endpoint yields target mean. FALSE, full factor applied uniformly. calculate.pet Logical. TRUE, potential evapotranspiration recalculated perturbed temperatures using Hargreaves method. fit.method Character string specifying distribution fitting method passed quantile_mapping. verbose Logical. TRUE, progress messages printed.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"list data frames structure climate.data,   containing perturbed weather variables. Invalid values replaced zero.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"Climate change perturbations applied using following mechanisms: Precipitation adjusted using quantile mapping mean variance scaling. Temperature variables adjusted using additive monthly shifts. Potential evapotranspiration recalculated using Hargreaves equation   requested. Step transient perturbations formulated produce mean change full simulation period. Step changes apply specified factor uniformly across years. Transient changes increase linearly baseline endpoint yields mean effect. precipitation, transient factors ramp 1.0 computed upper value. temperature, transient changes ramp zero twice specified mean change. ensures comparability step transient scenarios representing different temporal pathways. transient precipitation adjustments, minimum factor 0.01 enforced prevent numerical instabilities.","code":""},{"path":[]},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_climate_perturbations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Apply Climate Change Perturbations to Gridded Weather Data ‚Äî apply_climate_perturbations","text":"","code":"if (FALSE) { # \\dontrun{ perturbed_step <- apply_climate_perturbations(   climate.data = weather_grids,   climate.grid = grid_meta,   sim.dates = dates,   change.factor.precip.mean = rep(1.2, 12),   change.factor.precip.variance = rep(1.0, 12),   change.factor.temp.mean = rep(2.0, 12),   transient.temp.change = FALSE,   transient.precip.change = FALSE ) } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply quantile mapping transformation ‚Äî apply_quantile_mapping","title":"Apply quantile mapping transformation ‚Äî apply_quantile_mapping","text":"Apply quantile mapping transformation","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/apply_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply quantile mapping transformation ‚Äî apply_quantile_mapping","text":"","code":"apply_quantile_mapping(value, mon, year, base.params, target.params)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/assess_moment_changes.html","id":null,"dir":"Reference","previous_headings":"","what":"Assess moment changes ‚Äî assess_moment_changes","title":"Assess moment changes ‚Äî assess_moment_changes","text":"Assess moment changes","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/assess_moment_changes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assess moment changes ‚Äî assess_moment_changes","text":"","code":"assess_moment_changes(moments.df)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_conditional_precip_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional precip-X correlations within each grid ‚Äî compute_conditional_precip_cor","title":"Conditional precip-X correlations within each grid ‚Äî compute_conditional_precip_cor","text":"Conditional precip-X correlations within grid","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_conditional_precip_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional precip-X correlations within each grid ‚Äî compute_conditional_precip_cor","text":"","code":"compute_conditional_precip_cor(   data,   variables,   mc.thresholds = NULL,   wet_def = c(\"gt0\", \"monthly_quantile\"),   use_anom = TRUE,   use_log_precip_on_wet = TRUE,   method = \"pearson\",   min_pairs = 50 )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_correlation_matrix_anom.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute correlation matrix on monthly anomalies ‚Äî compute_correlation_matrix_anom","title":"Compute correlation matrix on monthly anomalies ‚Äî compute_correlation_matrix_anom","text":"Compute correlation matrix monthly anomalies","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_correlation_matrix_anom.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute correlation matrix on monthly anomalies ‚Äî compute_correlation_matrix_anom","text":"","code":"compute_correlation_matrix_anom(data, variables)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_dryday_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute dry day diagnostics ‚Äî compute_dryday_diagnostics","title":"Compute dry day diagnostics ‚Äî compute_dryday_diagnostics","text":"Compute dry day diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_dryday_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute dry day diagnostics ‚Äî compute_dryday_diagnostics","text":"","code":"compute_dryday_diagnostics(value.original, value.adjusted, threshold)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_extreme_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute extreme value diagnostics ‚Äî compute_extreme_diagnostics","title":"Compute extreme value diagnostics ‚Äî compute_extreme_diagnostics","text":"Compute extreme value diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_extreme_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute extreme value diagnostics ‚Äî compute_extreme_diagnostics","text":"","code":"compute_extreme_diagnostics(value.original, value.adjusted)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_grouped_statistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute grouped statistics ‚Äî compute_grouped_statistics","title":"Compute grouped statistics ‚Äî compute_grouped_statistics","text":"Compute grouped statistics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_grouped_statistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute grouped statistics ‚Äî compute_grouped_statistics","text":"","code":"compute_grouped_statistics(df, variables, group.vars, stat.funs)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_kurtosis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute kurtosis ‚Äî compute_kurtosis","title":"Compute kurtosis ‚Äî compute_kurtosis","text":"Compute kurtosis","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_kurtosis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute kurtosis ‚Äî compute_kurtosis","text":"","code":"compute_kurtosis(x)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_moment_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute moment diagnostics ‚Äî compute_moment_diagnostics","title":"Compute moment diagnostics ‚Äî compute_moment_diagnostics","text":"Compute moment diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_moment_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute moment diagnostics ‚Äî compute_moment_diagnostics","text":"","code":"compute_moment_diagnostics(value.original, value.adjusted, nonzero.mask)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_monthly_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute monthly diagnostics ‚Äî compute_monthly_diagnostics","title":"Compute monthly diagnostics ‚Äî compute_monthly_diagnostics","text":"Compute monthly diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_monthly_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute monthly diagnostics ‚Äî compute_monthly_diagnostics","text":"","code":"compute_monthly_diagnostics(   value.original,   value.adjusted,   mon.ts,   mean.change = NULL,   var.change = NULL,   year.ts = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_pass_vectors.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute pass vectors for all filters ‚Äî compute_pass_vectors","title":"Compute pass vectors for all filters ‚Äî compute_pass_vectors","text":"Evaluates realizations pass filter criterion.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_pass_vectors.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute pass vectors for all filters ‚Äî compute_pass_vectors","text":"","code":"compute_pass_vectors(   rel.diff.mean,   rel.diff.sd,   tail_metrics,   P_sim_reg,   P_sim_bg,   presence_rpad,   wavelet_diag,   bounds,   wavelet_active,   wavelet_pars,   n_realizations )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_pass_vectors.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute pass vectors for all filters ‚Äî compute_pass_vectors","text":"rel.diff.mean Relative differences mean rel.diff.sd Relative differences SD tail_metrics List compute_tailmass_metrics() P_sim_reg Matrix regional powers (n_realizations x n_regions) P_sim_bg Vector background powers (n_realizations) presence_rpad Logical vector presence indicators wavelet_diag List wavelet diagnostics bounds Bounds environment list wavelet_active Logical wavelet filter status wavelet_pars List wavelet parameters n_realizations Number realizations","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_pass_vectors.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute pass vectors for all filters ‚Äî compute_pass_vectors","text":"Named list logical vectors (pass$mean, pass$sd, pass$tail_low, etc.)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_quantile_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute quantile diagnostics ‚Äî compute_quantile_diagnostics","title":"Compute quantile diagnostics ‚Äî compute_quantile_diagnostics","text":"Compute quantile diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_quantile_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute quantile diagnostics ‚Äî compute_quantile_diagnostics","text":"","code":"compute_quantile_diagnostics(value.original, value.adjusted, quantiles)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_realization_fit_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute fit metrics for each realization ‚Äî compute_realization_fit_metrics","title":"Compute fit metrics for each realization ‚Äî compute_realization_fit_metrics","text":"Computes Mean Absolute Error (MAE) key metrics. MAE measures average magnitude errors simulated observed values. Lower MAE indicates better fit.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_realization_fit_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute fit metrics for each realization ‚Äî compute_realization_fit_metrics","text":"","code":"compute_realization_fit_metrics(obs.results, sim.results, variables)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_realization_fit_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute fit metrics for each realization ‚Äî compute_realization_fit_metrics","text":"obs.results Observed data results process_observed_data sim.results Simulated data results process_simulated_data variables Character vector variable names","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_skewness.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute skewness ‚Äî compute_skewness","title":"Compute skewness ‚Äî compute_skewness","text":"Compute skewness","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_skewness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute skewness ‚Äî compute_skewness","text":"","code":"compute_skewness(x)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_spell_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute spell length diagnostics ‚Äî compute_spell_diagnostics","title":"Compute spell length diagnostics ‚Äî compute_spell_diagnostics","text":"Compute spell length diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_spell_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute spell length diagnostics ‚Äî compute_spell_diagnostics","text":"","code":"compute_spell_diagnostics(value.original, value.adjusted, threshold)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_spell_lengths.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute spell lengths ‚Äî compute_spell_lengths","title":"Compute spell lengths ‚Äî compute_spell_lengths","text":"Compute spell lengths","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_spell_lengths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute spell lengths ‚Äî compute_spell_lengths","text":"","code":"compute_spell_lengths(x, threshold, below = TRUE)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_summary_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute overall summary metrics ‚Äî compute_summary_metrics","title":"Compute overall summary metrics ‚Äî compute_summary_metrics","text":"Compute overall summary metrics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_summary_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute overall summary metrics ‚Äî compute_summary_metrics","text":"","code":"compute_summary_metrics(   moments,   quantile.metrics,   extreme.metrics,   spell.metrics,   dryday.metrics )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_tailmass_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute tail-mass metrics for filtering ‚Äî compute_tailmass_metrics","title":"Compute tail-mass metrics for filtering ‚Äî compute_tailmass_metrics","text":"Computes tail-mass metrics based lower upper tail quantile thresholds. Uses robust scale estimation (IQR -> MAD -> SD fallback) normalizes tail deficit/excess masses series length scale.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_tailmass_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute tail-mass metrics for filtering ‚Äî compute_tailmass_metrics","text":"","code":"compute_tailmass_metrics(   obs.use,   series_sim_for_stats,   tail.low.p,   tail.high.p,   tail.eps )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_tailmass_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute tail-mass metrics for filtering ‚Äî compute_tailmass_metrics","text":"obs.use Numeric vector observed values series_sim_for_stats Numeric matrix simulated values (n_use x n_realizations) tail.low.p Lower tail quantile probability (e.g., 0.10) tail.high.p Upper tail quantile probability (e.g., 0.90) tail.eps Epsilon log transform avoid log(0)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_tailmass_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute tail-mass metrics for filtering ‚Äî compute_tailmass_metrics","text":"List elements: thr_low, thr_high: Observed quantile thresholds scale_obs: Robust scale estimate M_obs_low, M_obs_high: Observed tail masses M_sim_low, M_sim_high: Simulated tail masses (vectors) logdiff_low, logdiff_high: Log-distance metrics (vectors)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_target_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute target distribution parameters from base params and change factors ‚Äî compute_target_parameters","title":"Compute target distribution parameters from base params and change factors ‚Äî compute_target_parameters","text":"Compute target distribution parameters base params change factors","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_target_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute target distribution parameters from base params and change factors ‚Äî compute_target_parameters","text":"","code":"compute_target_parameters(   base.params,   mean.change,   var.change,   valid.months,   ymax )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_temporal_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute temporal pattern diagnostics ‚Äî compute_temporal_diagnostics","title":"Compute temporal pattern diagnostics ‚Äî compute_temporal_diagnostics","text":"Compute temporal pattern diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_temporal_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute temporal pattern diagnostics ‚Äî compute_temporal_diagnostics","text":"","code":"compute_temporal_diagnostics(   value.original,   value.adjusted,   mon.ts,   year.ts,   nonzero.mask )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_timeseries_statistics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute time series statistics ‚Äî compute_timeseries_statistics","title":"Compute time series statistics ‚Äî compute_timeseries_statistics","text":"Compute time series statistics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_timeseries_statistics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute time series statistics ‚Äî compute_timeseries_statistics","text":"","code":"compute_timeseries_statistics(data, variables, mc.thresholds)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_wavelet_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute wavelet metrics for all realizations ‚Äî compute_wavelet_metrics","title":"Compute wavelet metrics for all realizations ‚Äî compute_wavelet_metrics","text":"Performs wavelet analysis observed series simulated realizations. Identifies significant periods, computes regional power contrast metrics, ALWAYS caches masked (filtering) unmasked (plotting) GWS.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_wavelet_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute wavelet metrics for all realizations ‚Äî compute_wavelet_metrics","text":"","code":"compute_wavelet_metrics(   obs.use,   series_sim_for_stats,   wavelet.pars,   padding,   min_bg )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_wavelet_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute wavelet metrics for all realizations ‚Äî compute_wavelet_metrics","text":"obs.use Numeric vector observed values series_sim_for_stats Numeric matrix simulated values wavelet.pars List wavelet parameters (signif.level, noise.type, etc.) padding Logical period padding min_bg Minimum background power threshold","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/compute_wavelet_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute wavelet metrics for all realizations ‚Äî compute_wavelet_metrics","text":"List elements: active: Logical, whether wavelet filter active diagnostics: Detailed wavelet diagnostics power.period, power.obs, power.signif: Period power vectors P_sim_reg: Regional power matrix (n_realizations x n_regions) P_sim_bg: Background power vector (n_realizations) presence_rpad: Presence indicators (n_realizations) gws_cache: ALWAYS cached masked GWS matrix (n_periods x n_realizations) filtering gws_cache_unmasked: ALWAYS cached unmasked GWS matrix (n_periods x n_realizations) plotting","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_all_diagnostic_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Create all diagnostic plots ‚Äî create_all_diagnostic_plots","title":"Create all diagnostic plots ‚Äî create_all_diagnostic_plots","text":"Create diagnostic plots","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_all_diagnostic_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create all diagnostic plots ‚Äî create_all_diagnostic_plots","text":"","code":"create_all_diagnostic_plots(   plot.data,   plot.config,   variables,   variable.labels,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_annual_precip_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create annual precipitation plot ‚Äî create_annual_precip_plot","title":"Create annual precipitation plot ‚Äî create_annual_precip_plot","text":"Create annual precipitation plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_annual_precip_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create annual precipitation plot ‚Äî create_annual_precip_plot","text":"","code":"create_annual_precip_plot(   stats.annual.aavg.sim,   stats.annual.aavg.obs,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_crossgrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create cross-grid correlation plot ‚Äî create_crossgrid_cor_plot","title":"Create cross-grid correlation plot ‚Äî create_crossgrid_cor_plot","text":"Create cross-grid correlation plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_crossgrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create cross-grid correlation plot ‚Äî create_crossgrid_cor_plot","text":"","code":"create_crossgrid_cor_plot(   stats.crosscor,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_daily_mean_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily mean plot ‚Äî create_daily_mean_plot","title":"Create daily mean plot ‚Äî create_daily_mean_plot","text":"Create daily mean plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_daily_mean_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily mean plot ‚Äî create_daily_mean_plot","text":"","code":"create_daily_mean_plot(   daily.stats.season,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_daily_sd_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily standard deviation plot ‚Äî create_daily_sd_plot","title":"Create daily standard deviation plot ‚Äî create_daily_sd_plot","text":"Create daily standard deviation plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_daily_sd_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily standard deviation plot ‚Äî create_daily_sd_plot","text":"","code":"create_daily_sd_plot(   daily.stats.season,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_intergrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create inter-grid correlation plot ‚Äî create_intergrid_cor_plot","title":"Create inter-grid correlation plot ‚Äî create_intergrid_cor_plot","text":"Create inter-grid correlation plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_intergrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create inter-grid correlation plot ‚Äî create_intergrid_cor_plot","text":"","code":"create_intergrid_cor_plot(   stats.intercor,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_monthly_cycle_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly cycle plot ‚Äî create_monthly_cycle_plot","title":"Create monthly cycle plot ‚Äî create_monthly_cycle_plot","text":"Create monthly cycle plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_monthly_cycle_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly cycle plot ‚Äî create_monthly_cycle_plot","text":"","code":"create_monthly_cycle_plot(   daily.stats.season,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_monthly_pattern_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly pattern plot for a single variable ‚Äî create_monthly_pattern_plot","title":"Create monthly pattern plot for a single variable ‚Äî create_monthly_pattern_plot","text":"Create monthly pattern plot single variable","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_monthly_pattern_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly pattern plot for a single variable ‚Äî create_monthly_pattern_plot","text":"","code":"create_monthly_pattern_plot(   stats.mon.aavg.sim,   stats.mon.aavg.obs,   variable,   variable.label,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_precip_cond_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create inter-grid correlation plot conditional on precipitation ‚Äî create_precip_cond_cor_plot","title":"Create inter-grid correlation plot conditional on precipitation ‚Äî create_precip_cond_cor_plot","text":"Create inter-grid correlation plot conditional precipitation","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_precip_cond_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create inter-grid correlation plot conditional on precipitation ‚Äî create_precip_cond_cor_plot","text":"","code":"create_precip_cond_cor_plot(   stats.precip_cor_cond,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_spell_length_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create spell length plot ‚Äî create_spell_length_plot","title":"Create spell length plot ‚Äî create_spell_length_plot","text":"Create spell length plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_spell_length_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create spell length plot ‚Äî create_spell_length_plot","text":"","code":"create_spell_length_plot(   stats.wetdry,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_wetdry_days_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create wet/dry days count plot ‚Äî create_wetdry_days_plot","title":"Create wet/dry days count plot ‚Äî create_wetdry_days_plot","text":"Create wet/dry days count plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/create_wetdry_days_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create wet/dry days count plot ‚Äî create_wetdry_days_plot","text":"","code":"create_wetdry_days_plot(   stats.wetdry,   plot.config,   show.title,   save.plots,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/criteria_string_compact.html","id":null,"dir":"Reference","previous_headings":"","what":"Compact criteria string for a filter ‚Äî criteria_string_compact","title":"Compact criteria string for a filter ‚Äî criteria_string_compact","text":"Creates compact human-readable string describing current filter criteria.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/criteria_string_compact.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compact criteria string for a filter ‚Äî criteria_string_compact","text":"","code":"criteria_string_compact(   filter_name,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/criteria_string_compact.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compact criteria string for a filter ‚Äî criteria_string_compact","text":"filter_name Character filter name bounds Bounds environment list tail_metrics Tail metrics list wavelet_active Logical wavelet_pars Wavelet parameters","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/criteria_string_compact.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compact criteria string for a filter ‚Äî criteria_string_compact","text":"Character string (compact)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/display_fit_summary_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Display fit summary table for all realizations ‚Äî display_fit_summary_table","title":"Display fit summary table for all realizations ‚Äî display_fit_summary_table","text":"Display fit summary table realizations","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/display_fit_summary_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display fit summary table for all realizations ‚Äî display_fit_summary_table","text":"","code":"display_fit_summary_table(fit_summary, variables)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/evaluate_weather_generator.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate Stochastic Weather Generator Performance ‚Äî evaluate_weather_generator","title":"Evaluate Stochastic Weather Generator Performance ‚Äî evaluate_weather_generator","text":"Comprehensive diagnostic evaluation comparing synthetic weather simulations historical observations across multiple grid cells. Computes summary statistics, wet/dry day counts, spell lengths, inter-site correlations, generates diagnostic plots assess stochastic weather generator performance.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/evaluate_weather_generator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate Stochastic Weather Generator Performance ‚Äî evaluate_weather_generator","text":"","code":"evaluate_weather_generator(   daily.sim = NULL,   daily.obs = NULL,   variables = NULL,   variable.labels = NULL,   realization.num = NULL,   wet.quantile = 0.2,   extreme.quantile = 0.8,   output.path = NULL,   save.plots = TRUE,   show.title = TRUE,   max.grids = 25,   seed = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/evaluate_weather_generator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate Stochastic Weather Generator Performance ‚Äî evaluate_weather_generator","text":"daily.sim List simulated weather realizations. element list data frames (one per grid cell), containing daily values `date` column. daily.obs List observed weather data frames (one per grid cell). contain `date` column variables specified `variables`. variables Character vector variable names evaluate (e.g., `c(\"precip\", \"temp\")`). Must include \"precip\" wet/dry spell analysis. variable.labels Optional character vector variable labels plots. Defaults `variables` `NULL`. realization.num Integer. Number synthetic realizations `daily.sim`. wet.quantile Numeric 0 1. Quantile threshold wet days (default = 0.2). extreme.quantile Numeric 0 1. Quantile threshold extremely wet days (default = 0.8). output.path Character. Directory path save generated plots. `NULL`, plots saved disk. save.plots Logical. Whether save plots `output.path` (default = `TRUE`). show.title Logical. Whether display titles plots (default = `TRUE`). max.grids Integer. Maximum number grid cells evaluate (default = 25). grids provided, random subsample used control memory. seed Optional integer. Random seed reproducible grid subsampling year window selection. NULL, results vary runs.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/evaluate_weather_generator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate Stochastic Weather Generator Performance ‚Äî evaluate_weather_generator","text":"named list `ggplot2` plot objects class \"weather_assessment\".   returned object also contains fit summary metrics stored attributes.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/export_multipanel_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Export multi-panel plot ‚Äî export_multipanel_plot","title":"Export multi-panel plot ‚Äî export_multipanel_plot","text":"Export multi-panel plot","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/export_multipanel_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export multi-panel plot ‚Äî export_multipanel_plot","text":"","code":"export_multipanel_plot(   p,   filename,   show.title,   save.plots,   title = NULL,   subtitle = NULL,   output.path )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_signif_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract significance curve from wavelet analysis result ‚Äî extract_signif_curve","title":"Extract significance curve from wavelet analysis result ‚Äî extract_signif_curve","text":"Searches GWS significance curve wavelet analysis output. Tries multiple possible field names.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_signif_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract significance curve from wavelet analysis result ‚Äî extract_signif_curve","text":"","code":"extract_signif_curve(wv)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_signif_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract significance curve from wavelet analysis result ‚Äî extract_signif_curve","text":"wv List output wavelet_spectral_analysis()","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_signif_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract significance curve from wavelet analysis result ‚Äî extract_signif_curve","text":"Numeric vector significance values, NULL found","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"Reconstructs time series components wavelet transform user-specified significant periods. Optionally includes residual component representing non-significant scales, ensuring complete signal decomposition.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"","code":"extract_wavelet_components(   wave,   signif_periods,   scale,   dj = 0.25,   dt = 1,   variable_sd,   variable_mean = 0,   Cdelta = 0.776,   w0_0 = pi^(-1/4),   include_residual = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"wave Complex matrix. Wavelet transform coefficients dimensions (scales x time). Output continuous wavelet transform. signif_periods Integer vector. Indices significant period scales reconstruct. index corresponds row wave. scale Numeric vector. Scale values corresponding rows wave. dj Numeric scalar. Scale resolution parameter used wavelet transform (default = 0.25). Smaller values give finer resolution. dt Numeric scalar. Time step original series (default = 1). variable_sd Numeric scalar. Standard deviation original time series standardization. Used restore original units. variable_mean Numeric scalar. Mean original time series standardization (default = 0). Added back noise component ensure complete reconstruction: rowSums(output) = original_signal. Cdelta Numeric scalar. Reconstruction constant Morlet wavelet (default = 0.776). Depends wavelet type; see Torrence & Compo (1998) Table 2. w0_0 Numeric scalar. Normalization constant psi_0(0) = pi^(-1/4) Morlet wavelet (default = pi^(-1/4)). include_residual Logical. TRUE (default), includes \"Noise\" component representing sum non-significant scales, ensuring complete signal decomposition rowSums(output) equals reconstructed signal.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"matrix columns:   Component_1, Component_2, ...: One column per significant period   Noise: (include_residual = TRUE) Sum non-significant scales   Number rows equals length original time series.   Property: rowSums(output) approximately equals original signal.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"reconstruction formula (Torrence & Compo 1998, Eq. 11) : x_n = (delta_j * sqrt(delta_t)) / (C_delta * psi_0(0)) *       sum j Re(W_n(s_j)) / sqrt(s_j) function performs complete wavelet decomposition : 1. Extracting significant period separate component 2. Summing remaining (non-significant) scales \"Noise\" component 3. Ensuring: original_signal = sum(significant_components) + Noise differs partial reconstruction, sum significant scales lose information non-significant scales.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"Torrence, C. Compo, G.P. (1998). Practical Guide Wavelet Analysis. Bulletin American Meteorological Society, 79(1), 61-78. See Section 3i Table 2.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/extract_wavelet_components.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract and Reconstruct Wavelet Components from Significant Periods ‚Äî extract_wavelet_components","text":"","code":"if (FALSE) { # \\dontrun{ # After performing wavelet analysis components <- extract_wavelet_components(   wave = wave_transform,   signif_periods = c(5, 10, 20),  # indices of significant scales   scale = scale_vector,   dj = 0.25,   dt = 1,   variable_sd = sd(original_data),   variable_mean = mean(original_data),   Cdelta = 0.776,   include_residual = TRUE )  # Verify complete reconstruction reconstructed <- rowSums(components) plot(original_data) lines(reconstructed, col = \"red\")  # Components include: # - Component_1: First significant period # - Component_2: Second significant period # - Component_3: Third significant period # - Noise: All non-significant scales combined + mean } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fill_nearest.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill NA values with nearest non-NA value ‚Äî fill_nearest","title":"Fill NA values with nearest non-NA value ‚Äî fill_nearest","text":"Forward backward fills NA values vector using nearest non-NA value. Useful handling edge effects interpolated data.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fill_nearest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill NA values with nearest non-NA value ‚Äî fill_nearest","text":"","code":"fill_nearest(v)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fill_nearest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill NA values with nearest non-NA value ‚Äî fill_nearest","text":"v Numeric vector possibly containing NAs","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fill_nearest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill NA values with nearest non-NA value ‚Äî fill_nearest","text":"Numeric vector NAs filled","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter correlations by type (cross-grid or inter-variable) ‚Äî filter_correlations","title":"Filter correlations by type (cross-grid or inter-variable) ‚Äî filter_correlations","text":"Filter correlations type (cross-grid inter-variable)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter correlations by type (cross-grid or inter-variable) ‚Äî filter_correlations","text":"","code":"filter_correlations(cor_data, same_var, same_id, allowed_pairs, pair_type)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_df_to_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a single grid df to selected years (keeps original columns) ‚Äî filter_df_to_years","title":"Filter a single grid df to selected years (keeps original columns) ‚Äî filter_df_to_years","text":"Filter single grid df selected years (keeps original columns)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_df_to_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a single grid df to selected years (keeps original columns) ‚Äî filter_df_to_years","text":"","code":"filter_df_to_years(df, years_keep)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_bounds_defaults.html","id":null,"dir":"Reference","previous_headings":"","what":"WARM filtering default bounds ‚Äî filter_warm_bounds_defaults","title":"WARM filtering default bounds ‚Äî filter_warm_bounds_defaults","text":"Internal defaults filter_warm_simulations() bounds. Users usually override entries via generate_weather_series(warm.bounds = list(...)).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_bounds_defaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WARM filtering default bounds ‚Äî filter_warm_bounds_defaults","text":"","code":"filter_warm_bounds_defaults()"},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_bounds_defaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"WARM filtering default bounds ‚Äî filter_warm_bounds_defaults","text":"Named list defaults.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"Filters set WARM realizations (simulated annual series) observed annual series using three tiers checks: Distributional: relative differences mean standard deviation, Tail behavior: lower/upper tail mass relative observed quantile thresholds, Spectral: observed-relevant global wavelet spectrum (GWS) filter. fewer sample.num realizations pass, function relaxes criteria iteratively (bounds$relax.max.iter) loosening currently restrictive active filter. still insufficient, deterministic fallback returns sample.num realizations smallest absolute relative mean difference.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"","code":"filter_warm_simulations(   series.obs = NULL,   series.sim = NULL,   sample.num = 5,   seed = NULL,   padding = TRUE,   relax.order = c(\"wavelet\", \"sd\", \"tail_low\", \"tail_high\", \"mean\"),   bounds = list(),   wavelet.pars = list(signif.level = 0.8, noise.type = \"red\", period.lower.limit = 2,     detrend = TRUE),   make.plots = FALSE,   verbose = FALSE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"series.obs Numeric vector. Observed annual series (missing values recommended). series.sim Numeric matrix. Simulated annual series years rows realizations columns. sample.num Integer scalar. Number realizations return sampled. greater ncol(series.sim), reduced ncol(series.sim) warning. seed Optional integer. Random seed used window selection (lengths differ) sampling final candidate pool. padding Logical scalar. TRUE, expands observed significant-period set one index side assessing presence observed-relevant signal simulated spectra. relax.order Character vector. Relaxation priority ordering criteria. Must contain c(\"mean\",\"sd\",\"tail_low\",\"tail_high\",\"wavelet\") exactly . multiple filters identical pass rates, order used break ties. bounds Named list. Filtering thresholds relaxation controls. entry provided overrides defaults. Common entries include: mean, sd: relative-difference tolerances mean sd. tail.low.p, tail.high.p: quantiles defining lower/upper tail thresholds. tail.tol.log: tolerance log-distance simulated observed tail mass. tail.eps: epsilon added tail mass log transform stability. sig.frac: minimum fraction observed-relevant regions required pass wavelet filter. wavelet.region.tol, wavelet.contrast.tol: tolerances regional power contrast ratios. wavelet.require_presence, wavelet.presence.frac: controls requiring signal presence. relax.*: relaxation step sizes caps (including relax.max.iter). wavelet.pars Named list passed wavelet_spectral_analysis observed simulated series. Typical entries include signif.level, noise.type, period.lower.limit, detrend. make.plots Logical scalar. TRUE, returns diagnostic plots (time series overlay, relative-difference summaries, wavelet GWS diagnostics) plots. verbose Logical scalar. TRUE, logs per-iteration pass rates relaxation steps using logger::log_info().","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"list : subsetted Numeric matrix. realizations remain final candidate pool     (columns subset series.sim). sampled Numeric matrix. sample.num realizations sampled final pool     (columns subset series.sim). filter_summary Data frame summarizing pass counts pass rates criterion,     final selection mode (tiered relaxation vs fallback). diagnostics List containing window metadata, pool/sample indices, relaxation log,     final parameter values used filtering. plots NULL named list ggplot objects make.plots = TRUE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"Length harmonization: evaluation performed n_use = min(length(series.obs), nrow(series.sim)). observed series longer n_use, one contiguous window length n_use sampled used comparisons. simulated realizations longer n_use, realization evaluated sampled contiguous window length n_use. Returned series subsetted sampled always use original rows series.sim (trimming outputs). Tail-mass metrics: Lower upper thresholds defined observed quantiles bounds$tail.low.p bounds$tail.high.p. Tail behavior summarized normalized deficit/excess mass relative thresholds, compared using stabilized log-distance bounds$tail.eps. Wavelet filter (observed-relevant GWS): observed GWS tested significance curve identify significant periods, grouped contiguous regions. realization, regional integrated power region--background contrast compared observed within specified tolerances, requiring least bounds$sig.frac regions pass. Optional presence checks ensure simulated power exceeds minimum fraction observed power observed-relevant band.","code":""},{"path":[]},{"path":"https://github.com/Deltares-research/weathergenr/reference/filter_warm_simulations.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter and sample WARM simulations using distributional, tail, and wavelet criteria ‚Äî filter_warm_simulations","text":"","code":"if (FALSE) { # \\dontrun{ out <- filter_warm_simulations(   series.obs = obs,   series.sim = sim_mat,   sample.num = 5,   seed = 123,   make.plots = TRUE,   verbose = TRUE ) out$filter_summary out$plots$wavelet_gws } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/find_leap_days.html","id":null,"dir":"Reference","previous_headings":"","what":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","title":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","text":"Scans vector dates returns integer indices elements correspond February 29. vector contains leap days, function returns NULL.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/find_leap_days.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","text":"","code":"find_leap_days(dates)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/find_leap_days.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","text":"dates vector coercible Date.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/find_leap_days.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","text":"Integer vector indices dates equal February 29,   NULL leap days present.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/find_leap_days.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find leap-day positions (Feb 29) in a date vector ‚Äî find_leap_days","text":"","code":"find_leap_days(as.Date(c(\"1980-02-28\", \"1980-02-29\", \"1981-01-01\"))) #> [1] 2 # Returns: 2  find_leap_days(as.Date(c(\"2001-01-01\", \"2001-12-31\"))) #> NULL # Returns: NULL"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fit_monthly_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit gamma distributions for each month ‚Äî fit_monthly_distributions","title":"Fit gamma distributions for each month ‚Äî fit_monthly_distributions","text":"Fit gamma distributions month","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fit_monthly_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit gamma distributions for each month ‚Äî fit_monthly_distributions","text":"","code":"fit_monthly_distributions(value.nz, mon.nz, valid.months, fit.method, verbose)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_num.html","id":null,"dir":"Reference","previous_headings":"","what":"Format numeric with specified digits ‚Äî fmt_num","title":"Format numeric with specified digits ‚Äî fmt_num","text":"Format numeric specified digits","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_num.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format numeric with specified digits ‚Äî fmt_num","text":"","code":"fmt_num(x, digits = 4L)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_num.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format numeric with specified digits ‚Äî fmt_num","text":"x Numeric value digits Number decimal places","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_num.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format numeric with specified digits ‚Äî fmt_num","text":"Character string","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_pct.html","id":null,"dir":"Reference","previous_headings":"","what":"Format percentage ‚Äî fmt_pct","title":"Format percentage ‚Äî fmt_pct","text":"Format percentage","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_pct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format percentage ‚Äî fmt_pct","text":"","code":"fmt_pct(x, digits = 1L)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_pct.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format percentage ‚Äî fmt_pct","text":"x Numeric proportion (0 1) digits Number decimal places","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/fmt_pct.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format percentage ‚Äî fmt_pct","text":"Character string percent sign","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_symmetric_dummy_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate symmetric dummy points for equal axis scaling ‚Äî generate_symmetric_dummy_points","title":"Generate symmetric dummy points for equal axis scaling ‚Äî generate_symmetric_dummy_points","text":"Generate symmetric dummy points equal axis scaling","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_symmetric_dummy_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate symmetric dummy points for equal axis scaling ‚Äî generate_symmetric_dummy_points","text":"","code":"generate_symmetric_dummy_points(   df,   facet.var = \"variable\",   x.col = \"Observed\",   y.col = \"Simulated\" )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_weather_series.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","title":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","text":"Generate stochastic gridded daily weather coupling annual-scale low-frequency generator daily-scale resampling persistence logic. workflow combines: Wavelet Autoregressive Modeling (WARM) annual aggregate         warm.variable simulate low-frequency variability, annual K-nearest-neighbor (KNN) matching select historical analogue years, three-state (dry, wet, extreme) daily Markov chain control spell persistence, daily KNN resampling precipitation temperature anomalies. simulation regime inferred month.start: month.start == 1: calendar-year simulation, month.start != 1: water-year simulation starting month.start.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_weather_series.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","text":"","code":"generate_weather_series(   weather.data = NULL,   weather.grid = NULL,   weather.date = NULL,   variables = NULL,   sim.year.num = NULL,   sim.year.start = 2020,   month.start = 1,   realization.num = 5,   warm.variable = \"precip\",   warm.signif.level = 0.9,   warm.sample.num = 5000,   knn.sample.num = 120,   mc.wet.quantile = 0.3,   mc.extreme.quantile = 0.8,   dry.spell.change = rep(1, 12),   wet.spell.change = rep(1, 12),   output.path = tempdir(),   seed = NULL,   compute.parallel = FALSE,   num.cores = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_weather_series.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","text":"weather.data Named list data frames (one per grid cell) observed daily weather. data frame must one row per day corresponding weather.date, columns variables. weather.grid Data frame describing grid cells. Must contain columns id, xind, yind, x, y. weather.date Vector class Date corresponding rows weather.data[[]]. May include Feb 29; Feb 29 removed internally along corresponding rows weather.data. variables Character vector daily variables simulate (e.g., c(\"precip\",\"temp\")). sim.year.num Integer number years simulate. NULL, defaults number unique historical simulation-years (calendar year water year depending month.start). sim.year.start Integer first simulation year (calendar year month.start == 1, otherwise first water year). month.start Integer 1:12. First month simulation year. realization.num Integer number realizations generate. warm.variable Character name annual driver variable used WARM (must variables). warm.signif.level Numeric (0,1). Wavelet significance level retaining low-frequency components WARM. warm.sample.num Integer number candidate annual traces generate subsetting. knn.sample.num Integer number historical years sampled annual KNN. mc.wet.quantile Numeric (0,1). Wet-day threshold quantile. mc.extreme.quantile Numeric (0,1). Extreme-day threshold quantile. dry.spell.change Numeric length-12 vector monthly dry-spell adjustment factors. wet.spell.change Numeric length-12 vector monthly wet-spell adjustment factors. output.path Character directory diagnostics/CSV outputs. seed Optional integer seed reproducibility. compute.parallel Logical; TRUE, run disaggregation parallel. num.cores Optional integer number cores parallel execution.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_weather_series.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","text":"list : resampled Tibble/data.frame one column per realization.     column contains historical dateo values selected analogues     simulated day. dates Vector Date giving simulated daily time axis     (Feb 29 excluded).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/generate_weather_series.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Synthetic Gridded Daily Weather Series ‚Äî generate_weather_series","text":"Calendar handling (robust Gregorian input): Inputs may Gregorian calendar may include Feb 29. Internally, function enforces 365-day calendar removing Feb 29 weather.date dropping corresponding rows every element weather.data. downstream processing outputs therefore use 365-day calendar. Workflow: Historical preprocessing: enforce 365-day calendar, compute         calendar/water-year indices, build historical dates table used         KNN matching Markov chain sequencing. Annual WARM simulation: aggregate historical daily data annual         means (water year applicable), run wavelet analysis annual         series, simulate candidate annual traces via wavelet_arima,         subset traces using filter_warm_simulations. Daily disaggregation: realization, call         resample_weather_dates() generate simulated sequence         historical analogue dates (internal 365-day calendar). Output construction: map resampled internal dates back         historical observation dates (dateo) return simulated dates.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_full_year_block.html","id":null,"dir":"Reference","previous_headings":"","what":"Find full (365-day) years after leap-day removal and return longest contiguous block ‚Äî get_full_year_block","title":"Find full (365-day) years after leap-day removal and return longest contiguous block ‚Äî get_full_year_block","text":"Find full (365-day) years leap-day removal return longest contiguous block","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_full_year_block.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find full (365-day) years after leap-day removal and return longest contiguous block ‚Äî get_full_year_block","text":"","code":"get_full_year_block(dates)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"Returns valid index `precip.tomorrow` based provided `result`. `result` missing, bounds, invalid, random index sampled instead. `precip.tomorrow` empty, `NA_integer_` returned.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"","code":"get_result_index(result, precip.tomorrow)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"result Integer. Proposed index retrieving element `precip.tomorrow`. precip.tomorrow Numeric vector. set candidate precipitation values (e.g., next day).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"Integer. valid index `precip.tomorrow`, `NA_integer_` `precip.tomorrow` empty.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"function useful stochastic weather generation workflows fallback behavior needed computed index valid.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_result_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Safely Get or Sample an Index from a Vector ‚Äî get_result_index","text":"","code":"precip.tomorrow <- c(0, 5, 10, 20)  # Valid index get_result_index(2, precip.tomorrow) # returns 2 #> [1] 2  # Invalid index: falls back to sampling set.seed(1) get_result_index(10, precip.tomorrow) # randomly returns a valid index #> [1] 1  # NA index: falls back to sampling get_result_index(NA, precip.tomorrow) #> [1] 4  # Empty vector: returns NA get_result_index(1, numeric(0)) #> [1] NA"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":"Returns indices precipitation time series (prcp) specified state transition occurs, based wet/dry/extreme day thresholds.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":"","code":"get_state_indices(   from.state,   to.state,   prcp,   candidate.idx,   wet.thr,   extreme.thr )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":".state Integer. current occurrence state (0 = dry, 1 = wet, 2 = extreme). .state Integer. next occurrence state (0 = dry, 1 = wet, 2 = extreme). prcp Numeric vector precipitation values. candidate.idx Integer vector indices representing current day time series. wet.thr Numeric. Threshold separating dry wet days. extreme.thr Numeric. Threshold days considered extreme.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":"Integer vector indices given transition .state .state occurs.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":"optimized version pre-classifies states , avoiding repeated subsetting threshold comparisons. Typically 5-10x faster -else chain approach. occurrence states defined : - 0: Dry day (precipitation <= wet.thr) - 1: Wet day (precipitation > wet.thr <= extreme.thr) - 2: Extreme wet day (precipitation > extreme.thr) function pre-extracts classifies precipitation states , performs simple integer comparison find matching transitions. much efficient -else chain approach subset compare thresholds multiple times.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_state_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Indices for a Specific Occurrence State Transition ‚Äî get_state_indices","text":"","code":"prcp <- c(0, 0, 5, 15, 30, 0, 2, 25, 40, 0) candidate.idx <- 1:(length(prcp) - 1) wet.thr <- 1 extreme.thr <- 20  # Find transitions from dry to wet get_state_indices(0, 1, prcp, candidate.idx, wet.thr, extreme.thr) #> [1] 2 6 # Returns: 6 (index where transition occurs)  # Find transitions from wet to extreme get_state_indices(1, 2, prcp, candidate.idx, wet.thr, extreme.thr) #> [1] 4 7 # Returns: 3 7 (indices where transitions occur)  # Find transitions from extreme to dry get_state_indices(2, 0, prcp, candidate.idx, wet.thr, extreme.thr) #> [1] 5 9 # Returns: 5 9 (indices where transitions occur)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_water_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Water Year from Date Vector ‚Äî get_water_year","title":"Calculate Water Year from Date Vector ‚Äî get_water_year","text":"Assigns water year date vector based custom starting month. Common hydrology, water year groups months across calendar years (e.g., Oct-Sep).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_water_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Water Year from Date Vector ‚Äî get_water_year","text":"","code":"get_water_year(date, water.year.first.month = 1)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_water_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Water Year from Date Vector ‚Äî get_water_year","text":"date vector `Date` objects. water.year.first.month Integer (1-12) indicating first month water year. example, `10` October `6` June.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/get_water_year.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Water Year from Date Vector ‚Äî get_water_year","text":"integer vector length `date`, giving water year date. #' @examples # Water year starting October (common US hydrology) dates <- .Date(c(\"2022-09-30\", \"2022-10-01\", \"2023-06-15\")) get_water_year(dates, water.year.first.month = 10) # [1] 2022 2023 2023 # Water year starting June (e.g., monsoon-driven systems) dates <- .Date(c(\"2023-05-31\", \"2023-06-01\", \"2023-12-01\")) get_water_year(dates, water.year.first.month = 6) # [1] 2023 2024 2024 # Default: calendar year (Jan-Dec) dates <- .Date(c(\"2024-01-01\", \"2024-12-31\")) get_water_year(dates) # [1] 2024 2024#'","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/gws_regrid.html","id":null,"dir":"Reference","previous_headings":"","what":"Regrid GWS to target period vector ‚Äî gws_regrid","title":"Regrid GWS to target period vector ‚Äî gws_regrid","text":"Interpolates GWS wavelet analysis onto target period grid. Uses linear interpolation fills edge NAs.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/gws_regrid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regrid GWS to target period vector ‚Äî gws_regrid","text":"","code":"gws_regrid(wv, target_period, use_unmasked = FALSE)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/gws_regrid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regrid GWS to target period vector ‚Äî gws_regrid","text":"wv List output wavelet_spectral_analysis() target_period Numeric vector target periods use_unmasked Logical. TRUE available, use gws_unmasked","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/gws_regrid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regrid GWS to target period vector ‚Äî gws_regrid","text":"Numeric vector GWS values target_period grid","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"Given set candidate vectors target vector, selects indices k nearest candidates (using weighted Euclidean distance) target, samples n indices neighbors, either uniformly rank-based distance-based probabilities. Optionally, random seed can set reproducibility.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"","code":"knn_sample(   candidates,   target,   k,   n = 1,   prob = FALSE,   weights = NULL,   seed = NULL,   sampling = c(\"rank\", \"distance\"),   bandwidth = NULL,   epsilon = 1e-08 )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"candidates Numeric matrix data frame. row candidate vector. target Numeric vector. target vector comparison. k Integer. Number nearest neighbors consider (k <= number candidates). n Integer. Number samples draw (default = 1). prob Logical. TRUE, sampling probabilities favor closer neighbors; FALSE (default), sampling uniform among k nearest neighbors. weights Optional numeric vector length equal ncol(candidates). Feature weights distance calculation. Default equal weights. seed Optional integer. provided, sets random seed reproducible sampling. seed state restored exit. sampling Character. Sampling method prob = TRUE. Either \"rank\" (default, probability decreases neighbor rank: 1, 1/2, 1/3, ...) \"distance\" (probability based Gaussian kernel distances). Ignored prob = FALSE. bandwidth Numeric. Bandwidth parameter distance-based sampling kernel. NULL (default), uses median nearest neighbor distance. used sampling = \"distance\" prob = TRUE. epsilon Numeric. Small constant added distance-based probabilities prevent zero probabilities (default = 1e-8). used sampling = \"distance\" prob = TRUE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"Integer vector length n, giving indices sampled candidates (rows candidates).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"function computes weighted Euclidean distance candidate target. k nearest neighbors (smallest distances) identified. Sampling modes: prob = FALSE k neighbors sampled equal probability (uniform) prob = TRUE, sampling = \"rank\" Probability = 1/rank, normalized.         Closest neighbor highest probability. prob = TRUE, sampling = \"distance\" Probability based Gaussian         kernel: exp(-distance^2 / (2 * bandwidth^2)) Sampling replacement. seed set, random seed temporarily changed restored exit.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/knn_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"K-Nearest Neighbor (KNN) Sampling from Candidates ‚Äî knn_sample","text":"","code":"set.seed(42) candidates <- matrix(rnorm(50), ncol = 2) target <- c(0, 0)  # Sample 1 index from 5 nearest neighbors, uniform probability knn_sample(candidates, target, k = 5, n = 1) #> [1] 21  # Sample 3 indices from 5 nearest neighbors, rank-weighted probability knn_sample(candidates, target, k = 5, n = 3, prob = TRUE, seed = 123) #> [1] 15  6 15  # Using feature weights (weight first dimension more heavily) knn_sample(candidates, target, k = 5, n = 2, weights = c(2, 1), seed = 10) #> [1] 17 10  # Distance-based sampling with custom bandwidth knn_sample(candidates, target, k = 10, n = 5, prob = TRUE,            sampling = \"distance\", bandwidth = 1.5) #> [1]  6  6 10  8  8"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filtering_setup.html","id":null,"dir":"Reference","previous_headings":"","what":"Log initial setup information ‚Äî log_filtering_setup","title":"Log initial setup information ‚Äî log_filtering_setup","text":"Displays general information start filtering.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filtering_setup.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log initial setup information ‚Äî log_filtering_setup","text":"","code":"log_filtering_setup(n_obs, n_sim, n_realizations, sample_num, relax_priority)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filtering_setup.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log initial setup information ‚Äî log_filtering_setup","text":"n_obs Number observations observed series n_sim Number years simulated series n_realizations Number realizations sample_num Target number sample relax_priority Relaxation priority vector","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filter_iteration.html","id":null,"dir":"Reference","previous_headings":"","what":"Log filter iteration details with table format ‚Äî log_filter_iteration","title":"Log filter iteration details with table format ‚Äî log_filter_iteration","text":"Prints iteration diagnostics table format iterations.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filter_iteration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log filter iteration details with table format ‚Äî log_filter_iteration","text":"","code":"log_filter_iteration(   iter,   passes,   pool,   n_total,   target,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars,   note = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_filter_iteration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log filter iteration details with table format ‚Äî log_filter_iteration","text":"iter Iteration number passes List pass vectors pool Vector pool indices n_total Total number realizations target Target pool size bounds Bounds environment list tail_metrics Tail metrics list wavelet_active Logical wavelet_pars Wavelet parameters list note Optional note string","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_final_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Log final summary ‚Äî log_final_summary","title":"Log final summary ‚Äî log_final_summary","text":"Displays final filtering results.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_final_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log final summary ‚Äî log_final_summary","text":"","code":"log_final_summary(pool_size, n_total, n_sampled, relaxation_level)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_final_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log final summary ‚Äî log_final_summary","text":"pool_size Final pool size n_total Total realizations n_sampled Number sampled relaxation_level Relaxation level reached","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Log info message with FILTERING prefix ‚Äî log_info","title":"Log info message with FILTERING prefix ‚Äî log_info","text":"Wrapper logger::log_info fallback message(). Automatically adds [FILTERING] prefix messages.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log info message with FILTERING prefix ‚Äî log_info","text":"","code":"log_info(txt)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log info message with FILTERING prefix ‚Äî log_info","text":"txt Character message","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_step.html","id":null,"dir":"Reference","previous_headings":"","what":"Log major step progress ‚Äî log_step","title":"Log major step progress ‚Äî log_step","text":"Displays progress message major computational steps.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_step.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log major step progress ‚Äî log_step","text":"","code":"log_step(step_name, details = NULL)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/log_step.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log major step progress ‚Äî log_step","text":"step_name Name step details Optional details string","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/make_noleap_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","title":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","text":"Constructs continuous sequence dates starting given start date, using -leap calendar (.e., February 29 removed). function repeats 365-day month-day template increments year every 365 days.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/make_noleap_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","text":"","code":"make_noleap_dates(start_date, n_dates)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/make_noleap_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","text":"start_date Date character coercible Date. first date sequence. date February 29, mapped February 28 -leap template include Feb 29. n_dates Integer. Total number dates generate.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/make_noleap_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","text":"vector class Date length n_dates, following   -leap (365-day) calendar.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/make_noleap_dates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a no-leap (365-day) daily date sequence ‚Äî make_noleap_dates","text":"","code":"make_noleap_dates(\"1980-01-01\", 365) #>   [1] \"1980-01-01\" \"1980-01-02\" \"1980-01-03\" \"1980-01-04\" \"1980-01-05\" #>   [6] \"1980-01-06\" \"1980-01-07\" \"1980-01-08\" \"1980-01-09\" \"1980-01-10\" #>  [11] \"1980-01-11\" \"1980-01-12\" \"1980-01-13\" \"1980-01-14\" \"1980-01-15\" #>  [16] \"1980-01-16\" \"1980-01-17\" \"1980-01-18\" \"1980-01-19\" \"1980-01-20\" #>  [21] \"1980-01-21\" \"1980-01-22\" \"1980-01-23\" \"1980-01-24\" \"1980-01-25\" #>  [26] \"1980-01-26\" \"1980-01-27\" \"1980-01-28\" \"1980-01-29\" \"1980-01-30\" #>  [31] \"1980-01-31\" \"1980-02-01\" \"1980-02-02\" \"1980-02-03\" \"1980-02-04\" #>  [36] \"1980-02-05\" \"1980-02-06\" \"1980-02-07\" \"1980-02-08\" \"1980-02-09\" #>  [41] \"1980-02-10\" \"1980-02-11\" \"1980-02-12\" \"1980-02-13\" \"1980-02-14\" #>  [46] \"1980-02-15\" \"1980-02-16\" \"1980-02-17\" \"1980-02-18\" \"1980-02-19\" #>  [51] \"1980-02-20\" \"1980-02-21\" \"1980-02-22\" \"1980-02-23\" \"1980-02-24\" #>  [56] \"1980-02-25\" \"1980-02-26\" \"1980-02-27\" \"1980-02-28\" \"1980-03-01\" #>  [61] \"1980-03-02\" \"1980-03-03\" \"1980-03-04\" \"1980-03-05\" \"1980-03-06\" #>  [66] \"1980-03-07\" \"1980-03-08\" \"1980-03-09\" \"1980-03-10\" \"1980-03-11\" #>  [71] \"1980-03-12\" \"1980-03-13\" \"1980-03-14\" \"1980-03-15\" \"1980-03-16\" #>  [76] \"1980-03-17\" \"1980-03-18\" \"1980-03-19\" \"1980-03-20\" \"1980-03-21\" #>  [81] \"1980-03-22\" \"1980-03-23\" \"1980-03-24\" \"1980-03-25\" \"1980-03-26\" #>  [86] \"1980-03-27\" \"1980-03-28\" \"1980-03-29\" \"1980-03-30\" \"1980-03-31\" #>  [91] \"1980-04-01\" \"1980-04-02\" \"1980-04-03\" \"1980-04-04\" \"1980-04-05\" #>  [96] \"1980-04-06\" \"1980-04-07\" \"1980-04-08\" \"1980-04-09\" \"1980-04-10\" #> [101] \"1980-04-11\" \"1980-04-12\" \"1980-04-13\" \"1980-04-14\" \"1980-04-15\" #> [106] \"1980-04-16\" \"1980-04-17\" \"1980-04-18\" \"1980-04-19\" \"1980-04-20\" #> [111] \"1980-04-21\" \"1980-04-22\" \"1980-04-23\" \"1980-04-24\" \"1980-04-25\" #> [116] \"1980-04-26\" \"1980-04-27\" \"1980-04-28\" \"1980-04-29\" \"1980-04-30\" #> [121] \"1980-05-01\" \"1980-05-02\" \"1980-05-03\" \"1980-05-04\" \"1980-05-05\" #> [126] \"1980-05-06\" \"1980-05-07\" \"1980-05-08\" \"1980-05-09\" \"1980-05-10\" #> [131] \"1980-05-11\" \"1980-05-12\" \"1980-05-13\" \"1980-05-14\" \"1980-05-15\" #> [136] \"1980-05-16\" \"1980-05-17\" \"1980-05-18\" \"1980-05-19\" \"1980-05-20\" #> [141] \"1980-05-21\" \"1980-05-22\" \"1980-05-23\" \"1980-05-24\" \"1980-05-25\" #> [146] \"1980-05-26\" \"1980-05-27\" \"1980-05-28\" \"1980-05-29\" \"1980-05-30\" #> [151] \"1980-05-31\" \"1980-06-01\" \"1980-06-02\" \"1980-06-03\" \"1980-06-04\" #> [156] \"1980-06-05\" \"1980-06-06\" \"1980-06-07\" \"1980-06-08\" \"1980-06-09\" #> [161] \"1980-06-10\" \"1980-06-11\" \"1980-06-12\" \"1980-06-13\" \"1980-06-14\" #> [166] \"1980-06-15\" \"1980-06-16\" \"1980-06-17\" \"1980-06-18\" \"1980-06-19\" #> [171] \"1980-06-20\" \"1980-06-21\" \"1980-06-22\" \"1980-06-23\" \"1980-06-24\" #> [176] \"1980-06-25\" \"1980-06-26\" \"1980-06-27\" \"1980-06-28\" \"1980-06-29\" #> [181] \"1980-06-30\" \"1980-07-01\" \"1980-07-02\" \"1980-07-03\" \"1980-07-04\" #> [186] \"1980-07-05\" \"1980-07-06\" \"1980-07-07\" \"1980-07-08\" \"1980-07-09\" #> [191] \"1980-07-10\" \"1980-07-11\" \"1980-07-12\" \"1980-07-13\" \"1980-07-14\" #> [196] \"1980-07-15\" \"1980-07-16\" \"1980-07-17\" \"1980-07-18\" \"1980-07-19\" #> [201] \"1980-07-20\" \"1980-07-21\" \"1980-07-22\" \"1980-07-23\" \"1980-07-24\" #> [206] \"1980-07-25\" \"1980-07-26\" \"1980-07-27\" \"1980-07-28\" \"1980-07-29\" #> [211] \"1980-07-30\" \"1980-07-31\" \"1980-08-01\" \"1980-08-02\" \"1980-08-03\" #> [216] \"1980-08-04\" \"1980-08-05\" \"1980-08-06\" \"1980-08-07\" \"1980-08-08\" #> [221] \"1980-08-09\" \"1980-08-10\" \"1980-08-11\" \"1980-08-12\" \"1980-08-13\" #> [226] \"1980-08-14\" \"1980-08-15\" \"1980-08-16\" \"1980-08-17\" \"1980-08-18\" #> [231] \"1980-08-19\" \"1980-08-20\" \"1980-08-21\" \"1980-08-22\" \"1980-08-23\" #> [236] \"1980-08-24\" \"1980-08-25\" \"1980-08-26\" \"1980-08-27\" \"1980-08-28\" #> [241] \"1980-08-29\" \"1980-08-30\" \"1980-08-31\" \"1980-09-01\" \"1980-09-02\" #> [246] \"1980-09-03\" \"1980-09-04\" \"1980-09-05\" \"1980-09-06\" \"1980-09-07\" #> [251] \"1980-09-08\" \"1980-09-09\" \"1980-09-10\" \"1980-09-11\" \"1980-09-12\" #> [256] \"1980-09-13\" \"1980-09-14\" \"1980-09-15\" \"1980-09-16\" \"1980-09-17\" #> [261] \"1980-09-18\" \"1980-09-19\" \"1980-09-20\" \"1980-09-21\" \"1980-09-22\" #> [266] \"1980-09-23\" \"1980-09-24\" \"1980-09-25\" \"1980-09-26\" \"1980-09-27\" #> [271] \"1980-09-28\" \"1980-09-29\" \"1980-09-30\" \"1980-10-01\" \"1980-10-02\" #> [276] \"1980-10-03\" \"1980-10-04\" \"1980-10-05\" \"1980-10-06\" \"1980-10-07\" #> [281] \"1980-10-08\" \"1980-10-09\" \"1980-10-10\" \"1980-10-11\" \"1980-10-12\" #> [286] \"1980-10-13\" \"1980-10-14\" \"1980-10-15\" \"1980-10-16\" \"1980-10-17\" #> [291] \"1980-10-18\" \"1980-10-19\" \"1980-10-20\" \"1980-10-21\" \"1980-10-22\" #> [296] \"1980-10-23\" \"1980-10-24\" \"1980-10-25\" \"1980-10-26\" \"1980-10-27\" #> [301] \"1980-10-28\" \"1980-10-29\" \"1980-10-30\" \"1980-10-31\" \"1980-11-01\" #> [306] \"1980-11-02\" \"1980-11-03\" \"1980-11-04\" \"1980-11-05\" \"1980-11-06\" #> [311] \"1980-11-07\" \"1980-11-08\" \"1980-11-09\" \"1980-11-10\" \"1980-11-11\" #> [316] \"1980-11-12\" \"1980-11-13\" \"1980-11-14\" \"1980-11-15\" \"1980-11-16\" #> [321] \"1980-11-17\" \"1980-11-18\" \"1980-11-19\" \"1980-11-20\" \"1980-11-21\" #> [326] \"1980-11-22\" \"1980-11-23\" \"1980-11-24\" \"1980-11-25\" \"1980-11-26\" #> [331] \"1980-11-27\" \"1980-11-28\" \"1980-11-29\" \"1980-11-30\" \"1980-12-01\" #> [336] \"1980-12-02\" \"1980-12-03\" \"1980-12-04\" \"1980-12-05\" \"1980-12-06\" #> [341] \"1980-12-07\" \"1980-12-08\" \"1980-12-09\" \"1980-12-10\" \"1980-12-11\" #> [346] \"1980-12-12\" \"1980-12-13\" \"1980-12-14\" \"1980-12-15\" \"1980-12-16\" #> [351] \"1980-12-17\" \"1980-12-18\" \"1980-12-19\" \"1980-12-20\" \"1980-12-21\" #> [356] \"1980-12-22\" \"1980-12-23\" \"1980-12-24\" \"1980-12-25\" \"1980-12-26\" #> [361] \"1980-12-27\" \"1980-12-28\" \"1980-12-29\" \"1980-12-30\" \"1980-12-31\" make_noleap_dates(as.Date(\"1995-02-28\"), 1000) #>    [1] \"1995-02-28\" \"1995-03-01\" \"1995-03-02\" \"1995-03-03\" \"1995-03-04\" #>    [6] \"1995-03-05\" \"1995-03-06\" \"1995-03-07\" \"1995-03-08\" \"1995-03-09\" #>   [11] \"1995-03-10\" \"1995-03-11\" \"1995-03-12\" \"1995-03-13\" \"1995-03-14\" #>   [16] \"1995-03-15\" \"1995-03-16\" \"1995-03-17\" \"1995-03-18\" \"1995-03-19\" #>   [21] \"1995-03-20\" \"1995-03-21\" \"1995-03-22\" \"1995-03-23\" \"1995-03-24\" #>   [26] \"1995-03-25\" \"1995-03-26\" \"1995-03-27\" \"1995-03-28\" \"1995-03-29\" #>   [31] \"1995-03-30\" \"1995-03-31\" \"1995-04-01\" \"1995-04-02\" \"1995-04-03\" #>   [36] \"1995-04-04\" \"1995-04-05\" \"1995-04-06\" \"1995-04-07\" \"1995-04-08\" #>   [41] \"1995-04-09\" \"1995-04-10\" \"1995-04-11\" \"1995-04-12\" \"1995-04-13\" #>   [46] \"1995-04-14\" \"1995-04-15\" \"1995-04-16\" \"1995-04-17\" \"1995-04-18\" #>   [51] \"1995-04-19\" \"1995-04-20\" \"1995-04-21\" \"1995-04-22\" \"1995-04-23\" #>   [56] \"1995-04-24\" \"1995-04-25\" \"1995-04-26\" \"1995-04-27\" \"1995-04-28\" #>   [61] \"1995-04-29\" \"1995-04-30\" \"1995-05-01\" \"1995-05-02\" \"1995-05-03\" #>   [66] \"1995-05-04\" \"1995-05-05\" \"1995-05-06\" \"1995-05-07\" \"1995-05-08\" #>   [71] \"1995-05-09\" \"1995-05-10\" \"1995-05-11\" \"1995-05-12\" \"1995-05-13\" #>   [76] \"1995-05-14\" \"1995-05-15\" \"1995-05-16\" \"1995-05-17\" \"1995-05-18\" #>   [81] \"1995-05-19\" \"1995-05-20\" \"1995-05-21\" \"1995-05-22\" \"1995-05-23\" #>   [86] \"1995-05-24\" \"1995-05-25\" \"1995-05-26\" \"1995-05-27\" \"1995-05-28\" #>   [91] \"1995-05-29\" \"1995-05-30\" \"1995-05-31\" \"1995-06-01\" \"1995-06-02\" #>   [96] \"1995-06-03\" \"1995-06-04\" \"1995-06-05\" \"1995-06-06\" \"1995-06-07\" #>  [101] \"1995-06-08\" \"1995-06-09\" \"1995-06-10\" \"1995-06-11\" \"1995-06-12\" #>  [106] \"1995-06-13\" \"1995-06-14\" \"1995-06-15\" \"1995-06-16\" \"1995-06-17\" #>  [111] \"1995-06-18\" \"1995-06-19\" \"1995-06-20\" \"1995-06-21\" \"1995-06-22\" #>  [116] \"1995-06-23\" \"1995-06-24\" \"1995-06-25\" \"1995-06-26\" \"1995-06-27\" #>  [121] \"1995-06-28\" \"1995-06-29\" \"1995-06-30\" \"1995-07-01\" \"1995-07-02\" #>  [126] \"1995-07-03\" \"1995-07-04\" \"1995-07-05\" \"1995-07-06\" \"1995-07-07\" #>  [131] \"1995-07-08\" \"1995-07-09\" \"1995-07-10\" \"1995-07-11\" \"1995-07-12\" #>  [136] \"1995-07-13\" \"1995-07-14\" \"1995-07-15\" \"1995-07-16\" \"1995-07-17\" #>  [141] \"1995-07-18\" \"1995-07-19\" \"1995-07-20\" \"1995-07-21\" \"1995-07-22\" #>  [146] \"1995-07-23\" \"1995-07-24\" \"1995-07-25\" \"1995-07-26\" \"1995-07-27\" #>  [151] \"1995-07-28\" \"1995-07-29\" \"1995-07-30\" \"1995-07-31\" \"1995-08-01\" #>  [156] \"1995-08-02\" \"1995-08-03\" \"1995-08-04\" \"1995-08-05\" \"1995-08-06\" #>  [161] \"1995-08-07\" \"1995-08-08\" \"1995-08-09\" \"1995-08-10\" \"1995-08-11\" #>  [166] \"1995-08-12\" \"1995-08-13\" \"1995-08-14\" \"1995-08-15\" \"1995-08-16\" #>  [171] \"1995-08-17\" \"1995-08-18\" \"1995-08-19\" \"1995-08-20\" \"1995-08-21\" #>  [176] \"1995-08-22\" \"1995-08-23\" \"1995-08-24\" \"1995-08-25\" \"1995-08-26\" #>  [181] \"1995-08-27\" \"1995-08-28\" \"1995-08-29\" \"1995-08-30\" \"1995-08-31\" #>  [186] \"1995-09-01\" \"1995-09-02\" \"1995-09-03\" \"1995-09-04\" \"1995-09-05\" #>  [191] \"1995-09-06\" \"1995-09-07\" \"1995-09-08\" \"1995-09-09\" \"1995-09-10\" #>  [196] \"1995-09-11\" \"1995-09-12\" \"1995-09-13\" \"1995-09-14\" \"1995-09-15\" #>  [201] \"1995-09-16\" \"1995-09-17\" \"1995-09-18\" \"1995-09-19\" \"1995-09-20\" #>  [206] \"1995-09-21\" \"1995-09-22\" \"1995-09-23\" \"1995-09-24\" \"1995-09-25\" #>  [211] \"1995-09-26\" \"1995-09-27\" \"1995-09-28\" \"1995-09-29\" \"1995-09-30\" #>  [216] \"1995-10-01\" \"1995-10-02\" \"1995-10-03\" \"1995-10-04\" \"1995-10-05\" #>  [221] \"1995-10-06\" \"1995-10-07\" \"1995-10-08\" \"1995-10-09\" \"1995-10-10\" #>  [226] \"1995-10-11\" \"1995-10-12\" \"1995-10-13\" \"1995-10-14\" \"1995-10-15\" #>  [231] \"1995-10-16\" \"1995-10-17\" \"1995-10-18\" \"1995-10-19\" \"1995-10-20\" #>  [236] \"1995-10-21\" \"1995-10-22\" \"1995-10-23\" \"1995-10-24\" \"1995-10-25\" #>  [241] \"1995-10-26\" \"1995-10-27\" \"1995-10-28\" \"1995-10-29\" \"1995-10-30\" #>  [246] \"1995-10-31\" \"1995-11-01\" \"1995-11-02\" \"1995-11-03\" \"1995-11-04\" #>  [251] \"1995-11-05\" \"1995-11-06\" \"1995-11-07\" \"1995-11-08\" \"1995-11-09\" #>  [256] \"1995-11-10\" \"1995-11-11\" \"1995-11-12\" \"1995-11-13\" \"1995-11-14\" #>  [261] \"1995-11-15\" \"1995-11-16\" \"1995-11-17\" \"1995-11-18\" \"1995-11-19\" #>  [266] \"1995-11-20\" \"1995-11-21\" \"1995-11-22\" \"1995-11-23\" \"1995-11-24\" #>  [271] \"1995-11-25\" \"1995-11-26\" \"1995-11-27\" \"1995-11-28\" \"1995-11-29\" #>  [276] \"1995-11-30\" \"1995-12-01\" \"1995-12-02\" \"1995-12-03\" \"1995-12-04\" #>  [281] \"1995-12-05\" \"1995-12-06\" \"1995-12-07\" \"1995-12-08\" \"1995-12-09\" #>  [286] \"1995-12-10\" \"1995-12-11\" \"1995-12-12\" \"1995-12-13\" \"1995-12-14\" #>  [291] \"1995-12-15\" \"1995-12-16\" \"1995-12-17\" \"1995-12-18\" \"1995-12-19\" #>  [296] \"1995-12-20\" \"1995-12-21\" \"1995-12-22\" \"1995-12-23\" \"1995-12-24\" #>  [301] \"1995-12-25\" \"1995-12-26\" \"1995-12-27\" \"1995-12-28\" \"1995-12-29\" #>  [306] \"1995-12-30\" \"1995-12-31\" \"1996-01-01\" \"1996-01-02\" \"1996-01-03\" #>  [311] \"1996-01-04\" \"1996-01-05\" \"1996-01-06\" \"1996-01-07\" \"1996-01-08\" #>  [316] \"1996-01-09\" \"1996-01-10\" \"1996-01-11\" \"1996-01-12\" \"1996-01-13\" #>  [321] \"1996-01-14\" \"1996-01-15\" \"1996-01-16\" \"1996-01-17\" \"1996-01-18\" #>  [326] \"1996-01-19\" \"1996-01-20\" \"1996-01-21\" \"1996-01-22\" \"1996-01-23\" #>  [331] \"1996-01-24\" \"1996-01-25\" \"1996-01-26\" \"1996-01-27\" \"1996-01-28\" #>  [336] \"1996-01-29\" \"1996-01-30\" \"1996-01-31\" \"1996-02-01\" \"1996-02-02\" #>  [341] \"1996-02-03\" \"1996-02-04\" \"1996-02-05\" \"1996-02-06\" \"1996-02-07\" #>  [346] \"1996-02-08\" \"1996-02-09\" \"1996-02-10\" \"1996-02-11\" \"1996-02-12\" #>  [351] \"1996-02-13\" \"1996-02-14\" \"1996-02-15\" \"1996-02-16\" \"1996-02-17\" #>  [356] \"1996-02-18\" \"1996-02-19\" \"1996-02-20\" \"1996-02-21\" \"1996-02-22\" #>  [361] \"1996-02-23\" \"1996-02-24\" \"1996-02-25\" \"1996-02-26\" \"1996-02-27\" #>  [366] \"1996-02-28\" \"1996-03-01\" \"1996-03-02\" \"1996-03-03\" \"1996-03-04\" #>  [371] \"1996-03-05\" \"1996-03-06\" \"1996-03-07\" \"1996-03-08\" \"1996-03-09\" #>  [376] \"1996-03-10\" \"1996-03-11\" \"1996-03-12\" \"1996-03-13\" \"1996-03-14\" #>  [381] \"1996-03-15\" \"1996-03-16\" \"1996-03-17\" \"1996-03-18\" \"1996-03-19\" #>  [386] \"1996-03-20\" \"1996-03-21\" \"1996-03-22\" \"1996-03-23\" \"1996-03-24\" #>  [391] \"1996-03-25\" \"1996-03-26\" \"1996-03-27\" \"1996-03-28\" \"1996-03-29\" #>  [396] \"1996-03-30\" \"1996-03-31\" \"1996-04-01\" \"1996-04-02\" \"1996-04-03\" #>  [401] \"1996-04-04\" \"1996-04-05\" \"1996-04-06\" \"1996-04-07\" \"1996-04-08\" #>  [406] \"1996-04-09\" \"1996-04-10\" \"1996-04-11\" \"1996-04-12\" \"1996-04-13\" #>  [411] \"1996-04-14\" \"1996-04-15\" \"1996-04-16\" \"1996-04-17\" \"1996-04-18\" #>  [416] \"1996-04-19\" \"1996-04-20\" \"1996-04-21\" \"1996-04-22\" \"1996-04-23\" #>  [421] \"1996-04-24\" \"1996-04-25\" \"1996-04-26\" \"1996-04-27\" \"1996-04-28\" #>  [426] \"1996-04-29\" \"1996-04-30\" \"1996-05-01\" \"1996-05-02\" \"1996-05-03\" #>  [431] \"1996-05-04\" \"1996-05-05\" \"1996-05-06\" \"1996-05-07\" \"1996-05-08\" #>  [436] \"1996-05-09\" \"1996-05-10\" \"1996-05-11\" \"1996-05-12\" \"1996-05-13\" #>  [441] \"1996-05-14\" \"1996-05-15\" \"1996-05-16\" \"1996-05-17\" \"1996-05-18\" #>  [446] \"1996-05-19\" \"1996-05-20\" \"1996-05-21\" \"1996-05-22\" \"1996-05-23\" #>  [451] \"1996-05-24\" \"1996-05-25\" \"1996-05-26\" \"1996-05-27\" \"1996-05-28\" #>  [456] \"1996-05-29\" \"1996-05-30\" \"1996-05-31\" \"1996-06-01\" \"1996-06-02\" #>  [461] \"1996-06-03\" \"1996-06-04\" \"1996-06-05\" \"1996-06-06\" \"1996-06-07\" #>  [466] \"1996-06-08\" \"1996-06-09\" \"1996-06-10\" \"1996-06-11\" \"1996-06-12\" #>  [471] \"1996-06-13\" \"1996-06-14\" \"1996-06-15\" \"1996-06-16\" \"1996-06-17\" #>  [476] \"1996-06-18\" \"1996-06-19\" \"1996-06-20\" \"1996-06-21\" \"1996-06-22\" #>  [481] \"1996-06-23\" \"1996-06-24\" \"1996-06-25\" \"1996-06-26\" \"1996-06-27\" #>  [486] \"1996-06-28\" \"1996-06-29\" \"1996-06-30\" \"1996-07-01\" \"1996-07-02\" #>  [491] \"1996-07-03\" \"1996-07-04\" \"1996-07-05\" \"1996-07-06\" \"1996-07-07\" #>  [496] \"1996-07-08\" \"1996-07-09\" \"1996-07-10\" \"1996-07-11\" \"1996-07-12\" #>  [501] \"1996-07-13\" \"1996-07-14\" \"1996-07-15\" \"1996-07-16\" \"1996-07-17\" #>  [506] \"1996-07-18\" \"1996-07-19\" \"1996-07-20\" \"1996-07-21\" \"1996-07-22\" #>  [511] \"1996-07-23\" \"1996-07-24\" \"1996-07-25\" \"1996-07-26\" \"1996-07-27\" #>  [516] \"1996-07-28\" \"1996-07-29\" \"1996-07-30\" \"1996-07-31\" \"1996-08-01\" #>  [521] \"1996-08-02\" \"1996-08-03\" \"1996-08-04\" \"1996-08-05\" \"1996-08-06\" #>  [526] \"1996-08-07\" \"1996-08-08\" \"1996-08-09\" \"1996-08-10\" \"1996-08-11\" #>  [531] \"1996-08-12\" \"1996-08-13\" \"1996-08-14\" \"1996-08-15\" \"1996-08-16\" #>  [536] \"1996-08-17\" \"1996-08-18\" \"1996-08-19\" \"1996-08-20\" \"1996-08-21\" #>  [541] \"1996-08-22\" \"1996-08-23\" \"1996-08-24\" \"1996-08-25\" \"1996-08-26\" #>  [546] \"1996-08-27\" \"1996-08-28\" \"1996-08-29\" \"1996-08-30\" \"1996-08-31\" #>  [551] \"1996-09-01\" \"1996-09-02\" \"1996-09-03\" \"1996-09-04\" \"1996-09-05\" #>  [556] \"1996-09-06\" \"1996-09-07\" \"1996-09-08\" \"1996-09-09\" \"1996-09-10\" #>  [561] \"1996-09-11\" \"1996-09-12\" \"1996-09-13\" \"1996-09-14\" \"1996-09-15\" #>  [566] \"1996-09-16\" \"1996-09-17\" \"1996-09-18\" \"1996-09-19\" \"1996-09-20\" #>  [571] \"1996-09-21\" \"1996-09-22\" \"1996-09-23\" \"1996-09-24\" \"1996-09-25\" #>  [576] \"1996-09-26\" \"1996-09-27\" \"1996-09-28\" \"1996-09-29\" \"1996-09-30\" #>  [581] \"1996-10-01\" \"1996-10-02\" \"1996-10-03\" \"1996-10-04\" \"1996-10-05\" #>  [586] \"1996-10-06\" \"1996-10-07\" \"1996-10-08\" \"1996-10-09\" \"1996-10-10\" #>  [591] \"1996-10-11\" \"1996-10-12\" \"1996-10-13\" \"1996-10-14\" \"1996-10-15\" #>  [596] \"1996-10-16\" \"1996-10-17\" \"1996-10-18\" \"1996-10-19\" \"1996-10-20\" #>  [601] \"1996-10-21\" \"1996-10-22\" \"1996-10-23\" \"1996-10-24\" \"1996-10-25\" #>  [606] \"1996-10-26\" \"1996-10-27\" \"1996-10-28\" \"1996-10-29\" \"1996-10-30\" #>  [611] \"1996-10-31\" \"1996-11-01\" \"1996-11-02\" \"1996-11-03\" \"1996-11-04\" #>  [616] \"1996-11-05\" \"1996-11-06\" \"1996-11-07\" \"1996-11-08\" \"1996-11-09\" #>  [621] \"1996-11-10\" \"1996-11-11\" \"1996-11-12\" \"1996-11-13\" \"1996-11-14\" #>  [626] \"1996-11-15\" \"1996-11-16\" \"1996-11-17\" \"1996-11-18\" \"1996-11-19\" #>  [631] \"1996-11-20\" \"1996-11-21\" \"1996-11-22\" \"1996-11-23\" \"1996-11-24\" #>  [636] \"1996-11-25\" \"1996-11-26\" \"1996-11-27\" \"1996-11-28\" \"1996-11-29\" #>  [641] \"1996-11-30\" \"1996-12-01\" \"1996-12-02\" \"1996-12-03\" \"1996-12-04\" #>  [646] \"1996-12-05\" \"1996-12-06\" \"1996-12-07\" \"1996-12-08\" \"1996-12-09\" #>  [651] \"1996-12-10\" \"1996-12-11\" \"1996-12-12\" \"1996-12-13\" \"1996-12-14\" #>  [656] \"1996-12-15\" \"1996-12-16\" \"1996-12-17\" \"1996-12-18\" \"1996-12-19\" #>  [661] \"1996-12-20\" \"1996-12-21\" \"1996-12-22\" \"1996-12-23\" \"1996-12-24\" #>  [666] \"1996-12-25\" \"1996-12-26\" \"1996-12-27\" \"1996-12-28\" \"1996-12-29\" #>  [671] \"1996-12-30\" \"1996-12-31\" \"1997-01-01\" \"1997-01-02\" \"1997-01-03\" #>  [676] \"1997-01-04\" \"1997-01-05\" \"1997-01-06\" \"1997-01-07\" \"1997-01-08\" #>  [681] \"1997-01-09\" \"1997-01-10\" \"1997-01-11\" \"1997-01-12\" \"1997-01-13\" #>  [686] \"1997-01-14\" \"1997-01-15\" \"1997-01-16\" \"1997-01-17\" \"1997-01-18\" #>  [691] \"1997-01-19\" \"1997-01-20\" \"1997-01-21\" \"1997-01-22\" \"1997-01-23\" #>  [696] \"1997-01-24\" \"1997-01-25\" \"1997-01-26\" \"1997-01-27\" \"1997-01-28\" #>  [701] \"1997-01-29\" \"1997-01-30\" \"1997-01-31\" \"1997-02-01\" \"1997-02-02\" #>  [706] \"1997-02-03\" \"1997-02-04\" \"1997-02-05\" \"1997-02-06\" \"1997-02-07\" #>  [711] \"1997-02-08\" \"1997-02-09\" \"1997-02-10\" \"1997-02-11\" \"1997-02-12\" #>  [716] \"1997-02-13\" \"1997-02-14\" \"1997-02-15\" \"1997-02-16\" \"1997-02-17\" #>  [721] \"1997-02-18\" \"1997-02-19\" \"1997-02-20\" \"1997-02-21\" \"1997-02-22\" #>  [726] \"1997-02-23\" \"1997-02-24\" \"1997-02-25\" \"1997-02-26\" \"1997-02-27\" #>  [731] \"1997-02-28\" \"1997-03-01\" \"1997-03-02\" \"1997-03-03\" \"1997-03-04\" #>  [736] \"1997-03-05\" \"1997-03-06\" \"1997-03-07\" \"1997-03-08\" \"1997-03-09\" #>  [741] \"1997-03-10\" \"1997-03-11\" \"1997-03-12\" \"1997-03-13\" \"1997-03-14\" #>  [746] \"1997-03-15\" \"1997-03-16\" \"1997-03-17\" \"1997-03-18\" \"1997-03-19\" #>  [751] \"1997-03-20\" \"1997-03-21\" \"1997-03-22\" \"1997-03-23\" \"1997-03-24\" #>  [756] \"1997-03-25\" \"1997-03-26\" \"1997-03-27\" \"1997-03-28\" \"1997-03-29\" #>  [761] \"1997-03-30\" \"1997-03-31\" \"1997-04-01\" \"1997-04-02\" \"1997-04-03\" #>  [766] \"1997-04-04\" \"1997-04-05\" \"1997-04-06\" \"1997-04-07\" \"1997-04-08\" #>  [771] \"1997-04-09\" \"1997-04-10\" \"1997-04-11\" \"1997-04-12\" \"1997-04-13\" #>  [776] \"1997-04-14\" \"1997-04-15\" \"1997-04-16\" \"1997-04-17\" \"1997-04-18\" #>  [781] \"1997-04-19\" \"1997-04-20\" \"1997-04-21\" \"1997-04-22\" \"1997-04-23\" #>  [786] \"1997-04-24\" \"1997-04-25\" \"1997-04-26\" \"1997-04-27\" \"1997-04-28\" #>  [791] \"1997-04-29\" \"1997-04-30\" \"1997-05-01\" \"1997-05-02\" \"1997-05-03\" #>  [796] \"1997-05-04\" \"1997-05-05\" \"1997-05-06\" \"1997-05-07\" \"1997-05-08\" #>  [801] \"1997-05-09\" \"1997-05-10\" \"1997-05-11\" \"1997-05-12\" \"1997-05-13\" #>  [806] \"1997-05-14\" \"1997-05-15\" \"1997-05-16\" \"1997-05-17\" \"1997-05-18\" #>  [811] \"1997-05-19\" \"1997-05-20\" \"1997-05-21\" \"1997-05-22\" \"1997-05-23\" #>  [816] \"1997-05-24\" \"1997-05-25\" \"1997-05-26\" \"1997-05-27\" \"1997-05-28\" #>  [821] \"1997-05-29\" \"1997-05-30\" \"1997-05-31\" \"1997-06-01\" \"1997-06-02\" #>  [826] \"1997-06-03\" \"1997-06-04\" \"1997-06-05\" \"1997-06-06\" \"1997-06-07\" #>  [831] \"1997-06-08\" \"1997-06-09\" \"1997-06-10\" \"1997-06-11\" \"1997-06-12\" #>  [836] \"1997-06-13\" \"1997-06-14\" \"1997-06-15\" \"1997-06-16\" \"1997-06-17\" #>  [841] \"1997-06-18\" \"1997-06-19\" \"1997-06-20\" \"1997-06-21\" \"1997-06-22\" #>  [846] \"1997-06-23\" \"1997-06-24\" \"1997-06-25\" \"1997-06-26\" \"1997-06-27\" #>  [851] \"1997-06-28\" \"1997-06-29\" \"1997-06-30\" \"1997-07-01\" \"1997-07-02\" #>  [856] \"1997-07-03\" \"1997-07-04\" \"1997-07-05\" \"1997-07-06\" \"1997-07-07\" #>  [861] \"1997-07-08\" \"1997-07-09\" \"1997-07-10\" \"1997-07-11\" \"1997-07-12\" #>  [866] \"1997-07-13\" \"1997-07-14\" \"1997-07-15\" \"1997-07-16\" \"1997-07-17\" #>  [871] \"1997-07-18\" \"1997-07-19\" \"1997-07-20\" \"1997-07-21\" \"1997-07-22\" #>  [876] \"1997-07-23\" \"1997-07-24\" \"1997-07-25\" \"1997-07-26\" \"1997-07-27\" #>  [881] \"1997-07-28\" \"1997-07-29\" \"1997-07-30\" \"1997-07-31\" \"1997-08-01\" #>  [886] \"1997-08-02\" \"1997-08-03\" \"1997-08-04\" \"1997-08-05\" \"1997-08-06\" #>  [891] \"1997-08-07\" \"1997-08-08\" \"1997-08-09\" \"1997-08-10\" \"1997-08-11\" #>  [896] \"1997-08-12\" \"1997-08-13\" \"1997-08-14\" \"1997-08-15\" \"1997-08-16\" #>  [901] \"1997-08-17\" \"1997-08-18\" \"1997-08-19\" \"1997-08-20\" \"1997-08-21\" #>  [906] \"1997-08-22\" \"1997-08-23\" \"1997-08-24\" \"1997-08-25\" \"1997-08-26\" #>  [911] \"1997-08-27\" \"1997-08-28\" \"1997-08-29\" \"1997-08-30\" \"1997-08-31\" #>  [916] \"1997-09-01\" \"1997-09-02\" \"1997-09-03\" \"1997-09-04\" \"1997-09-05\" #>  [921] \"1997-09-06\" \"1997-09-07\" \"1997-09-08\" \"1997-09-09\" \"1997-09-10\" #>  [926] \"1997-09-11\" \"1997-09-12\" \"1997-09-13\" \"1997-09-14\" \"1997-09-15\" #>  [931] \"1997-09-16\" \"1997-09-17\" \"1997-09-18\" \"1997-09-19\" \"1997-09-20\" #>  [936] \"1997-09-21\" \"1997-09-22\" \"1997-09-23\" \"1997-09-24\" \"1997-09-25\" #>  [941] \"1997-09-26\" \"1997-09-27\" \"1997-09-28\" \"1997-09-29\" \"1997-09-30\" #>  [946] \"1997-10-01\" \"1997-10-02\" \"1997-10-03\" \"1997-10-04\" \"1997-10-05\" #>  [951] \"1997-10-06\" \"1997-10-07\" \"1997-10-08\" \"1997-10-09\" \"1997-10-10\" #>  [956] \"1997-10-11\" \"1997-10-12\" \"1997-10-13\" \"1997-10-14\" \"1997-10-15\" #>  [961] \"1997-10-16\" \"1997-10-17\" \"1997-10-18\" \"1997-10-19\" \"1997-10-20\" #>  [966] \"1997-10-21\" \"1997-10-22\" \"1997-10-23\" \"1997-10-24\" \"1997-10-25\" #>  [971] \"1997-10-26\" \"1997-10-27\" \"1997-10-28\" \"1997-10-29\" \"1997-10-30\" #>  [976] \"1997-10-31\" \"1997-11-01\" \"1997-11-02\" \"1997-11-03\" \"1997-11-04\" #>  [981] \"1997-11-05\" \"1997-11-06\" \"1997-11-07\" \"1997-11-08\" \"1997-11-09\" #>  [986] \"1997-11-10\" \"1997-11-11\" \"1997-11-12\" \"1997-11-13\" \"1997-11-14\" #>  [991] \"1997-11-15\" \"1997-11-16\" \"1997-11-17\" \"1997-11-18\" \"1997-11-19\" #>  [996] \"1997-11-20\" \"1997-11-21\" \"1997-11-22\" \"1997-11-23\" \"1997-11-24\""},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"Given previous state random number `rn`, function returns next state 3-state first-order Markov chain. transition probabilities state- index-specific.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"","code":"markov_next_state(prev_state, rn, idx, p00, p01, p10, p11, p20, p21)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"prev_state Integer. current (previous) state (0, 1, 2). rn Numeric. random number [0, 1] used sample next state. idx Integer. Index selecting transition probabilities (e.g., time step spatial location). p00 Numeric vector. Probability transition state 0 0. p01 Numeric vector. Probability transition state 0 1. p10 Numeric vector. Probability transition state 1 0. p11 Numeric vector. Probability transition state 1 1. p20 Numeric vector. Probability transition state 2 0. p21 Numeric vector. Probability transition state 2 1.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"Integer. next state (0, 1, 2).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"States typically defined : - 0: Dry - 1: Wet - 2: Extreme transition determined using cumulative probabilities transitions state 0 1. remaining probability assigned state 2.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/markov_next_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Next State in a First-Order Markov Chain ‚Äî markov_next_state","text":"","code":"# Suppose we're at time step 5 with current state = 1 set.seed(123) rn <- runif(1) markov_next_state(   prev_state = 1,   rn = rn,   idx = 5,   p00 = rep(0.7, 10),   p01 = rep(0.2, 10),   p10 = rep(0.3, 10),   p11 = rep(0.4, 10),   p20 = rep(0.1, 10),   p21 = rep(0.3, 10) ) #> [1] 0"},{"path":"https://github.com/Deltares-research/weathergenr/reference/mean_spell_length.html","id":null,"dir":"Reference","previous_headings":"","what":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","title":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","text":"Computes mean length contiguous runs (\"spells\") numeric time series threshold-based classification. input vector first converted binary occurrence series using supplied threshold. Consecutive days state grouped spells, mean spell length calculated either -threshold -threshold state. function typically used diagnose wet dry spell persistence daily precipitation hydro-meteorological time series suitable validating stochastic weather generators Markov-chain occurrence models.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/mean_spell_length.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","text":"","code":"mean_spell_length(x, threshold = 0, below = TRUE)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/mean_spell_length.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","text":"x Numeric vector. Daily values weather variable (example precipitation temperature). Missing values explicitly handled removed beforehand present. threshold Numeric scalar. Threshold used classify days two states. Values less equal threshold considered \"-threshold\"; values threshold considered \"-threshold\". Logical. TRUE (default), mean length -threshold spells (example dry spells) returned. FALSE, mean length -threshold spells (example wet spells) returned.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/mean_spell_length.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","text":"single numeric value giving mean spell length (days) selected state. Returns: NA_real_ x zero length, 0 spells selected type present.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/mean_spell_length.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Mean Spell Length Above or Below a Threshold ‚Äî mean_spell_length","text":"spell defined maximal sequence consecutive days belonging threshold-defined state. Spell lengths computed transitions binary occurrence series derived x. function treats values exactly equal threshold -threshold. convention kept consistent occurrence Markov-state definitions used analysis.","code":""},{"path":[]},{"path":"https://github.com/Deltares-research/weathergenr/reference/monthly_markov_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","text":"Estimates month-specific transition probabilities three-state precipitation occurrence Markov chain (dry, wet, wet) observed daily precipitation data, maps probabilities onto simulated time axis. Transition probabilities inferred observed lag-1 lag-0 precipitation pairs using month-dependent wet extreme thresholds. Dirichlet-type smoothing applied avoid zero-probability transitions, effective smoothing strength decreasing automatically number observed transitions per month. function supports calendar-year water-year simulations. regime inferred month.list: month.list[1] == 1, calendar-year logic used; otherwise, water-year logic assumed. Optional spell-persistence modifiers applied dry wet states influence transition persistence. adjustments, transition probabilities explicitly normalized ensure stochastic validity (non-negativity rows summing one). estimated monthly transition probabilities assigned simulated days fall within target simulation year corresponding calendar month.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/monthly_markov_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","text":"","code":"monthly_markov_probs(   precip.lag0,   precip.lag1,   month.lag0,   month.lag1,   year.lag0 = NULL,   year.lag1 = NULL,   wet.threshold,   extreme.threshold,   month.list,   sim.months,   sim.water.years,   year.idx,   sim.start.year,   dry.spell.change,   wet.spell.change,   sim.length,   alpha = 1 )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/monthly_markov_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","text":"precip.lag0 Numeric vector. Observed daily precipitation lag 0 (current day) used estimate state transitions. precip.lag1 Numeric vector. Observed daily precipitation lag 1 (previous day) used estimate state transitions. month.lag0 Integer vector (1-12). Calendar month corresponding precip.lag0. month.lag1 Integer vector (1-12). Calendar month corresponding precip.lag1. year.lag0 Optional integer vector. Calendar year water year corresponding precip.lag0. provided together year.lag1, transitions restricted -year pairs. year.lag1 Optional integer vector. Calendar year water year corresponding precip.lag1. wet.threshold Numeric vector length 12. Monthly precipitation thresholds separating dry wet states, aligned month.list. extreme.threshold Numeric vector length 12. Monthly precipitation thresholds separating wet wet states, aligned month.list. month.list Integer vector length 12 defining simulated ordering months (example 1:12 calendar years c(10:12, 1:9) October-start water years). sim.months Integer vector. Calendar month simulated day. sim.water.years Integer vector. Simulation year (calendar water year, depending regime) simulated day. year.idx Integer. Index current simulated year (1-based). sim.start.year Integer. First year simulation, interpreted calendar year water year depending simulation regime. dry.spell.change Numeric vector length 12. Monthly multiplicative factors controlling dry-state persistence. wet.spell.change Numeric vector length 12. Monthly multiplicative factors controlling wet-state persistence. sim.length Integer. Total number simulated days. Determines length returned probability vectors. alpha Numeric. Base smoothing strength transition-probability estimation. effective smoothing applied month alpha / sqrt(N_m), N_m number observed transitions month.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/monthly_markov_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","text":"named list nine numeric vectors, length sim.length, representing time-varying transition probabilities: p00_final: P(dry dry) p01_final: P(dry wet) p02_final: P(dry wet) p10_final: P(wet dry) p11_final: P(wet wet) p12_final: P(wet wet) p20_final: P(wet dry) p21_final: P(wet wet) p22_final: P(wet wet)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/monthly_markov_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities ‚Äî monthly_markov_probs","text":"Precipitation occurrence states defined : Dry Precipitation less equal monthly wet threshold Wet Precipitation greater wet threshold less              equal extreme threshold wet Precipitation greater extreme threshold transition-probability rows explicitly normalized smoothing spell adjustments ensure valid Markov-chain behavior.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"Calculates key parameters Morlet wavelet transform, including Fourier factor (scale--period conversion), cone influence (COI), minimum degrees freedom.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"","code":"morlet_parameters(k0 = 6)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"k0 Numeric scalar. Omega0 parameter Morlet wavelet (default = 6). Standard choice 6, gives ~6 oscillations per wavelet.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"Named numeric vector three elements:   fourier_factor: Conversion factor wavelet scale Fourier period   coi: Cone influence e-folding time   dofmin: Minimum degrees freedom (2 Morlet)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"Fourier factor allows conversion wavelet scale s equivalent Fourier period T: T = (4*pi / (k_0 + sqrt(2 + k_0^2))) * s cone influence (COI) defines e-folding time edge effects: COI = fourier_factor / sqrt(2) Values outside COI subject edge artifacts interpreted caution.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"Torrence, C. Compo, G.P. (1998). Practical Guide Wavelet Analysis. Bulletin American Meteorological Society, 79(1), 61-78. See Table 1 Section 3f.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_parameters.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Morlet Wavelet Parameters ‚Äî morlet_parameters","text":"","code":"# Standard Morlet wavelet parameters params <- morlet_parameters(k0 = 6) print(params) #> fourier_factor            coi         dofmin  #>      1.0330436      0.7304722      2.0000000  # fourier_factor: 1.03 # coi: 0.73 # dofmin: 2"},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":null,"dir":"Reference","previous_headings":"","what":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"Computes Morlet wavelet function Fourier space given scale. \"daughter\" wavelet used continuous wavelet transform analysis. function applies normalization following Torrence & Compo (1998).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"","code":"morlet_wavelet(k, s, k0 = 6)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"k Numeric vector. Wave number vector (angular frequency). s Numeric scalar. Scale parameter (inverse frequency). k0 Numeric scalar. Omega0 parameter Morlet wavelet (default = 6). value balances time frequency localization.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"Numeric vector (complex). Morlet wavelet Fourier space,   length equal length(k).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"Morlet wavelet defined Fourier space : psi(s k) = pi^(-1/4) * sqrt(s k_2 n) * exp(-(s k - k_0)^2 / 2) exponential term applied positive frequencies. normalization factor ensures energy conservation proper inverse transform reconstruction.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/morlet_wavelet.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Morlet Wavelet in Fourier Domain ‚Äî morlet_wavelet","text":"Torrence, C. Compo, G.P. (1998). Practical Guide Wavelet Analysis. Bulletin American Meteorological Society, 79(1), 61-78.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pad_right.html","id":null,"dir":"Reference","previous_headings":"","what":"Pad string to the right ‚Äî pad_right","title":"Pad string to the right ‚Äî pad_right","text":"Pad string right","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pad_right.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pad string to the right ‚Äî pad_right","text":"","code":"pad_right(x, width)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/pad_right.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pad string to the right ‚Äî pad_right","text":"x Character string width Target width","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pad_right.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pad string to the right ‚Äî pad_right","text":"Padded character string","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"Computes monthly mean potential evapotranspiration (PET) using Hargreaves temperature-based method. PET estimated mean air temperature, diurnal temperature range, extraterrestrial radiation derived latitude time year. implementation follows FAO-56 formulation returns PET units millimeters per day (mm/day).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"","code":"pet_hargreaves(months, temp, tdiff, lat)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"months Integer vector (1-12). Calendar months corresponding PET estimate. temp Numeric vector. Mean monthly air temperature (degrees C). tdiff Numeric vector. Monthly diurnal temperature range (Tmax ??? Tmin, degrees C). Must non-negative. lat Numeric scalar. Latitude decimal degrees (positive north, negative south).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"Numeric vector monthly potential evapotranspiration values mm/day, length equal `length(months)`.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"Extraterrestrial radiation computed using fixed representative day year middle month. Radiation converted MJ m^2/day equivalent evaporation depth using FAO conversion factor 0.408. Hargreaves equation : $$ PET = 0.0023 * Ra * (T + 17.8) * sqrt(Tmax - Tmin) $$ Ra extraterrestrial radiation.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pet_hargreaves.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Estimate Monthly Potential Evapotranspiration (Hargreaves Method) ‚Äî pet_hargreaves","text":"Hargreaves, G.H. Samani, Z.. (1985). Reference crop evapotranspiration temperature. Applied Engineering Agriculture, 1(2), 96-99. FAO (1998). Crop Evapotranspiration (FAO Irrigation Drainage Paper 56).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pick_year_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick a random contiguous window of years of length n_years from a year vector ‚Äî pick_year_window","title":"Pick a random contiguous window of years of length n_years from a year vector ‚Äî pick_year_window","text":"Pick random contiguous window years length n_years year vector","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/pick_year_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick a random contiguous window of years of length n_years from a year vector ‚Äî pick_year_window","text":"","code":"pick_year_window(years, n_years)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot.qmap_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot method for qmap_diagnostics ‚Äî plot.qmap_diagnostics","title":"Plot method for qmap_diagnostics ‚Äî plot.qmap_diagnostics","text":"Plot method qmap_diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot.qmap_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot method for qmap_diagnostics ‚Äî plot.qmap_diagnostics","text":"","code":"# S3 method for class 'qmap_diagnostics' plot(x, which = c(\"all\", \"moments\", \"quantiles\", \"extremes\", \"monthly\"), ...)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_filter_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Create diagnostic plots for filtered pool ‚Äî plot_filter_diagnostics","title":"Create diagnostic plots for filtered pool ‚Äî plot_filter_diagnostics","text":"Internal function used filter_warm_simulations() create diagnostic plots. Shows time series, statistics scatter, wavelet GWS comparisons.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_filter_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create diagnostic plots for filtered pool ‚Äî plot_filter_diagnostics","text":"","code":"plot_filter_diagnostics(   obs.use,   series_sim_for_stats,   pool,   rel.diff.mean,   rel.diff.sd,   tail_metrics,   power.period,   power.obs,   power.signif,   gws_cache_mat,   wavelet_q = c(0.05, 0.95) )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_filter_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create diagnostic plots for filtered pool ‚Äî plot_filter_diagnostics","text":"obs.use Numeric vector observed values series_sim_for_stats Numeric matrix simulated values pool Integer vector pool indices rel.diff.mean Relative differences mean rel.diff.sd Relative differences SD tail_metrics Tail metrics list power.period Wavelet periods power.obs Observed GWS power.signif Significance curve gws_cache_mat Cached GWS matrix (n_periods x n_realizations) wavelet_q Two quantiles ribbon (e.g., c(0.50, 0.95))","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_filter_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create diagnostic plots for filtered pool ‚Äî plot_filter_diagnostics","text":"List ggplot objects (timeseries, stats, wavelet_gws)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"Generates publication quality plot global wavelet power spectrum. function supports comparison observed spectrum ensemble simulated spectra, displayed using envelope ensemble mean.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"","code":"plot_global_wavelet_spectrum(   power.period,   power.signif,   power.obs,   power.sim = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"power.period Numeric vector. Fourier periods, example years, corresponding wavelet scales used analysis. power.signif Numeric vector. Significance threshold global wavelet power period, example 95 percent confidence level. power.obs Numeric vector. Observed global wavelet power spectrum. power.sim Optional numeric matrix. Simulated global wavelet spectra. Rows correspond periods columns correspond individual simulations. provided, simulation range ensemble mean shown.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"ggplot2 object representing global wavelet power spectrum.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"global wavelet spectrum summarizes wavelet power across time Fourier period. plot commonly used identify dominant variability scales compare observed behavior stochastic climate driven ensembles. Plot behavior follows: observed global wavelet spectrum significance threshold   always plotted. simulated spectra provided, ensemble range shown   ribbon ensemble mean shown solid line.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"Blue solid line: observed global wavelet spectrum Red dashed line: significance threshold Black solid line: ensemble mean, provided Gray ribbon: ensemble envelope defined minimum maximum values,   provided","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_global_wavelet_spectrum.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Global Wavelet Spectrum ‚Äî plot_global_wavelet_spectrum","text":"","code":"if (FALSE) { # \\dontrun{ period <- seq(1, 64) signif <- rep(1500, length(period)) obs <- 2000 * exp(-((period - 15) / 10)^2) + 1000 simmat <- sapply(   1:30,   function(i) obs + rnorm(length(period), sd = 200) )  p <- plot_global_wavelet_spectrum(   power.period = period,   power.signif = signif,   power.obs = obs,   power.sim = simmat ) print(p) } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_wavelet_spectra.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","title":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","text":"Creates two-panel figure showing () time-period wavelet power spectrum (cone influence significance contour) (ii) global wavelet spectrum time series.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_wavelet_spectra.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","text":"","code":"plot_wavelet_spectra(   variable,   variable.year = NULL,   period,   POWER,   GWS,   GWS_signif,   coi,   sigm,   variable.unit = \"mm\" )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_wavelet_spectra.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","text":"variable Numeric vector. original time series (length). variable.year Numeric vector. Year labels x-axis (optional). period Numeric vector. Periods (scales) used wavelet transform. POWER Matrix. Wavelet power spectrum (periods x time). GWS Numeric vector. Global wavelet spectrum (mean power period). GWS_signif Numeric vector. Significance threshold global wavelet spectrum. coi Numeric vector. Cone influence time point. sigm Matrix. Significance mask ratio (periods x time). Contour drawn 1. variable.unit Character. Unit label variable (default \"mm\").","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_wavelet_spectra.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","text":"patchwork plot object time-period power spectrum global wavelet spectrum.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/plot_wavelet_spectra.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Wavelet Power Spectrum and Global Wavelet Spectrum ‚Äî plot_wavelet_spectra","text":"Key plotting choices interpretability: Power plotted log2 scale robust color limits (5th-95th percentiles)         avoid \"washed \" field dynamic range large. spectrum plotted native wavelet grid (interpolation), avoiding         smoothing/extrapolation artifacts can flatten contrast. Uses perceptually uniform viridis color scale.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/prepare_plot_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare data for plotting ‚Äî prepare_plot_data","title":"Prepare data for plotting ‚Äî prepare_plot_data","text":"Prepare data plotting","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/prepare_plot_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare data for plotting ‚Äî prepare_plot_data","text":"","code":"prepare_plot_data(obs.results, sim.results, variables, n_grids)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/print.qmap_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for qmap_diagnostics ‚Äî print.qmap_diagnostics","title":"Print method for qmap_diagnostics ‚Äî print.qmap_diagnostics","text":"Print method qmap_diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/print.qmap_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for qmap_diagnostics ‚Äî print.qmap_diagnostics","text":"","code":"# S3 method for class 'qmap_diagnostics' print(x, ...)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/process_observed_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Process observed weather data ‚Äî process_observed_data","title":"Process observed weather data ‚Äî process_observed_data","text":"Process observed weather data","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/process_observed_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process observed weather data ‚Äî process_observed_data","text":"","code":"process_observed_data(   daily.obs,   variables,   n_grids,   wet.quantile,   extreme.quantile )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/process_simulated_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Process simulated weather data ‚Äî process_simulated_data","title":"Process simulated weather data ‚Äî process_simulated_data","text":"Process simulated weather data","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/process_simulated_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Process simulated weather data ‚Äî process_simulated_data","text":"","code":"process_simulated_data(daily.sim, realization.num, variables, mc.thresholds)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"Applies quantile mapping adjust daily precipitation time series reflect changes monthly mean variance, consistent climate change scenarios. method fits gamma distribution observed nonzero precipitation calendar month, modifies distribution's mean variance according supplied monthly/yearly change factors, maps original values new quantiles perturbed distribution. function designed climate stress-testing workflows impose user-specified changes mean variance daily precipitation data preserving realistic distributional characteristics.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"","code":"quantile_mapping(   value = NULL,   mean.change = NULL,   var.change = NULL,   mon.ts = NULL,   year.ts = NULL,   fit.method = \"mme\",   min.events = 10,   validate.output = TRUE,   verbose = FALSE,   compute.diagnostics = FALSE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"value Numeric vector. Original daily precipitation values perturb (typically one grid cell). Must non-negative. mean.change Numeric matrix mean change factors (multiplicative), dimension: `n_years` x 12 (year, month). entry scales year-month's mean. var.change Numeric matrix variance change factors (multiplicative), dimension: `n_years` x 12 (year, month). entry scales year-month's variance. mon.ts Integer vector (length `value`). Calendar month day (1-12). year.ts Integer vector (length `value`). Simulation year index day (1 = first year, etc). fit.method Character. Method fitting base gamma distribution; passed [fitdistrplus::fitdist()]. Default `\"mme\"` (method moments). min.events Integer. Minimum number non-zero precipitation events required per month distribution fitting. Default 10. validate.output Logical. TRUE, checks output NaN/Inf replaces original values. Default TRUE. verbose Logical. TRUE, prints diagnostic messages months perturbed. Default FALSE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"Numeric vector, length `value`. Precipitation time series perturbed according quantile mapping procedure. Includes attributes: `perturbed_months`: Integer vector months successfully perturbed `skipped_months`: Integer vector months skipped due insufficient data `n_failed_fits`: Number distribution fits failed","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"## Distribution Fitting function fits gamma distribution non-zero precipitation calendar month. Months fewer `min.events` non-zero days skipped. gamma distribution parameterized shape scale parameters derived method moments maximum likelihood estimation. ## Quantile Mapping Procedure 1. Fit base gamma distribution observed non-zero precipitation month 2. Compute target distribution parameters scaling base mean variance 3. Map original value quantile base distribution 4. Transform quantile target distribution ## Limitations - Zero precipitation values remain zero (dry day frequency unchanged) - Requires sufficient non-zero events per month reliable fitting - Extrapolation beyond observed range may produce unrealistic extreme values - Change factors must positive; negative zero values cause errors","code":""},{"path":[]},{"path":"https://github.com/Deltares-research/weathergenr/reference/quantile_mapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Mapping for Climate Change Perturbation of Precipitation ‚Äî quantile_mapping","text":"","code":"if (FALSE) { # \\dontrun{ # Example: 2 years of daily data, 5% mean and 10% variance increase set.seed(123) n_days <- 730 year_idx <- rep(1:2, each = 365) month_idx <- rep(rep(1:12, times = c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)), 2)[1:n_days] daily_precip <- rgamma(n_days, shape = 1, scale = 5)  mean.change <- matrix(1.05, nrow = 2, ncol = 12) var.change <- matrix(1.10, nrow = 2, ncol = 12)  perturbed_precip <- quantile_mapping(   value = daily_precip,   mean.change = mean.change,   var.change = var.change,   mon.ts = month_idx,   year.ts = year_idx )  # Check which months were perturbed attr(perturbed_precip, \"perturbed_months\") attr(perturbed_precip, \"skipped_months\") } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/read_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","title":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","text":"Efficiently reads 3D (x, y, time) gridded variables NetCDF file returns: per-grid-cell tidy time series (list tibbles), grid coordinates indices, Date vector, dimension metadata, variable global attributes. Variable behaviour: variables = NULL -> load data variables (except spatial.ref). variables = c(\"var1\",\"var2\") -> load variables. var_rename = c(old1 = \"new1\", old2 = \"new2\") -> rename subset         loaded variables output (columns, attributes, dimnames).         names var_rename must among selected variables.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/read_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","text":"","code":"read_netcdf(   nc.file,   variables = NULL,   var_rename = NULL,   leap.days = TRUE,   omit.empty = TRUE,   spatial.ref = \"spatial_ref\",   signif.digits = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/read_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","text":"nc.file Character. Path NetCDF file. variables Character vector variable names load. NULL, variables except spatial.ref loaded. Default NULL. var_rename Named character vector giving new names subset loaded variables, e.g. c(precip = \"prcp\", temp = \"T\"). Old names must subset variables (variables variables=NULL). Default NULL. leap.days Logical. Whether data include leap days. FALSE, Feb 29 removed date vector. Default TRUE. omit.empty Logical. TRUE, drop grid cells values NA variables time steps. Default TRUE. spatial.ref Character. Name spatial reference variable NetCDF file (used get x/y dimension names). Default \"spatial_ref\". signif.digits Integer. NULL, values rounded number significant digits. Default NULL.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/read_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","text":"list five components: data List tibbles, one per grid cell. tibble rows         representing time steps columns representing variables. grid Tibble columns id, xind, yind, x, y describing         spatial grid cells. date Vector Date objects length equal number         time steps. dimensions Named list dimension vectors (e.g., x, y, time)         extracted NetCDF file. attributes Named list containing variable attributes (one element         per variable using final renamed names), spatial reference attributes,         global attributes.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/read_netcdf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read a gridded NetCDF file into tidy weather format (fast + memory efficient) ‚Äî read_netcdf","text":"","code":"if (FALSE) { # \\dontrun{ # Load all variables from a NetCDF file weather_data <- read_netcdf(\"climate_data.nc\")  # Load only specific variables and rename them weather_data <- read_netcdf(   nc.file = \"climate_data.nc\",   variables = c(\"precipitation\", \"temperature\"),   var_rename = c(precipitation = \"prcp\", temperature = \"temp\") )  # Load without leap days weather_data <- read_netcdf(\"climate_data.nc\", leap.days = FALSE)  # Round values and keep only non-empty cells weather_data <- read_netcdf(   nc.file = \"climate_data.nc\",   signif.digits = 4,   omit.empty = TRUE ) } # }"},{"path":"https://github.com/Deltares-research/weathergenr/reference/relax_bounds_one_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Relax bounds for one filter ‚Äî relax_bounds_one_filter","title":"Relax bounds for one filter ‚Äî relax_bounds_one_filter","text":"Applies one relaxation step single filter. Updates bounds place returns status.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/relax_bounds_one_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relax bounds for one filter ‚Äî relax_bounds_one_filter","text":"","code":"relax_bounds_one_filter(   filter_name,   bounds_env,   wavelet_active_env,   recompute_tailmass_fn )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/relax_bounds_one_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Relax bounds for one filter ‚Äî relax_bounds_one_filter","text":"filter_name Character. Name filter relax bounds_env Environment containing bounds wavelet_active_env Environment containing wavelet_active flag recompute_tailmass_fn Function recompute tail mass thresholds change","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/relax_bounds_one_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Relax bounds for one filter ‚Äî relax_bounds_one_filter","text":"List changed (logical) msg (character)","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/resample_weather_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","text":"Resamples daily precipitation temperature sequences combining: annual K-nearest-neighbor (KNN) selection observed years, three-state Markov chain wet dry spell persistence, daily KNN resampling precipitation temperature anomalies. function supports calendar-year water-year simulations. regime inferred automatically `year_start_month`: `year_start_month == 1`, calendar-year logic used; otherwise, water-year logic assumed.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/resample_weather_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","text":"","code":"resample_weather_dates(   annual_prcp_sim,   annual_prcp_obs,   daily_prcp_obs,   daily_temp_obs,   sim_start_year,   realization_id,   n_sim_years,   obs_dates_table,   sim_dates_table,   year_start_month = 1,   annual_knn_n = 50,   wet_q = 0.2,   extreme_q = 0.8,   dry_spell_factor = rep(1, 12),   wet_spell_factor = rep(1, 12),   seed = NULL )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/resample_weather_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","text":"annual_prcp_sim Numeric vector length `n_sim_years`. Synthetic annual precipitation totals generated annual model (e.g., WARM), indexed simulated year. annual_prcp_obs Numeric vector. Observed annual precipitation totals corresponding historical water years. daily_prcp_obs Numeric vector. Observed daily precipitation values (leap days), aligned `obs_dates_table`. daily_temp_obs Numeric vector. Observed daily temperature values (leap days), aligned `obs_dates_table`. sim_start_year Integer. First simulation year (calendar year `year_start_month == 1`, otherwise first water year). realization_id Integer. Realization index, used perturb random seed multiple realizations independent. n_sim_years Integer. Number simulated years. obs_dates_table Data frame containing observed date information. Must include columns `date`, `month`, `day`, `wyear`. sim_dates_table Data frame containing simulated date information (leap days). Must include columns `month`, `day`, `wyear`. year_start_month Integer 1:12. First month simulation year. Use 1 calendar-year simulations, another month water-year simulations. annual_knn_n Integer. Number historical years sampled annual KNN step. wet_q Numeric 0 1. Quantile used define wet threshold daily precipitation states. extreme_q Numeric 0 1. Quantile used define wet (extreme) precipitation threshold. dry_spell_factor Numeric vector length 12. Monthly adjustment factors controlling dry spell persistence Markov chain. wet_spell_factor Numeric vector length 12. Monthly adjustment factors controlling wet spell persistence Markov chain. seed Optional integer. Base random seed reproducibility.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/resample_weather_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","text":"`Date` vector length equal `nrow(sim_dates_table)`, giving resampled observed dates corresponding simulated day.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/resample_weather_dates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic ‚Äî resample_weather_dates","text":"simulated year, subset observed water years selected using annual KNN matching `annual_prcp_sim`. Daily weather generated sequentially: first day simulated year sampled observed         days matching simulated month day. Subsequent days generated using Markov chain simulate         wet dry states. Conditional simulated state, candidate observed days         selected using calendar constraints expanded search windows. daily KNN step precipitation temperature anomalies         used select next-day weather values. calendar-year mode (`year_start_month == 1`), transitions cross December January explicitly excluded avoid cross-year contamination.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/standardize_obs_sim_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Standardize obs and sim to same full-year length via random windowing Applies the chosen window consistently across all grids and all realizations. ‚Äî standardize_obs_sim_periods","title":"Standardize obs and sim to same full-year length via random windowing Applies the chosen window consistently across all grids and all realizations. ‚Äî standardize_obs_sim_periods","text":"Standardize obs sim full-year length via random windowing Applies chosen window consistently across grids realizations.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/standardize_obs_sim_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standardize obs and sim to same full-year length via random windowing Applies the chosen window consistently across all grids and all realizations. ‚Äî standardize_obs_sim_periods","text":"","code":"standardize_obs_sim_periods(daily.obs, daily.sim, realization.num, variables)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/summary.qmap_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Summary method for qmap_diagnostics ‚Äî summary.qmap_diagnostics","title":"Summary method for qmap_diagnostics ‚Äî summary.qmap_diagnostics","text":"Summary method qmap_diagnostics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/summary.qmap_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summary method for qmap_diagnostics ‚Äî summary.qmap_diagnostics","text":"","code":"# S3 method for class 'qmap_diagnostics' summary(object, ...)"},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_inputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate inputs for weather assessment ‚Äî validate_inputs","title":"Validate inputs for weather assessment ‚Äî validate_inputs","text":"Validate inputs weather assessment","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_inputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate inputs for weather assessment ‚Äî validate_inputs","text":"","code":"validate_inputs(   daily.sim,   daily.obs,   variables,   realization.num,   wet.quantile,   extreme.quantile )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Validation Diagnostics for Quantile Mapping ‚Äî validate_quantile_mapping","title":"Compute Validation Diagnostics for Quantile Mapping ‚Äî validate_quantile_mapping","text":"Calculates comprehensive validation metrics comparing original adjusted precipitation time series. Evaluates moment preservation, distributional characteristics, extreme values, temporal patterns.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Validation Diagnostics for Quantile Mapping ‚Äî validate_quantile_mapping","text":"","code":"validate_quantile_mapping(   value.original,   value.adjusted,   mon.ts = NULL,   year.ts = NULL,   mean.change = NULL,   var.change = NULL,   wet.threshold = 0.1,   quantiles = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99) )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_quantile_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Validation Diagnostics for Quantile Mapping ‚Äî validate_quantile_mapping","text":"value.original Numeric vector. Original precipitation values. value.adjusted Numeric vector. Adjusted precipitation values (length). mon.ts Integer vector. Month indices (1-12) value. year.ts Integer vector. Year indices value. mean.change Numeric matrix. Target mean change factors (n_years x 12). var.change Numeric matrix. Target variance change factors (n_years x 12). wet.threshold Numeric. Threshold defining wet days (default = 0.1 mm). quantiles Numeric vector. Quantiles evaluate (default = standard set).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/validate_quantile_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Validation Diagnostics for Quantile Mapping ‚Äî validate_quantile_mapping","text":"list class \"qmap_diagnostics\" containing: moments: Data frame moment statistics quantiles: Data frame quantile comparisons extremes: Data frame extreme value metrics temporal: Data frame temporal pattern metrics monthly: List monthly-specific diagnostics spells: Data frame spell length statistics summary: Overall assessment metrics","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_arima.html","id":null,"dir":"Reference","previous_headings":"","what":"Wavelet Autoregressive Modeling (WARM) ‚Äî wavelet_arima","title":"Wavelet Autoregressive Modeling (WARM) ‚Äî wavelet_arima","text":"Simulates synthetic time series modeling wavelet component (signal noise) ARIMA model, summing simulated components. Optionally enforces variance matching preserve statistical properties original components.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_arima.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wavelet Autoregressive Modeling (WARM) ‚Äî wavelet_arima","text":"","code":"wavelet_arima(   wavelet.components = NULL,   sim.year.num = NULL,   sim.num = 1000,   seed = NULL,   match.variance = TRUE,   variance.tolerance = 0.1,   check.diagnostics = FALSE,   verbose = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_arima.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wavelet Autoregressive Modeling (WARM) ‚Äî wavelet_arima","text":"wavelet.components list matrix column (list element) numeric vector corresponding wavelet component (low-frequency signal noise). sim.year.num Integer. Desired length (number years timesteps) simulated series. sim.num Integer. Number synthetic series produce. Default: 1000. seed Optional. Integer random seed reproducibility. match.variance Logical. TRUE, rescale simulated components match variance original components (default: TRUE). Recommended preserving statistical properties. variance.tolerance Numeric. Relative tolerance variance matching (default: 0.1 = 10%). applies match.variance = TRUE. check.diagnostics Logical. TRUE, perform basic ARIMA model diagnostics issue warnings models appear inadequate (default: FALSE). verbose Logical. TRUE, emit informative logger::log_info() messages (default: TRUE). FALSE, suppresses logger::log_info() output function.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_arima.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wavelet Autoregressive Modeling (WARM) ‚Äî wavelet_arima","text":"matrix dimension sim.year.num x sim.num,   column synthetic time series realization.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"Performs continuous wavelet transform (CWT) analysis using Morlet mother wavelet following Torrence & Compo (1998), extensions : cone--influence (COI) aware global spectrum estimation, effective sample size (neff)-based significance testing, defensible AR(1) red-noise background estimation, stable complete signal reconstruction significant scales. function designed **detection diagnostic analysis dominant time scales**, producing orthogonal components. Reconstructed components scale-localized independent.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"","code":"wavelet_spectral_analysis(   variable,   signif.level = 0.9,   noise.type = \"red\",   period.lower.limit = 2,   detrend = FALSE,   mode = c(\"fast\", \"complete\"),   return_diagnostics = TRUE,   return_recon_error = FALSE,   lag1_ci = FALSE,   lag1_ci_level = 0.95,   lag1_boot_n = 500,   seed = NULL,   warn_neff = FALSE,   neff_warn_min = 5,   neff_warn_frac = 0.6 )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"variable Numeric vector. Input time series (regularly spaced, missing values). Minimum length 16 observations. signif.level Numeric scalar (0, 1). Significance level wavelet power global wavelet spectrum tests. Default 0.90. noise.type Character. Background noise model significance testing. One \"white\" \"red\" (default). red noise, AR(1) model estimated using Yule-Walker. period.lower.limit Numeric scalar. Minimum Fourier period (time units) consider identifying significant scales. Default 2. detrend Logical. TRUE, removes linear trend **slope ** (preserves series mean level) wavelet analysis. Default FALSE. mode Character. Computation mode: \"fast\" (default) speed-optimized filtering essential outputs , \"complete\" comprehensive analysis including reconstruction diagnostics. Fast mode returns 9 outputs (~50 KB), complete mode returns 18+ outputs (~5 MB). Fast mode ~3x faster skipping signal reconstruction detailed diagnostics. return_diagnostics Logical. DEPRECATED. Use mode = \"complete\" instead. TRUE, forces complete mode returns internal diagnostic quantities. return_recon_error Logical. TRUE, returns scalar reconstruction error metrics verifying closure reconstructed components. lag1_ci Logical. TRUE, computes bootstrap confidence interval AR(1) coefficient (diagnostic ; affect inference). lag1_ci_level Numeric scalar (0, 1). Confidence level AR(1) bootstrap interval. Default 0.95. lag1_boot_n Integer. Number bootstrap replicates used estimate AR(1) confidence interval. Default 500. seed Optional numeric scalar. Random seed reproducible bootstrap diagnostics. Default NULL. warn_neff Logical. TRUE (default), emits warning effective sample size small scales. neff_warn_min Numeric scalar. Threshold neff considered small. Default 5. neff_warn_frac Numeric scalar (0, 1). Fraction scales neff < neff_warn_min required trigger warning. Default 0.60.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"list outputs depending mode: Fast mode (9 outputs): gws Numeric vector. COI-masked global wavelet spectrum. gws_unmasked Numeric vector. Unmasked global wavelet spectrum (plotting ). gws_period Numeric vector. Fourier periods corresponding wavelet scales. gws_signif Numeric vector. COI- neff-corrected significance threshold (inference). gws_signif_unmasked Numeric vector. Unmasked significance threshold (plotting ). has_significance Logical. Indicates whether significant scales found. signif_periods Integer vector. Indices significant wavelet scales. coi Numeric vector. Cone influence time units. power Numeric matrix. Wavelet power spectrum (basic plotting). Complete mode (additional 10+ outputs): power_coi Numeric matrix. COI-masked wavelet power. sigm Numeric matrix. Pointwise significance ratio (unmasked). sigm_coi Numeric matrix. COI-masked pointwise significance ratio. power_signif_coi Logical matrix. COI-masked pointwise significance mask. wave Complex matrix. Wavelet coefficients (scales x time). comps Numeric matrix. Reconstructed components significant scales plus residual. comps_names Character vector. Column names comps. gws_n_coi Numeric vector. Number time points inside COI per scale. gws_neff Numeric vector. Effective sample size per scale (masked). gws_neff_unmasked Numeric vector. Effective sample size per scale (unmasked). diagnostics List. Returned return_diagnostics = TRUE. reconstruction_error List. Returned return_recon_error = TRUE.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"implementation follows Torrence & Compo (1998) Morlet wavelet, following methodological refinements: two-sided (TC98-consistent) wavelet normalization, COI-masked global wavelet spectrum, effective degrees freedom based wavelet decorrelation time, separation inference curves plotting curves. Reconstructed components correspond **individual wavelet scales** additive orthogonal. interpreted independent stochastic modes.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/wavelet_spectral_analysis.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance ‚Äî wavelet_spectral_analysis","text":"Torrence, C., & Compo, G. P. (1998). practical guide wavelet analysis. Bulletin American Meteorological Society, 79(1), 61-78.","code":""},{"path":[]},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"Writes gridded climate/weather time series NetCDF file using template NetCDF schema source (dimensions, spatial reference variable, global attributes). function expects list grid-cell payloads (containing identical variable names equal-length time series) places cell output raster cube according coord.grid indices. Output written NetCDF-4 optional compression optional early rounding values.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"","code":"write_netcdf(   data = NULL,   coord.grid = NULL,   output.path = NULL,   origin.date = NULL,   calendar.type = \"noleap\",   nc.template.file = NULL,   nc.compression = 4,   nc.spatial.ref = \"spatial_ref\",   nc.file.prefix = \"clim_change_rlz\",   nc.file.suffix = \"\",   signif.digits = NULL,   verbose = TRUE )"},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"data List length nrow(coord.grid). element named list numeric vectors (time series) variable written. list elements must identical variable names identical time series lengths. coord.grid Data frame mapping grid cells template indices. Must contain integer columns xind yind (1-based indices) nrow(coord.grid) == length(data). Indices must within template x/y bounds. output.path Character string. Directory NetCDF file written. Created exist. origin.date Date character coercible Date. Used define time units (days since origin date 00:00:00). calendar.type Character string. NetCDF calendar attribute time dimension (e.g., \"noleap\"). Passed ncdf4::ncdim_def(). nc.template.file Character string. Path existing template NetCDF file used infer dimensions, coordinate values, spatial reference, global attributes. nc.compression Integer [0, 9]. NetCDF-4 deflate compression level applied output variables. nc.spatial.ref Character string. Name spatial reference variable template copy output (default \"spatial_ref\"). variable must contain attributes x_dim y_dim. nc.file.prefix Character string. Output file prefix (base name without extension). nc.file.suffix Character string. Optional suffix appended file name underscore. \"\", suffix added. signif.digits Optional integer. provided, values data rounded using round(x, signif.digits) prior writing. verbose Logical scalar. TRUE, progress messages emitted using logger::log_info() [NetCDF] tag.","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"Invisibly returns full path written NetCDF file (character scalar).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"template file provided via nc.template.file opened : validate spatial reference variable nc.spatial.ref exists; read x_dim y_dim attributes spatial reference variable         determine x/y dimension names template; copy spatial reference variable values attributes output file; copy template global attributes output file (best-effort); define output x/y dimension coordinate values based template dimension values. time dimension defined 0:(nt - 1) units \"days since <origin.date> 00:00:00\" specified calendar.type. variable data[[1]] written 3D array dimension order time x y x x. Grid cells inserted [ , yind, xind ] locations. output filename constructed : file.path(output.path, paste0(nc.file.prefix, optional_suffix, \".nc\")) optional_suffix paste0(\"_\", nc.file.suffix) nc.file.suffix != \"\".","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"file-structure","dir":"Reference","previous_headings":"","what":"File structure","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"Dimensions: time, template y, template x Variables: one variable per name names(data[[1]]), plus nc.spatial.ref Global attributes: copied template (best-effort) plus creation_date         created_with","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"side-effects","dir":"Reference","previous_headings":"","what":"Side effects","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"Creates directories (needed), writes NetCDF file, may overwrite existing output file name (warning issued).","code":""},{"path":"https://github.com/Deltares-research/weathergenr/reference/write_netcdf.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write Gridded Data to a NetCDF File (Template-Based) ‚Äî write_netcdf","text":"","code":"if (FALSE) { # \\dontrun{ # Minimal example (schematic) coord.grid <- data.frame(xind = c(1, 2), yind = c(1, 1)) data <- list(   list(prcp = rnorm(365), tavg = rnorm(365)),   list(prcp = rnorm(365), tavg = rnorm(365)) )  out_file <- write_netcdf(   data = data,   coord.grid = coord.grid,   output.path = \"out\",   origin.date = \"1990-01-01\",   calendar.type = \"noleap\",   nc.template.file = \"template.nc\",   nc.file.prefix = \"clim_change_rlz\",   nc.file.suffix = \"run01\",   nc.compression = 4,   signif.digits = 3,   verbose = TRUE ) } # }"}]
