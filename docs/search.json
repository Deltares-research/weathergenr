[{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with weathergenr","text":"weathergenr package provides comprehensive toolkit stochastic weather generation climate data analysis. implements sophisticated statistical methods create synthetic daily weather series preserve statistical properties observed climate data enabling scenario-based climate impact assessments. vignette demonstrates core workflow: Reading gridded meteorological data NetCDF files Generating synthetic weather realizations using coupled statistical methods Evaluating quality synthetic weather historical observations Related functions [read_netcdf()] [generate_weather()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [analyze_wavelet_spectrum()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"load-required-packages","dir":"Articles","previous_headings":"","what":"Load Required Packages","title":"Getting Started with weathergenr","text":"Related functions [read_netcdf()] [generate_weather()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [analyze_wavelet_spectrum()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"reading-gridded-multivariate-weather-data","dir":"Articles","previous_headings":"","what":"Reading Gridded Multivariate Weather Data","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution.  Map Ntoum Basin, Gabon read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6 3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"about-the-example-dataset","dir":"Articles","previous_headings":"","what":"About the Example Dataset","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution.  Map Ntoum Basin, Gabon","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"loading-netcdf-data","dir":"Articles","previous_headings":"","what":"Loading NetCDF Data","title":"Getting Started with weathergenr","text":"read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6 3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"key-features","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Key Features","title":"Getting Started with weathergenr","text":"function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-the-output-structure","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Understanding the Output Structure","title":"Getting Started with weathergenr","text":"read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":"# Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6 3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"time-series-data","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"1. Time Series Data","title":"Getting Started with weathergenr","text":"data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint.","code":"# Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6 3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spatial-grid-information","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"2. Spatial Grid Information","title":"Getting Started with weathergenr","text":"grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates)","code":"# View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5 2     2     2     1      9.75      0.5 3     3     3     1     10         0.5 4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"temporal-information","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"3. Temporal Information","title":"Getting Started with weathergenr","text":"date element contains complete time axis vector Date objects:","code":"# Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"dimension-vectors","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"4. Dimension Vectors","title":"Getting Started with weathergenr","text":"dimensions element stores raw dimension vectors NetCDF file:","code":"# View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"metadata-attributes","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"5. Metadata Attributes","title":"Getting Started with weathergenr","text":"attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"advanced-usage","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Advanced Usage","title":"Getting Started with weathergenr","text":"read_netcdf() function supports several optional parameters customized data loading:","code":"# Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"generating-stochastic-weather-realizations","dir":"Articles","previous_headings":"","what":"Generating Stochastic Weather Realizations","title":"Getting Started with weathergenr","text":"generate_weather() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013). First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile) function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Create a temporary directory for outputs output_path <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3 # Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather(   obs_data = ncdata$data,   obs_grid = ncdata$grid,   obs_dates = ncdata$date,   vars = variables,   n_years = 20,   start_year = 2020,   year_start_month = 1,   n_realizations = realization_num,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 10000,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   out_dir = output_path,   seed = seed,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2015-01-01\" \"2016-01-20\" \"2015-01-02\" \"2015-01-03\" [6] \"2015-01-07\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3    <date>     <date>     <date>  1 2016-01-01 2017-01-01 2015-01-01  2 2015-01-01 2017-01-04 2005-01-28  3 2016-01-20 2002-01-02 2010-01-29  4 2015-01-02 2002-01-07 2010-01-16  5 2015-01-03 2002-01-08 2010-01-04  6 2015-01-07 2002-01-09 2010-01-05  7 2015-01-09 2002-01-10 2010-01-06  8 2015-01-10 2002-01-07 2010-01-11  9 2015-01-10 2014-01-08 2010-01-12 10 2015-01-10 2014-01-08 2010-01-10 # ℹ 7,290 more rows # Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"overview-of-the-weather-generation-method","dir":"Articles","previous_headings":"","what":"Overview of the Weather Generation Method","title":"Getting Started with weathergenr","text":"generate_weather() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"statistical-components","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Statistical Components","title":"Getting Started with weathergenr","text":"Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"setting-up-the-simulation","dir":"Articles","previous_headings":"","what":"Setting Up the Simulation","title":"Getting Started with weathergenr","text":"First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile)","code":"# Create a temporary directory for outputs output_path <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-simulation-parameters","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Understanding Simulation Parameters","title":"Getting Started with weathergenr","text":"Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile)","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"running-the-weather-generator","dir":"Articles","previous_headings":"","what":"Running the Weather Generator","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather(   obs_data = ncdata$data,   obs_grid = ncdata$grid,   obs_dates = ncdata$date,   vars = variables,   n_years = 20,   start_year = 2020,   year_start_month = 1,   n_realizations = realization_num,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 10000,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   out_dir = output_path,   seed = seed,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2015-01-01\" \"2016-01-20\" \"2015-01-02\" \"2015-01-03\" [6] \"2015-01-07\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3    <date>     <date>     <date>  1 2016-01-01 2017-01-01 2015-01-01  2 2015-01-01 2017-01-04 2005-01-28  3 2016-01-20 2002-01-02 2010-01-29  4 2015-01-02 2002-01-07 2010-01-16  5 2015-01-03 2002-01-08 2010-01-04  6 2015-01-07 2002-01-09 2010-01-05  7 2015-01-09 2002-01-10 2010-01-06  8 2015-01-10 2002-01-07 2010-01-11  9 2015-01-10 2014-01-08 2010-01-12 10 2015-01-10 2014-01-08 2010-01-10 # ℹ 7,290 more rows"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-the-output","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Understanding the Output","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded)","code":"# View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2015-01-01\" \"2016-01-20\" \"2015-01-02\" \"2015-01-03\" [6] \"2015-01-07\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"interpreting-resampled-dates","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Interpreting Resampled Dates","title":"Getting Started with weathergenr","text":"resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3    <date>     <date>     <date>  1 2016-01-01 2017-01-01 2015-01-01  2 2015-01-01 2017-01-04 2005-01-28  3 2016-01-20 2002-01-02 2010-01-29  4 2015-01-02 2002-01-07 2010-01-16  5 2015-01-03 2002-01-08 2010-01-04  6 2015-01-07 2002-01-09 2010-01-05  7 2015-01-09 2002-01-10 2010-01-06  8 2015-01-10 2002-01-07 2010-01-11  9 2015-01-10 2014-01-08 2010-01-12 10 2015-01-10 2014-01-08 2010-01-10 # ℹ 7,290 more rows"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"extracting-synthetic-weather-data","dir":"Articles","previous_headings":"","what":"Extracting Synthetic Weather Data","title":"Getting Started with weathergenr","text":"access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"evaluating-synthetic-weather-series","dir":"Articles","previous_headings":"","what":"Evaluating Synthetic Weather Series","title":"Getting Started with weathergenr","text":"Validating weather generator’s performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions. evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).              Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) }) # Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily_sim = rlz_sample,   daily_obs = obs_sample,   variables = variables,   variable_labels = variable_labels,   n_realizations = realization_num,   wet_quantile = 0.3,   extreme_quantile = 0.8,   output_path = NULL,   save_plots = FALSE ) # Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\" attr(,\"fit_summary\") # A tibble: 3 × 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 2         1         0.282            2.63          17.0              19.2 2 3         2         0.541            2.65          17.0              19.2 3 1         3         0.706            2.65          17.0              19.2 # ℹ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$n_realizations [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment_date [1] \"2026-01-16\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"purpose-of-evaluation","dir":"Articles","previous_headings":"","what":"Purpose of Evaluation","title":"Getting Started with weathergenr","text":"Validating weather generator’s performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"preparing-data-for-evaluation","dir":"Articles","previous_headings":"","what":"Preparing Data for Evaluation","title":"Getting Started with weathergenr","text":"evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) })"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"running-the-evaluation","dir":"Articles","previous_headings":"","what":"Running the Evaluation","title":"Getting Started with weathergenr","text":"","code":"# Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily_sim = rlz_sample,   daily_obs = obs_sample,   variables = variables,   variable_labels = variable_labels,   n_realizations = realization_num,   wet_quantile = 0.3,   extreme_quantile = 0.8,   output_path = NULL,   save_plots = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-evaluation-metrics","dir":"Articles","previous_headings":"","what":"Understanding Evaluation Metrics","title":"Getting Started with weathergenr","text":"evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"daily-statistics","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"1. Daily Statistics","title":"Getting Started with weathergenr","text":"Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"wet-and-dry-day-frequencies","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"2. Wet and Dry Day Frequencies","title":"Getting Started with weathergenr","text":"precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spell-length-distributions","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"3. Spell Length Distributions","title":"Getting Started with weathergenr","text":"Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spatial-correlations","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"4. Spatial Correlations","title":"Getting Started with weathergenr","text":"Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"viewing-evaluation-results","dir":"Articles","previous_headings":"","what":"Viewing Evaluation Results","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":"# Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\" attr(,\"fit_summary\") # A tibble: 3 × 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 2         1         0.282            2.63          17.0              19.2 2 3         2         0.541            2.65          17.0              19.2 3 1         3         0.706            2.65          17.0              19.2 # ℹ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$n_realizations [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment_date [1] \"2026-01-16\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"interpreting-the-plots","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"Interpreting the Plots","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"other-features","dir":"Articles","previous_headings":"","what":"Other Features","title":"Getting Started with weathergenr","text":"weathergenr package supports additional capabilities covered basic tutorial: Use apply_climate_perturbations() modify synthetic weather based climate change scenarios: Explore low-frequency climate variability using wavelet transforms: large spatial domains, enable parallel processing accelerate computation: Results can written back NetCDF format use tools:","code":"# Example: Apply temperature increase and precipitation changes grid_with_lat <- ncdata$grid grid_with_lat$lat <- grid_with_lat$y  perturbed_weather <- apply_climate_perturbations(   data = lapply(synthetic_data[[1]], function(df) {     dplyr::rename(df, prcp = precip)   }),   grid = grid_with_lat,   date = stochastic_weather$dates,   prcp_mean_factor = rep(1.1, 12),   prcp_var_factor = rep(1.0, 12),   temp_delta = rep(2.0, 12),   temp_transient = FALSE,   prcp_transient = FALSE,   compute_pet = FALSE ) # Analyze spectral characteristics of annual precipitation wavelet_results <- analyze_wavelet_spectrum(   series = annual_precip,   signif = 0.90,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = \"fast\" ) # Generate weather using multiple cores stochastic_weather <- generate_weather(   # ... other parameters ...   parallel = TRUE,   n_cores = 4 ) # Example: Write synthetic weather to NetCDF data_to_write <- lapply(synthetic_data[[1]], function(df) {   as.list(df[variables]) })  write_netcdf(   data = data_to_write,   grid = ncdata$grid,   out_dir = output_path,   origin_date = stochastic_weather$dates[1],   calendar = \"noleap\",   template_path = ncfile,   file_prefix = \"synthetic_weather\",   file_suffix = \"rlz1\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"climate-scenario-analysis","dir":"Articles","previous_headings":"","what":"Climate Scenario Analysis","title":"Getting Started with weathergenr","text":"Use apply_climate_perturbations() modify synthetic weather based climate change scenarios:","code":"# Example: Apply temperature increase and precipitation changes grid_with_lat <- ncdata$grid grid_with_lat$lat <- grid_with_lat$y  perturbed_weather <- apply_climate_perturbations(   data = lapply(synthetic_data[[1]], function(df) {     dplyr::rename(df, prcp = precip)   }),   grid = grid_with_lat,   date = stochastic_weather$dates,   prcp_mean_factor = rep(1.1, 12),   prcp_var_factor = rep(1.0, 12),   temp_delta = rep(2.0, 12),   temp_transient = FALSE,   prcp_transient = FALSE,   compute_pet = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"wavelet-spectral-analysis","dir":"Articles","previous_headings":"","what":"Wavelet Spectral Analysis","title":"Getting Started with weathergenr","text":"Explore low-frequency climate variability using wavelet transforms:","code":"# Analyze spectral characteristics of annual precipitation wavelet_results <- analyze_wavelet_spectrum(   series = annual_precip,   signif = 0.90,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = \"fast\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"parallel-computing","dir":"Articles","previous_headings":"","what":"Parallel Computing","title":"Getting Started with weathergenr","text":"large spatial domains, enable parallel processing accelerate computation:","code":"# Generate weather using multiple cores stochastic_weather <- generate_weather(   # ... other parameters ...   parallel = TRUE,   n_cores = 4 )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"saving-and-exporting-results","dir":"Articles","previous_headings":"","what":"Saving and Exporting Results","title":"Getting Started with weathergenr","text":"Results can written back NetCDF format use tools:","code":"# Example: Write synthetic weather to NetCDF data_to_write <- lapply(synthetic_data[[1]], function(df) {   as.list(df[variables]) })  write_netcdf(   data = data_to_write,   grid = ncdata$grid,   out_dir = output_path,   origin_date = stochastic_weather$dates[1],   calendar = \"noleap\",   template_path = ncfile,   file_prefix = \"synthetic_weather\",   file_suffix = \"rlz1\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with weathergenr","text":"Methodological details: See Steinschneider Brown (2013) theoretical foundation Package documentation: Use ?function_name access detailed help function Session Information","code":"R version 4.5.2 (2025-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 Running under: Windows 11 x64 (build 26200)  Matrix products: default   LAPACK version 3.12.1  locale: [1] LC_COLLATE=English_United States.utf8 [2] LC_CTYPE=English_United States.utf8 [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C [5] LC_TIME=English_United States.utf8  time zone: Europe/Amsterdam tzcode source: internal  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base  other attached packages: [1] ggplot2_4.0.1     dplyr_1.1.4       weathergenr_0.9.0  loaded via a namespace (and not attached):  [1] gtable_0.3.6       xfun_0.55          lattice_0.22-7     quadprog_1.5-8  [5] vctrs_0.6.5        tools_4.5.2        generics_0.1.4     curl_7.0.0  [9] parallel_4.5.2     tibble_3.3.1       proxy_0.4-29       xts_0.14.1 [13] pkgconfig_2.0.3    Matrix_1.7-4       RColorBrewer_1.1-3 S7_0.2.1 [17] lifecycle_1.0.5    compiler_4.5.2     farver_2.1.2       textshaping_1.0.4 [21] codetools_0.2-20   ncdf4_1.24         htmltools_0.5.9    class_7.3-23 [25] yaml_2.3.12        pillar_1.11.1      tidyr_1.3.2        MASS_7.3-65 [29] fitdistrplus_1.2-4 iterators_1.0.14   foreach_1.5.2      nlme_3.1-168 [33] fracdiff_1.5-3     tidyselect_1.2.1   digest_0.6.39      purrr_1.2.1 [37] labeling_0.4.3     tseries_0.10-59    splines_4.5.2      fastmap_1.2.0 [41] grid_4.5.2         colorspace_2.1-2   cli_3.6.5          logger_0.4.1 [45] magrittr_2.0.4     patchwork_1.3.2    utf8_1.2.6         survival_3.8-6 [49] e1071_1.7-17       withr_3.0.2        scales_1.4.0       forecast_9.0.0 [53] TTR_0.24.4         rmarkdown_2.30     quantmod_0.4.28    otel_0.2.0 [57] nnet_7.3-20        timeDate_4051.111  gridExtra_2.3      ragg_1.5.0 [61] zoo_1.8-15         urca_1.3-4         evaluate_1.0.5     knitr_1.51 [65] lmtest_0.9-40      viridisLite_0.4.2  rlang_1.1.7        Rcpp_1.1.1 [69] isoband_0.3.0      glue_1.8.0         rstudioapi_0.18.0  jsonlite_2.0.0 [73] R6_2.6.1           systemfonts_1.3.1"},{"path":"https://deltares-research.github.io/weathergenr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"M.Umit Taner. Maintainer.","code":""},{"path":"https://deltares-research.github.io/weathergenr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Taner MU (2026). weathergenr: Gridded semi-parametric weather generator. R package version 0.9.0, https://deltares-research.github.io/weathergenr.","code":"@Manual{,   title = {weathergenr: Gridded semi-parametric weather generator},   author = {Mehmet Umit Taner},   year = {2026},   note = {R package version 0.9.0},   url = {https://deltares-research.github.io/weathergenr}, }"},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Gridded semi-parametric weather generator","text":"weathergenr R package implements semiparametric, multivariate, multisite stochastic weather generator designed climate risk stress-testing applications. approach conceptually based framework Steinschneider & Brown (2013) adapted gridded datasets modern NetCDF-based workflows. package intended workflows : climate risk stress testing hydrological water-resources modelling scenario analysis climate adaptation studies","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"methodological-framework","dir":"","previous_headings":"","what":"Methodological framework","title":"Gridded semi-parametric weather generator","text":"generator explicitly represents climate variability across multiple temporal scales couples long-term variability realistic daily weather sequences.procedure consists three main components: Modeling Low-frequency variability: Interannual decadal climate variability simulated using wavelet autoregressive modeling (WARM) applied annual climate aggregates (typically precipitation). Wavelet decomposition isolates low-frequency components observed signal, stochastically simulated using autoregressive processes recombined generate synthetic annual sequences preserve observed persistence spectral structure. annual simulations condition daily generator, ensuring low-frequency variability coherently embedded daily weather realizations. Daily weather generation (Markov chain + KNN): Daily precipitation occurrence simulated using multi-state Markov chain reproduce wet dry spell persistence, daily values precipitation temperature generated using k-nearest-neighbour (KNN) resampling. KNN approach preserves cross-variable dependence, seasonality, spatial correlations across grid cells. Historical years selected conditionally based similarity simulated annual climate state, linking daily variability interannual conditions without imposing restrictive parametric assumptions. Climate perturbations quantile mapping: Simulated weather series can modified using quantile-based perturbation methods (e.g. quantile mapping) impose controlled changes temperature precipitation distributions. perturbations allow systematic exploration climate stressors-shifts means, variability, extremes-retaining internally consistent temporal spatial structure generated stochastic model.","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"intended-use","dir":"","previous_headings":"","what":"Intended use","title":"Gridded semi-parametric weather generator","text":"resulting framework intended bottom-climate vulnerability assessments explore system response wide range plausible climate conditions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"Gridded semi-parametric weather generator","text":"support gridded NetCDF inputs outputs multivariate multisite weather generation explicit representation low-frequency climate variability efficient filtering selection stochastic realizations designed reproducible, scenario-based workflows","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Gridded semi-parametric weather generator","text":"install development version GitHub:","code":"# install.packages(\"devtools\") # devtools::install_github(\"Deltares-research/weathergenr\")"},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting started","title":"Gridded semi-parametric weather generator","text":"worked end--end tutorial available : 📘 Getting Startedhttps://deltares-research.github.io/weathergenr/articles/getting_started.html Additional vignettes advanced examples added package evolves.","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"Gridded semi-parametric weather generator","text":"Steinschneider, S., & Brown, C. (2013). semiparametric multivariate, multisite weather generator low-frequency variability use climate risk assessments. Water Resources Research, 49(11), 7205–7220. (https://doi.org/10.1002/wrcr.20528)","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Gridded semi-parametric weather generator","text":"Licensed MIT License. See LICENSE details.","code":""},{"path":"https://deltares-research.github.io/weathergenr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Deltares Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"Performs continuous wavelet transform (CWT) analysis using Morlet mother wavelet (Torrence & Compo, 1998) returns wavelet power, cone influence (COI), global wavelet spectrum (GWS), significance thresholds. implementation includes: COI-aware global spectrum estimation, effective sample size (neff) based significance testing, AR(1) red-noise background estimation (Yule-Walker), optional scale-component reconstruction mode = \"complete\". function intended detection diagnostic analysis dominant time scales. Reconstructed scale components additive orthogonal.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"","code":"analyze_wavelet_spectrum(   series,   signif = 0.9,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = c(\"fast\", \"complete\"),   diagnostics = FALSE,   lag1_ci = FALSE,   lag1_ci_level = 0.95,   lag1_boot_n = 500,   seed = NULL,   warn_neff = FALSE,   neff_warn_min = 5,   neff_warn_frac = 0.6 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"series Numeric vector. Input time series (regularly spaced, missing values). Minimum length 16 observations. signif Numeric scalar (0, 1). Significance level wavelet power GWS tests. Default 0.90. noise Character. Background noise model significance testing. One \"white\" \"red\" (default). red noise, AR(1) model estimated. min_period Numeric scalar. Minimum Fourier period (time units) used identifying significant scales (default: 2). detrend Logical. TRUE, removes linear-trend slope (mean preserved) prior analysis (default: FALSE). mode Character. \"fast\" (default) returns essential outputs ; \"complete\" additionally returns pointwise significance (optionally) reconstruction products. diagnostics Logical. TRUE, returns additional diagnostics list. mode = \"complete\", diagnostics also include reconstruction error metrics reconstructed components computed. lag1_ci Logical. TRUE, computes bootstrap confidence interval AR(1) coefficient (diagnostic ; affect inference). lag1_ci_level Numeric scalar (0, 1). Confidence level AR(1) bootstrap interval. lag1_boot_n Integer. Number bootstrap replicates AR(1) interval (>= 50). seed Optional numeric scalar. Random seed used bootstrap diagnostics. warn_neff Logical. TRUE, warns effective sample size small scales. neff_warn_min Numeric scalar. Threshold neff considered small. neff_warn_frac Numeric scalar (0, 1). Fraction scales neff < neff_warn_min required trigger warning.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"list. Always includes (minimum): gws Numeric vector. COI-masked global wavelet spectrum. gws_unmasked Numeric vector. Unmasked global wavelet spectrum (plotting ). period Numeric vector. Fourier periods corresponding wavelet scales. gws_signif Numeric vector. COI- neff-corrected GWS significance threshold (inference). gws_signif_unmasked Numeric vector. Unmasked GWS significance threshold (plotting ). has_significance Logical. Whether significant scales detected. signif_periods Integer vector. Indices significant scales retained (one per contiguous band). coi Numeric vector. Cone influence time units. power Numeric matrix. Wavelet power spectrum (scales x time). mode = \"complete\", additional fields may include: power_coi Numeric matrix. COI-masked wavelet power. sigm Numeric matrix. Pointwise significance ratio. sigm_coi Numeric matrix. COI-masked pointwise significance ratio. power_signif_coi Logical matrix. COI-masked pointwise significance mask. wave Complex matrix. Wavelet coefficients (scales x time). comps Numeric matrix. Reconstructed significant-scale components plus residual (computed). comps_names Character vector. Component names. gws_n_coi Numeric vector. Number time points inside COI per scale. neff Numeric vector. Effective sample size per scale (masked). neff_unmasked Numeric vector. Effective sample size per scale (unmasked). diagnostics List. Returned diagnostics = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"Torrence, C., & Compo, G. P. (1998). practical guide wavelet analysis. Bulletin American Meteorological Society, 79(1), 61-78.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply monthly climate perturbations to gridded daily weather series — apply_climate_perturbations","title":"Apply monthly climate perturbations to gridded daily weather series — apply_climate_perturbations","text":"Applies **monthly** climate perturbations **daily** gridded weather series: **Precipitation** perturbed using quantile mapping monthly   mean variance factors via perturb_prcp_qm(). **Temperature** (temp, temp_min, temp_max) perturbed   using monthly additive deltas (step transient). **Potential evapotranspiration (PET)** can recomputed perturbed   temperatures using calculate_monthly_pet(). Perturbations can applied **step change** (constant time) **transient change** (linearly ramping years) preserving *mean* change simulation period.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply monthly climate perturbations to gridded daily weather series — apply_climate_perturbations","text":"","code":"apply_climate_perturbations(   data = NULL,   grid = NULL,   date = NULL,   prcp_mean_factor = NULL,   prcp_var_factor = NULL,   temp_delta = NULL,   temp_transient = TRUE,   prcp_transient = TRUE,   compute_pet = TRUE,   pet_method = \"hargreaves\",   qm_fit_method = \"mme\",   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply monthly climate perturbations to gridded daily weather series — apply_climate_perturbations","text":"data List data.frames, one per grid cell. data.frame must contain: prcp (daily precipitation) temp (daily mean temperature) temp_min (daily minimum temperature) temp_max (daily maximum temperature) compute_pet = TRUE, pet added overwritten. grid data.frame grid metadata nrow(grid) == length(data). Must include column lat (latitude decimal degrees). date Date vector length nrow(data[[]]) (identical across cells). prcp_mean_factor Numeric vector length 12. Monthly multiplicative factors precipitation mean. prcp_var_factor Numeric vector length 12. Monthly multiplicative factors precipitation variance. temp_delta Numeric vector length 12. Monthly additive temperature deltas (degC) applied temp, temp_min, temp_max. temp_transient Logical. TRUE, temperature deltas ramp linearly 0 2 * temp_delta years (mean equals temp_delta). prcp_transient Logical. TRUE, precipitation factors ramp linearly 1 (factor - 1) * 2 + 1 years. compute_pet Logical. TRUE, recompute PET using calculate_monthly_pet. pet_method Character. PET method passed calculate_monthly_pet (default: \"hargreaves\"). qm_fit_method Character. Distribution-fitting method perturb_prcp_qm(). verbose Logical. Emit progress logs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply monthly climate perturbations to gridded daily weather series — apply_climate_perturbations","text":"List data.frames perturbed variables.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply quantile mapping transformation — apply_quantile_mapping","title":"Apply quantile mapping transformation — apply_quantile_mapping","text":"Apply quantile mapping transformation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply quantile mapping transformation — apply_quantile_mapping","text":"","code":"apply_quantile_mapping(prcp, mon, year, base_gamma, target_gamma)"},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign qualitative assessments for moment preservation — assess_moment_changes","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"Classifies moment changes based absolute percent change thresholds differ metric.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"","code":"assess_moment_changes(moments_df)"},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"moments_df Data.frame. Output compute_moment_diagnostics containing least metric pct_change.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"Character vector length nrow(moments_df) assessment labels.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"function applies metric-specific thresholds: mean/variance: excellent < 5, good < 15, else poor cv: excellent < 10, good < 20, else poor others (sd, skewness, kurtosis): good < 15, acceptable < 30, else poor","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"Calculates monthly potential evapotranspiration (PET) using selected method. Currently supports Hargreaves temperature-based method.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"","code":"calculate_monthly_pet(month, temp, temp_range, lat_deg, method = \"hargreaves\")"},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"month Integer vector (1-12). Calendar month PET estimate. temp Numeric vector. Mean monthly air temperature (degC). temp_range Numeric vector. Monthly diurnal temperature range (Tmax - Tmin, degC). Must non-negative. lat_deg Numeric scalar. Latitude decimal degrees (positive north). method Character scalar. PET method. Currently \"hargreaves\".","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"Numeric vector monthly PET values mm/day (length length(month)).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_dryday_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute dry-day and wet-day frequency diagnostics — compute_dryday_diagnostics","title":"Compute dry-day and wet-day frequency diagnostics — compute_dryday_diagnostics","text":"Compute dry-day wet-day frequency diagnostics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_dryday_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute dry-day and wet-day frequency diagnostics — compute_dryday_diagnostics","text":"","code":"compute_dryday_diagnostics(prcp_ref, prcp_adj, wet_thresh)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_extreme_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute extreme-value diagnostics for quantile-mapped precipitation — compute_extreme_diagnostics","title":"Compute extreme-value diagnostics for quantile-mapped precipitation — compute_extreme_diagnostics","text":"Compute extreme-value diagnostics quantile-mapped precipitation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_extreme_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute extreme-value diagnostics for quantile-mapped precipitation — compute_extreme_diagnostics","text":"","code":"compute_extreme_diagnostics(prcp_ref, prcp_adj)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sample excess kurtosis — compute_kurtosis","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Computes (non-bias-corrected) fourth standardized central moment minus 3 (excess kurtosis) numeric vector, excluding NA values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sample excess kurtosis — compute_kurtosis","text":"","code":"compute_kurtosis(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sample excess kurtosis — compute_kurtosis","text":"x Numeric vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Numeric scalar. Excess kurtosis estimate, NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Returns NA fewer 4 non-missing values available standard deviation zero.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_moment_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute moment diagnostics for quantile-mapped precipitation — compute_moment_diagnostics","title":"Compute moment diagnostics for quantile-mapped precipitation — compute_moment_diagnostics","text":"Compute moment diagnostics quantile-mapped precipitation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_moment_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute moment diagnostics for quantile-mapped precipitation — compute_moment_diagnostics","text":"","code":"compute_moment_diagnostics(prcp_ref, prcp_adj, mask)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_monthly_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute month-by-month diagnostics for quantile-mapped precipitation — compute_monthly_diagnostics","title":"Compute month-by-month diagnostics for quantile-mapped precipitation — compute_monthly_diagnostics","text":"Compute month--month diagnostics quantile-mapped precipitation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_monthly_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute month-by-month diagnostics for quantile-mapped precipitation — compute_monthly_diagnostics","text":"","code":"compute_monthly_diagnostics(   prcp_ref,   prcp_adj,   month,   mean_factor = NULL,   var_factor = NULL,   year = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_quantile_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute quantile diagnostics for quantile-mapped precipitation — compute_quantile_diagnostics","title":"Compute quantile diagnostics for quantile-mapped precipitation — compute_quantile_diagnostics","text":"Compute quantile diagnostics quantile-mapped precipitation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_quantile_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute quantile diagnostics for quantile-mapped precipitation — compute_quantile_diagnostics","text":"","code":"compute_quantile_diagnostics(prcp_ref, prcp_adj, probs)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sample skewness — compute_skewness","title":"Compute sample skewness — compute_skewness","text":"Computes (non-bias-corrected) third standardized central moment (skewness) numeric vector, excluding NA values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sample skewness — compute_skewness","text":"","code":"compute_skewness(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sample skewness — compute_skewness","text":"x Numeric vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sample skewness — compute_skewness","text":"Numeric scalar. Skewness estimate, NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute sample skewness — compute_skewness","text":"Returns NA fewer 3 non-missing values available standard deviation zero (yields undefined standardization).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute wet and dry spell-length diagnostics — compute_spell_diagnostics","title":"Compute wet and dry spell-length diagnostics — compute_spell_diagnostics","text":"Compute wet dry spell-length diagnostics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute wet and dry spell-length diagnostics — compute_spell_diagnostics","text":"","code":"compute_spell_diagnostics(prcp_ref, prcp_adj, wet_thresh)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Computes consecutive run lengths dry wet states relative threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"","code":"compute_spell_lengths(x, threshold, below = TRUE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"x Numeric vector. Precipitation values. threshold Numeric scalar. Wet-day threshold. Logical. TRUE, defines spells x < threshold (dry spells). FALSE, defines spells x >= threshold (wet spells).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Numeric vector positive integers giving spell lengths. May length zero.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Uses rle() logical state series identify consecutive runs. spells requested type occur, function returns numeric(0).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_summary_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute overall summary metrics for quantile-mapping diagnostics — compute_summary_metrics","title":"Compute overall summary metrics for quantile-mapping diagnostics — compute_summary_metrics","text":"Compute overall summary metrics quantile-mapping diagnostics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_summary_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute overall summary metrics for quantile-mapping diagnostics — compute_summary_metrics","text":"","code":"compute_summary_metrics(   moments,   quant_metrics,   extreme_metrics,   spell_metrics,   dryday_metrics )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"Computes tail-mass metrics based lower upper tail quantile thresholds. Uses robust scale estimation (IQR -> MAD -> SD fallback) normalizes tail deficit/excess masses series length scale.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"","code":"compute_tailmass_metrics(   obs_use,   sim_series_stats,   tail_low_p,   tail_high_p,   tail_eps )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"obs_use Numeric vector observed values. sim_series_stats Numeric matrix simulated values (n_use x n_realizations). tail_low_p Lower tail quantile probability (e.g., 0.10). tail_high_p Upper tail quantile probability (e.g., 0.90). tail_eps Epsilon log transform avoid log(0).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"List tail thresholds, scale, masses, log-distance metrics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute target distribution parameters from base params and change factors — compute_target_parameters","title":"Compute target distribution parameters from base params and change factors — compute_target_parameters","text":"Compute target distribution parameters base params change factors","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute target distribution parameters from base params and change factors — compute_target_parameters","text":"","code":"compute_target_parameters(   base_gamma,   mean_factor,   var_factor,   months_ok,   n_years )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_temporal_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute temporal diagnostics for quantile-mapped precipitation — compute_temporal_diagnostics","title":"Compute temporal diagnostics for quantile-mapped precipitation — compute_temporal_diagnostics","text":"Compute temporal diagnostics quantile-mapped precipitation","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_temporal_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute temporal diagnostics for quantile-mapped precipitation — compute_temporal_diagnostics","text":"","code":"compute_temporal_diagnostics(prcp_ref, prcp_adj, month, year, mask)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate water year from a date vector — compute_water_year","title":"Calculate water year from a date vector — compute_water_year","text":"Assigns water year date based custom starting month. water year groups months across calendar years (e.g., Oct-Sep).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate water year from a date vector — compute_water_year","text":"","code":"compute_water_year(date, water_year_start_month = 1)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate water year from a date vector — compute_water_year","text":"date vector Date objects. water_year_start_month Integer (1-12) indicating first month water year. example, 10 October 6 June. Default 1 (calendar year).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate water year from a date vector — compute_water_year","text":"integer vector length date, giving water year date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate water year from a date vector — compute_water_year","text":"","code":"dates <- as.Date(c(\"2022-09-30\", \"2022-10-01\", \"2023-06-15\")) compute_water_year(dates, water_year_start_month = 10) #> [1] 2022 2023 2023"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"performs wavelet analysis observed series simulated realizations. Identifies significant periods, computes regional power contrast metrics, caches masked (filtering) unmasked (plotting) GWS.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"","code":"compute_wavelet_metrics(   obs_use,   sim_series_stats,   wavelet_pars,   padding,   min_bg )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"obs_use Numeric vector observed values. sim_series_stats Numeric matrix simulated values. wavelet_pars List wavelet parameters (signif_level, noise_type, etc.). padding Logical period padding. min_bg Minimum background power threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"List wavelet filter diagnostics cached spectra.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Create all diagnostic plots — create_all_diagnostic_plots","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"Runs full set diagnostic plotting routines returns named list ggplot objects. Optionally saves plots disk (delegated individual plot exporters).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"","code":"create_all_diagnostic_plots(   plot_data,   plot_config,   variables,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"plot_data List precomputed diagnostic datasets produced evaluation pipeline. plot_config List plotting configuration options (theme, alpha, colors, subtitle). variables Character vector variable names loop monthly pattern plots. show_title Logical; TRUE, titles/subtitles added plots supported. save_plots Logical; TRUE, plots written output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"Named list ggplot objects diagnostics created.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"helper expects precomputed plot data returned evaluation pipeline. validate plot input structure beyond basic use downstream plotting.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"","code":"if (FALSE) { # \\dontrun{   plot_data <- list()   plot_config <- list(     subtitle = \"Example\",     alpha = 0.4,     colors = c(Observed = \"blue3\", Simulated = \"gray40\"),     theme = ggplot2::theme_bw()   )   plots <- create_all_diagnostic_plots(     plot_data = plot_data,     plot_config = plot_config,     variables = c(\"precip\", \"temp\"),     show_title = FALSE,     save_plots = FALSE,     output_path = NULL   ) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/criteria_string_compact.html","id":null,"dir":"Reference","previous_headings":"","what":"Compact criteria string for a filter — criteria_string_compact","title":"Compact criteria string for a filter — criteria_string_compact","text":"Compact criteria string filter","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/criteria_string_compact.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compact criteria string for a filter — criteria_string_compact","text":"","code":"criteria_string_compact(   filter_name,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars )"},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_prcp_qm.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_prcp_qm","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_prcp_qm","text":"Calculates validation-style diagnostics comparing reference quantile-mapped precipitation series. Evaluates moment changes, quantile preservation, tail behavior, dry/wet-day frequencies, spell lengths, optional temporal/monthly patterns.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_prcp_qm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_prcp_qm","text":"","code":"diagnose_prcp_qm(   prcp_ref,   prcp_adj,   month = NULL,   year = NULL,   mean_factor = NULL,   var_factor = NULL,   wet_thresh = 0.1,   probs = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_prcp_qm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_prcp_qm","text":"prcp_ref Numeric vector. Reference (original) precipitation values. prcp_adj Numeric vector. Adjusted precipitation values (length prcp_ref). month Integer vector (optional). Month index (1–12) observation. year Integer vector (optional). Year index (1..n_years) observation. mean_factor Numeric matrix (optional). Target mean scaling factors (n_years x 12). var_factor Numeric matrix (optional). Target variance scaling factors (n_years x 12). wet_thresh Numeric. Threshold defining wet days (default = 0.1 mm). probs Numeric vector. Quantile probabilities evaluate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_prcp_qm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_prcp_qm","text":"list class \"prcp_qm_diagnostics\" containing: moments: Data frame moment statistics quantiles: Data frame quantile comparisons extremes: Data frame extreme value metrics temporal: Data frame temporal pattern metrics (optional) monthly: Data frame monthly diagnostics (optional) spells: Data frame spell length statistics drydays: Data frame dry/wet-day frequency diagnostics summary: Overall assessment metrics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"Applies chosen window consistently across grids realizations removing leap days. window drawn longest contiguous full-year blocks available series.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"","code":".align_obs_sim_periods(daily_obs, daily_sim, n_realizations, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"daily_obs List observed data frames (one per grid). daily_sim List simulated realizations; realization list grids. n_realizations Integer number realizations. variables Character vector variables used evaluation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"List standardized `daily_obs`, `daily_sim`, window metadata.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Build data for plotting — .build_plot_data","title":"Build data for plotting — .build_plot_data","text":"Build data plotting","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build data for plotting — .build_plot_data","text":"","code":".build_plot_data(obs_results, sim_results, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build data for plotting — .build_plot_data","text":"obs_results Output `.summarize_observed_data()`. sim_results Output `.summarize_simulated_data()`. variables Character vector variable names.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build data for plotting — .build_plot_data","text":"List standardized data frames diagnostic plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"Compute correlation matrix monthly anomalies","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"","code":".compute_anomaly_correlations(data, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"data Data frame `date`, `id`, variables. variables Character vector variable names correlate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"Long-format data frame upper-triangle pairwise correlations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"Conditional precip-X correlations within grid","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"","code":".compute_conditional_precip_correlations(   data,   variables,   mc_thresholds = NULL,   wet_def = c(\"gt0\", \"monthly_quantile\"),   use_anom = TRUE,   use_log_precip_on_wet = TRUE,   method = \"pearson\",   min_pairs = 50 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"data Data frame daily values `date`/`id` columns. variables Character vector variable names (must include `\"precip\"`). mc_thresholds Optional wet-day thresholds (required `wet_def = \"monthly_quantile\"`). wet_def Wet-day definition: `\"gt0\"` `\"monthly_quantile\"`. use_anom Logical; subtract monthly means correlation. use_log_precip_on_wet Logical; apply `log1p` precip wet days. method Correlation method passed `stats::cor`. min_pairs Minimum number paired values required report correlation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"Data frame conditional correlations grid, regime, variable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute time series statistics — .compute_timeseries_stats","title":"Compute time series statistics — .compute_timeseries_stats","text":"Compute time series statistics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute time series statistics — .compute_timeseries_stats","text":"","code":".compute_timeseries_stats(data, variables, mc_thresholds)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute time series statistics — .compute_timeseries_stats","text":"data Data frame daily values `date` column. variables Character vector variable names summarize. mc_thresholds Data frame wet-day thresholds grid month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute time series statistics — .compute_timeseries_stats","text":"List seasonal, monthly, annual stats plus wet/dry correlation data.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"Compares annual mean precipitation time series: simulated realizations plotted multiple lines/points observed series overlaid single reference series.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"","code":".create_annual_precip_plot(   stats_annual_aavg_sim,   stats_annual_aavg_obs,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"stats_annual_aavg_sim Data frame simulated annual aggregated statistics. stats_annual_aavg_obs Data frame observed annual aggregated statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title plot. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"ggplot object returned invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"Observed-vs-simulated comparison cross-grid correlations, faceted first variable correlation pair. Uses dummy points enforce symmetric axes.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"","code":".create_crossgrid_cor_plot(   stats_crosscor,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"stats_crosscor Data frame cross-grid correlation summaries columns Observed, Simulated, variable1. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily mean diagnostic plot — .create_daily_mean_plot","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"Faceted observed-vs-simulated comparison daily mean values variable, using summary ranges medians across grid cells/months. Optionally saves plot.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"","code":".create_daily_mean_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"daily_stats_season Data frame seasonal daily statistics including columns stat, Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"Faceted observed-vs-simulated comparison daily standard deviations variable, using summary ranges medians across grid cells/months. Optionally saves plot.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"","code":".create_daily_sd_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"daily_stats_season Data frame seasonal daily statistics including columns stat, Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"Observed-vs-simulated comparison inter-variable correlations, faceted variable. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"","code":".create_intergrid_cor_plot(   stats_intercor,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"stats_intercor Data frame inter-variable correlation summaries columns Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"Plots annual cycles month variable: simulated cycles shown realizations, observed cycle shown single reference line.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"","code":".create_monthly_cycle_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"daily_stats_season Data frame daily seasonal statistics including mean values. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"Compares observed simulated monthly distributions (boxplots) given variable, faceted statistic. Simulated distributions shown across realizations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"","code":".create_monthly_pattern_plot(   stats_mon_aavg_sim,   stats_mon_aavg_obs,   variable,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"stats_mon_aavg_sim Data frame simulated monthly aggregated statistics. stats_mon_aavg_obs Data frame observed monthly aggregated statistics. variable Character; variable name plot (must exist inputs). plot_config List plotting configuration options (theme, alpha, colors, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"Observed-vs-simulated within-grid correlations precipitation variables, stratified precipitation regime (e.g., /wet/dry). Faceted regime (rows) variable pair (columns).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"","code":".create_precip_cond_cor_plot(   stats_precip_cor_cond,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"stats_precip_cor_cond Data frame conditional correlation summaries columns variable1, variable2, id1, id2, regime, Observed, Simulated. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"Observed-vs-simulated comparison average wet dry spell lengths, faceted spell type/statistic. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"","code":".create_spell_length_plot(   stats_wetdry,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"stats_wetdry Data frame wet/dry diagnostics including spell statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"Observed-vs-simulated comparison average monthly wet dry day counts, faceted statistic. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"","code":".create_wetdry_days_plot(   stats_wetdry,   plot_config,   show_title,   save_plots,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"stats_wetdry Data frame wet/dry diagnostics including day-count statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_path. output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"Adds title/subtitle (optional) saves plot disk (optional), using facet layout infer width/height. Returns plot invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"","code":".export_multipanel_plot(   p,   filename,   show_title,   save_plots,   title = NULL,   subtitle = NULL,   output_path )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"p ggplot object, typically faceted via facet_wrap() facet_grid(). filename Character; output filename (e.g., \"daily_mean.png\"). show_title Logical; TRUE, adds title/subtitle via labs(). save_plots Logical; TRUE, writes plot output_path. title Character; plot title (used show_title = TRUE). subtitle Character; plot subtitle (used show_title = TRUE). output_path Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"ggplot object p, returned invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"Filter correlations type (cross-grid inter-variable)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"","code":".filter_correlation_pairs(   cor_data,   same_var,   same_id,   allowed_pairs,   pair_type )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"cor_data Data frame correlations. same_var Logical; require -variable pairs. same_id Logical; require -grid pairs. allowed_pairs Character vector allowed pair keys. pair_type `\"id\"` grid pairs `\"variable\"` variable pairs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"Filtered data frame correlations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"Filter single grid data frame selected years (keeps original columns)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"","code":".filter_grid_years(df, years_keep)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"df Data frame `date` column. years_keep Integer vector years retain.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"Filtered data frame columns `df`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"Find full (365-day) years leap-day removal return longest contiguous block","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"","code":".get_full_year_run(dates)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"dates Date vector (leap days already removed).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"List `years` integer vector. Empty full-year blocks exist.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"Checks whether object numeric scalar representing finite integer value. helper intended lightweight input validation strict integer typing required integer-valued numerics acceptable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"","code":".is_int_scalar(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"x Object test.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"Logical scalar indicating whether x finite integer-valued scalar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"function returns TRUE : x numeric, x length 1, x finite (NA, NaN, Inf), x fractional component (x %% 1 == 0). Logical, character, integer vectors length greater one return FALSE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":null,"dir":"Reference","previous_headings":"","what":"Package-wide internal logger — .log","title":"Package-wide internal logger — .log","text":"Unified internal logging helper package. Features: - Single entry point logging - Glue interpolation resolved caller environment - Safe logger::formatter_glue (raw `` passed downstream) - Supports log levels (info, warn, error) - Silent unless verbose = TRUE - Falls back message()/warning()/stop() logger unavailable","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Package-wide internal logger — .log","text":"","code":".log(msg, ..., level = c(\"info\", \"warn\", \"error\"), verbose = TRUE, tag = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Package-wide internal logger — .log","text":"msg Character scalar. Log message template. ... Values interpolated `msg` via glue. level Character scalar. One \"info\", \"warn\", \"error\". verbose Logical. FALSE, suppress output. tag Optional character scalar. Component tag (e.g. \"WARM\", \"KNN\").","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Package-wide internal logger — .log","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pet_monthly_hargreaves.html","id":null,"dir":"Reference","previous_headings":"","what":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","title":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","text":"Monthly PET via Hargreaves (FAO-56)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pet_monthly_hargreaves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","text":"","code":".pet_monthly_hargreaves(month, temp, temp_range, lat_deg)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"Pick random contiguous window years length `window_years` year vector","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"","code":".pick_contiguous_year_window(years, window_years)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"years Integer vector available years. window_years Integer number contiguous years sample.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"Integer vector selected years chronological order.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Display fit summary table for all realizations — .print_fit_summary_table","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"Formats prints compact summary fit metrics across realizations. primarily intended interactive review model performance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"","code":".print_fit_summary_table(fit_summary)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"fit_summary Data frame returned `.summarize_realization_fit()`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"Invisibly returns `fit_summary`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"Computes correlation coefficient two numeric vectors using finite paired observations. number valid pairs required minimum, correlation computed.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"","code":".safe_cor(x, y, min_pairs = 3L, method = \"pearson\")"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"x, y Numeric vectors equal length. pairs values finite used. min_pairs Integer >= 1. Minimum number paired observations required compute correlation. method Character. Correlation method passed stats::cor(). One \"pearson\", \"spearman\", \"kendall\".","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"Named numeric vector elements: value: correlation coefficient, NA_real_, n: number finite paired observations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize grouped statistics — .summarize_grouped_stats","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"Summarize grouped statistics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"","code":".summarize_grouped_stats(df, variables, group_vars, stat_fns)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"df Data frame summarize. variables Character vector variables summarize. group_vars Character vector grouping columns. stat_fns Named list summary functions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"Long-format data frame `variable`, `stat`, `value`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_observed_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize observed weather data — .summarize_observed_data","title":"Summarize observed weather data — .summarize_observed_data","text":"Summarize observed weather data","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_observed_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize observed weather data — .summarize_observed_data","text":"","code":".summarize_observed_data(   daily_obs,   variables,   grid_count,   wet_quantile,   extreme_quantile )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute fit metrics for each realization — .summarize_realization_fit","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"Computes Mean Absolute Error (MAE) key metrics. MAE measures average magnitude errors simulated observed values. Lower MAE indicates better fit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"","code":".summarize_realization_fit(obs_results, sim_results, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"obs_results Observed data results .summarize_observed_data sim_results Simulated data results .summarize_simulated_data variables Character vector variable names","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_simulated_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize simulated weather data — .summarize_simulated_data","title":"Summarize simulated weather data — .summarize_simulated_data","text":"Summarize simulated weather data","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_simulated_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize simulated weather data — .summarize_simulated_data","text":"","code":".summarize_simulated_data(daily_sim, n_realizations, variables, mc_thresholds)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-validate_assessment_inputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate inputs for weather assessment — .validate_assessment_inputs","title":"Validate inputs for weather assessment — .validate_assessment_inputs","text":"Validate inputs weather assessment","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-validate_assessment_inputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate inputs for weather assessment — .validate_assessment_inputs","text":"","code":".validate_assessment_inputs(   daily_sim,   daily_obs,   variables,   n_realizations,   wet_quantile,   extreme_quantile,   verbose )"},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"Estimates month-specific transition probabilities three-state precipitation occurrence Markov chain (dry, wet, wet) observed daily precipitation data, maps probabilities onto simulated time axis. Transition probabilities inferred observed lag-1 lag-0 precipitation pairs using month-dependent wet extreme thresholds. Dirichlet-type smoothing applied avoid zero-probability transitions, effective smoothing strength decreasing automatically number observed transitions per month. function supports calendar-year water-year simulations. regime inferred month_order: month_order[1] == 1, calendar-year logic used; otherwise, water-year logic assumed. Optional spell-persistence modifiers applied dry wet states influence transition persistence. adjustments, transition probabilities explicitly normalized ensure stochastic validity (non-negativity rows summing one). estimated monthly transition probabilities assigned simulated days fall within target simulation year corresponding calendar month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"","code":"estimate_monthly_markov_probs(   precip_lag0,   precip_lag1,   month_lag0,   month_lag1,   year_lag0 = NULL,   year_lag1 = NULL,   wet_threshold,   extreme_threshold,   month_order,   sim_month,   sim_wyear,   year_idx,   sim_start_year,   dry_spell_factor_month,   wet_spell_factor_month,   n_days_sim,   dirichlet_alpha = 1 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"precip_lag0 Numeric vector. Observed daily precipitation lag 0 (current day) used estimate state transitions. precip_lag1 Numeric vector. Observed daily precipitation lag 1 (previous day) used estimate state transitions. month_lag0 Integer vector (1-12). Calendar month corresponding precip_lag0. month_lag1 Integer vector (1-12). Calendar month corresponding precip_lag1. year_lag0 Optional integer vector. Calendar year water year corresponding precip_lag0. provided together year_lag1, transitions restricted -year pairs. year_lag1 Optional integer vector. Calendar year water year corresponding precip_lag1. wet_threshold Numeric vector length 12. Monthly precipitation thresholds separating dry wet states, aligned month_order. extreme_threshold Numeric vector length 12. Monthly precipitation thresholds separating wet wet states, aligned month_order. month_order Integer vector length 12 defining simulated ordering months (example 1:12 calendar years c(10:12, 1:9) October-start water years). sim_month Integer vector. Calendar month simulated day. sim_wyear Integer vector. Simulation year (calendar water year, depending regime) simulated day. year_idx Integer. Index current simulated year (1-based). sim_start_year Integer. First year simulation, interpreted calendar year water year depending simulation regime. dry_spell_factor_month Numeric vector length 12. Monthly multiplicative factors controlling dry-state persistence. wet_spell_factor_month Numeric vector length 12. Monthly multiplicative factors controlling wet-state persistence. n_days_sim Integer. Total number simulated days. Determines length returned probability vectors. dirichlet_alpha Numeric. Base smoothing strength transition-probability estimation. effective smoothing applied month dirichlet_alpha / sqrt(n_transitions_m), n_transitions_m number observed transitions month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"named list nine numeric vectors, length n_days_sim, representing time-varying transition probabilities: p00_final: P(dry dry) p01_final: P(dry wet) p02_final: P(dry wet) p10_final: P(wet dry) p11_final: P(wet wet) p12_final: P(wet wet) p20_final: P(wet dry) p21_final: P(wet wet) p22_final: P(wet wet)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"Precipitation occurrence states defined : Dry Precipitation less equal monthly wet threshold Wet Precipitation greater wet threshold less              equal extreme threshold wet Precipitation greater extreme threshold transition-probability rows explicitly normalized smoothing spell adjustments ensure valid Markov-chain behavior.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"Run comprehensive diagnostic evaluation comparing synthetic weather simulations historical observations across multiple grid cells. Computes summary statistics, wet/dry day counts, spell lengths, inter-site correlations, generates diagnostic plots assess stochastic weather generator performance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"","code":"evaluate_weather_generator(   daily_sim = NULL,   daily_obs = NULL,   variables = NULL,   variable_labels = NULL,   n_realizations = NULL,   wet_quantile = 0.2,   extreme_quantile = 0.8,   output_path = NULL,   save_plots = TRUE,   show_title = TRUE,   verbose = TRUE,   max_grids = 25,   seed = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"daily_sim List simulated weather realizations. element list data frames (one per grid cell), containing daily values `date` column. daily_obs List observed weather data frames (one per grid cell). contain `date` column variables specified `variables`. variables Character vector variable names evaluate (e.g., `c(\"precip\", \"temp\")`). Must include \"precip\" wet/dry spell analysis. variable_labels Optional character vector variable labels plots. Defaults `variables` `NULL`. n_realizations Integer. Number synthetic realizations `daily_sim`. wet_quantile Numeric 0 1. Quantile threshold wet days (default = 0.2). extreme_quantile Numeric 0 1. Quantile threshold extremely wet days (default = 0.8). output_path Character. Directory path save generated plots. `NULL`, plots saved disk. save_plots Logical. Whether save plots `output_path` (default = `TRUE`). show_title Logical. Whether display titles plots (default = `TRUE`). verbose Logical. Whether emit console messages fit summary table. max_grids Integer. Maximum number grid cells evaluate (default = 25). grids provided, random subsample used control memory. seed Optional integer. Random seed reproducible grid subsampling year window selection. NULL, results vary runs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"named list `ggplot2` plot objects class \"weather_assessment\".   returned object also contains attributes: fit_summary: data frame per-realization fit metrics ranks. metadata: list n_grids, n_realizations,       variables, assessment_date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"function standardizes simulated observed series full-year windows (leap-day removal), optionally subsamples grid cells manage memory, returns diagnostic plots alongside summarized fit table. Missing values ignored summary statistics (`na.rm = TRUE`), correlations use pairwise complete observations. Use `seed` reproducible subsampling window selection; original RNG state restored exit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"","code":"set.seed(1) dates <- seq.Date(as.Date(\"2001-01-01\"), as.Date(\"2001-12-31\"), by = \"day\") dates <- dates[format(dates, \"%m-%d\") != \"02-29\"] obs_grid <- list(data.frame(   date = dates,   precip = rgamma(length(dates), shape = 2, scale = 2),   temp = rnorm(length(dates), mean = 10, sd = 3) )) sim_grid <- list(list(data.frame(   date = dates,   precip = rgamma(length(dates), shape = 2, scale = 2),   temp = rnorm(length(dates), mean = 10, sd = 3) ))) out <- evaluate_weather_generator(   daily_sim = sim_grid,   daily_obs = obs_grid,   variables = c(\"precip\", \"temp\"),   n_realizations = 1,   output_path = NULL,   save_plots = FALSE,   show_title = FALSE ) #> INFO [2026-01-16 19:02:59] [VALIDATE] Start | grids = 1 | realizations = 1 #> INFO [2026-01-16 19:02:59] [VALIDATE] Variables = precip,temp #> INFO [2026-01-16 19:02:59] [VALIDATE] Parameters: wet.q = 0.2 | extreme.q = 0.8 #> INFO [2026-01-16 19:02:59] [VALIDATE] Standardizing obs/sim periods to full years and equal length #> INFO [2026-01-16 19:02:59] [VALIDATE] Standardized period | Obs = 2001-2001 | Sim = 2001-2001 #> INFO [2026-01-16 19:02:59] [VALIDATE] Processing observed data #> INFO [2026-01-16 19:03:00] [VALIDATE] Processing simulated data (1 realizations) #> INFO [2026-01-16 19:03:00] [VALIDATE] Preparing diagnostic data for plotting #> INFO [2026-01-16 19:03:00] [VALIDATE] Generating diagnostic plots #> Warning: There were 2 warnings in `dplyr::summarise()`. #> The first warning was: #> ℹ In argument: `.min = min(c(.data[[\"Observed\"]], .data[[\"Simulated\"]]), na.rm #>   = TRUE)`. #> Caused by warning in `min()`: #> ! no non-missing arguments to min; returning Inf #> ℹ Run dplyr::last_dplyr_warnings() to see the 1 remaining warning. #> INFO [2026-01-16 19:03:00] [VALIDATE] Generated 11 diagnostic plots. #> INFO [2026-01-16 19:03:00] [VALIDATE] Computing fit metrics for all realizations #> Warning: There were 2 warnings in `dplyr::mutate()`. #> The first warning was: #> ℹ In argument: `dplyr::across(...)`. #> Caused by warning in `min()`: #> ! no non-missing arguments to min; returning Inf #> ℹ Run dplyr::last_dplyr_warnings() to see the 1 remaining warning. #> INFO [2026-01-16 19:03:00] [VALIDATE] Displaying fit assessment summary #>  #> ===============================================================================================  #>  FIT ASSESSMENT SUMMARY - ALL REALIZATIONS #> ===============================================================================================  #>  #>  Metrics shown (Mean Absolute Error, lower is better): #>   MAE measures average magnitude of errors between simulated and observed #>  #>   - Mean.precip   : MAE of monthly means #>   - SD.precip     : MAE of monthly standard deviations #>   - Days.Wet   : MAE of wet/dry day counts #>   - Spell.Wet  : MAE of wet/dry spell lengths (days) #>   - Cor.Cross   : MAE of cross-grid correlations #>   - Cor.Inter   : MAE of inter-variable correlations #>   - Score       : Normalized overall score across all metrics #>  #>    Rlz   Rank   Mean.precip   SD.precip   Days.Wet   Spell.Wet   Cor.Cross   Cor.Inter    Score  #> -----------------------------------------------------------------------------------------------  #>      1      1        1.6773      1.1552    11.5091     10.2257          NA      0.0479   0.0000  #> ===============================================================================================  #>  #>  Summary: #>   - Best realization  : 1 (score = 0.0000) #>   - Worst realization : 1 (score = 0.0000) #>   - Median score      : 0.0000 #>  #> INFO [2026-01-16 19:03:00] [VALIDATE] Assessment completed successfully class(out) #> [1] \"weather_assessment\" \"list\""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand Index Positions by Fixed Offsets — expand_indices","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"Expands vector base index positions adding set integer offsets, returning valid index positions within specified upper bound. typically used generate moving windows neighborhood indices around reference positions (e.g., expanding event days adjacent days).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"","code":"expand_indices(base_idx, offset_vec, n_max)"},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"base_idx Integer vector base index positions expanded. offset_vec Integer vector offsets apply element base_idx. Offsets may positive, negative, zero. n_max Integer. Maximum allowable index length; expanded indices constrained range 1:(n_max - 1).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"Integer vector expanded index positions satisfy validity constraints.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"element base_idx, values offset_vec added. Resulting indices less equal zero, index + 1 > n_max, discarded. function enforce uniqueness sorting output.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"","code":"base_idx <- c(5, 10) offset_vec <- -1:1 weathergenr:::expand_indices(base_idx, offset_vec, n_max = 15) #> [1]  4  5  6  9 10 11"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Global-Spectrum Significance Curve — extract_signif_curve","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"Extracts global-spectrum significance curve wavelet analysis output list. Intended small compatibility helper downstream code expects single numeric vector. found, returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"","code":"extract_signif_curve(wavelet)"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"wavelet List output analyze_wavelet_spectrum.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"Numeric vector significance values, NULL found.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":null,"dir":"Reference","previous_headings":"","what":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"Reconstructs time-domain components selected wavelet scales using Torrence & Compo (1998) inverse transform approximation. Optionally adds residual component representing non-selected scales ensure additive closure.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"","code":"extract_wavelet_components(   wave,   signif_periods,   scale,   dj = 0.25,   dt = 1,   series_sd,   series_mean = 0,   Cdelta = 0.776,   w0_0 = pi^(-1/4),   include_residual = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"wave Complex matrix (scales x time). Wavelet coefficients. signif_periods Integer vector. Scale indices reconstruct. scale Numeric vector. Scale values aligned nrow(wave). dj Numeric scalar. Scale resolution used transform. dt Numeric scalar. Time step series. series_sd Numeric scalar. Standard deviation original series (pre-standardization). series_mean Numeric scalar. Mean original series; added back residual. Cdelta Numeric scalar. Morlet reconstruction constant (default: 0.776). w0_0 Numeric scalar. \\(\\psi_0(0)\\) constant (default: \\(\\pi^{-1/4}\\)). include_residual Logical. TRUE, adds residual (non-selected) component.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"Numeric matrix one column per selected component , requested,   final \"Noise\" residual column.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"Fills missing values numeric vector propagating nearest available non-missing value. deterministic forward-fill followed backward-fill. mainly used stabilize curves interpolation (e.g., regridded spectra).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"","code":"fill_nearest(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"x Numeric vector possibly containing NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"Numeric vector missing values filled. x NA,   returned unchanged.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":null,"dir":"Reference","previous_headings":"","what":"WARM filtering default bounds — filter_warm_bounds_defaults","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"Internal defaults filter_warm_pool() bounds. Users usually override entries via filter_bounds = list(...).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"","code":"filter_warm_bounds_defaults()"},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"Named list defaults (snake_case keys).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"Filters ensemble WARM-generated annual realizations observed annual series using three criterion families: Distributional: relative differences mean standard deviation. Tail behaviour: lower/upper tail mass relative observed quantile thresholds. Spectral: observed-relevant global wavelet spectrum (GWS) filtering. fewer n_select realizations pass, function relaxes criteria iteratively (filter_bounds$relax_max_iter) loosening currently restrictive active filter (lowest pass rate). still insufficient, deterministic fallback returns n_select realizations smallest absolute relative mean difference.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"","code":"filter_warm_pool(   obs_series = NULL,   sim_series = NULL,   n_select = 5,   seed = NULL,   pad_periods = TRUE,   relax_order = c(\"wavelet\", \"sd\", \"tail_low\", \"tail_high\", \"mean\"),   filter_bounds = list(),   wavelet_args = list(signif_level = 0.8, noise_type = \"red\", period_lower_limit = 2,     detrend = TRUE),   make_plots = FALSE,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"obs_series Numeric vector. Observed annual series used reference. sim_series Numeric matrix. Simulated annual realizations years rows realizations columns. n_select Integer scalar. Number realizations return selected. seed Optional integer scalar. Random seed used window selection (lengths differ) sampling final candidate pool. pad_periods Logical scalar. TRUE, expands observed significant-period band one index side checking simulated presence observed-relevant band. relax_order Character vector. Relaxation priority ordering criteria. Must contain c(\"mean\",\"sd\",\"tail_low\",\"tail_high\",\"wavelet\") exactly . filter_bounds Named list. Filtering thresholds relaxation controls. entry overrides internal defaults. Uses snake_case keys (e.g. tail_low_p, tail.low.p). wavelet_args Named list passed analyze_wavelet_spectrum observed simulated series (e.g., signif_level, noise_type, period_lower_limit, detrend). make_plots Logical scalar. TRUE, returns diagnostic plots plots. verbose Logical scalar. TRUE, logs per-iteration pass rates relaxation steps.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"list : pool Numeric matrix. Final candidate pool (subset columns sim_series). selected Numeric matrix. n_select realizations selected final pool. summary Data frame summarising pass counts/rates selection mode. diagnostics List window metadata, indices, relaxation log, final bounds. plots NULL named list ggplot objects make_plots = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"Scans vector dates returns integer indices elements correspond February 29. vector contains leap days, returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"","code":"find_leap_day_indices(date)"},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"date vector coercible Date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"Integer vector indices dates equal February 29, NULL none.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"","code":"find_leap_day_indices(as.Date(c(\"1980-02-28\", \"1980-02-29\", \"1981-01-01\"))) #> [1] 2 find_leap_day_indices(as.Date(c(\"2001-01-01\", \"2001-12-31\"))) #> NULL"},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit gamma distributions for each month — fit_monthly_distributions","title":"Fit gamma distributions for each month — fit_monthly_distributions","text":"Fit gamma distributions month","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit gamma distributions for each month — fit_monthly_distributions","text":"","code":"fit_monthly_distributions(prcp_wet, month_wet, months_ok, fit_method, verbose)"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"Constructs continuous sequence dates starting given start date, using -leap calendar (.e., February 29 removed). function repeats 365-day month-day template increments year every 365 days.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"","code":"generate_noleap_dates(start_date, n_days)"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"start_date Date character coercible Date. first date sequence. date February 29, mapped February 28 -leap template include Feb 29. n_days Integer. Total number dates generate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"vector class Date length n_days, following   -leap (365-day) calendar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"","code":"generate_noleap_dates(\"1980-01-01\", 365) #>   [1] \"1980-01-01\" \"1980-01-02\" \"1980-01-03\" \"1980-01-04\" \"1980-01-05\" #>   [6] \"1980-01-06\" \"1980-01-07\" \"1980-01-08\" \"1980-01-09\" \"1980-01-10\" #>  [11] \"1980-01-11\" \"1980-01-12\" \"1980-01-13\" \"1980-01-14\" \"1980-01-15\" #>  [16] \"1980-01-16\" \"1980-01-17\" \"1980-01-18\" \"1980-01-19\" \"1980-01-20\" #>  [21] \"1980-01-21\" \"1980-01-22\" \"1980-01-23\" \"1980-01-24\" \"1980-01-25\" #>  [26] \"1980-01-26\" \"1980-01-27\" \"1980-01-28\" \"1980-01-29\" \"1980-01-30\" #>  [31] \"1980-01-31\" \"1980-02-01\" \"1980-02-02\" \"1980-02-03\" \"1980-02-04\" #>  [36] \"1980-02-05\" \"1980-02-06\" \"1980-02-07\" \"1980-02-08\" \"1980-02-09\" #>  [41] \"1980-02-10\" \"1980-02-11\" \"1980-02-12\" \"1980-02-13\" \"1980-02-14\" #>  [46] \"1980-02-15\" \"1980-02-16\" \"1980-02-17\" \"1980-02-18\" \"1980-02-19\" #>  [51] \"1980-02-20\" \"1980-02-21\" \"1980-02-22\" \"1980-02-23\" \"1980-02-24\" #>  [56] \"1980-02-25\" \"1980-02-26\" \"1980-02-27\" \"1980-02-28\" \"1980-03-01\" #>  [61] \"1980-03-02\" \"1980-03-03\" \"1980-03-04\" \"1980-03-05\" \"1980-03-06\" #>  [66] \"1980-03-07\" \"1980-03-08\" \"1980-03-09\" \"1980-03-10\" \"1980-03-11\" #>  [71] \"1980-03-12\" \"1980-03-13\" \"1980-03-14\" \"1980-03-15\" \"1980-03-16\" #>  [76] \"1980-03-17\" \"1980-03-18\" \"1980-03-19\" \"1980-03-20\" \"1980-03-21\" #>  [81] \"1980-03-22\" \"1980-03-23\" \"1980-03-24\" \"1980-03-25\" \"1980-03-26\" #>  [86] \"1980-03-27\" \"1980-03-28\" \"1980-03-29\" \"1980-03-30\" \"1980-03-31\" #>  [91] \"1980-04-01\" \"1980-04-02\" \"1980-04-03\" \"1980-04-04\" \"1980-04-05\" #>  [96] \"1980-04-06\" \"1980-04-07\" \"1980-04-08\" \"1980-04-09\" \"1980-04-10\" #> [101] \"1980-04-11\" \"1980-04-12\" \"1980-04-13\" \"1980-04-14\" \"1980-04-15\" #> [106] \"1980-04-16\" \"1980-04-17\" \"1980-04-18\" \"1980-04-19\" \"1980-04-20\" #> [111] \"1980-04-21\" \"1980-04-22\" \"1980-04-23\" \"1980-04-24\" \"1980-04-25\" #> [116] \"1980-04-26\" \"1980-04-27\" \"1980-04-28\" \"1980-04-29\" \"1980-04-30\" #> [121] \"1980-05-01\" \"1980-05-02\" \"1980-05-03\" \"1980-05-04\" \"1980-05-05\" #> [126] \"1980-05-06\" \"1980-05-07\" \"1980-05-08\" \"1980-05-09\" \"1980-05-10\" #> [131] \"1980-05-11\" \"1980-05-12\" \"1980-05-13\" \"1980-05-14\" \"1980-05-15\" #> [136] \"1980-05-16\" \"1980-05-17\" \"1980-05-18\" \"1980-05-19\" \"1980-05-20\" #> [141] \"1980-05-21\" \"1980-05-22\" \"1980-05-23\" \"1980-05-24\" \"1980-05-25\" #> [146] \"1980-05-26\" \"1980-05-27\" \"1980-05-28\" \"1980-05-29\" \"1980-05-30\" #> [151] \"1980-05-31\" \"1980-06-01\" \"1980-06-02\" \"1980-06-03\" \"1980-06-04\" #> [156] \"1980-06-05\" \"1980-06-06\" \"1980-06-07\" \"1980-06-08\" \"1980-06-09\" #> [161] \"1980-06-10\" \"1980-06-11\" \"1980-06-12\" \"1980-06-13\" \"1980-06-14\" #> [166] \"1980-06-15\" \"1980-06-16\" \"1980-06-17\" \"1980-06-18\" \"1980-06-19\" #> [171] \"1980-06-20\" \"1980-06-21\" \"1980-06-22\" \"1980-06-23\" \"1980-06-24\" #> [176] \"1980-06-25\" \"1980-06-26\" \"1980-06-27\" \"1980-06-28\" \"1980-06-29\" #> [181] \"1980-06-30\" \"1980-07-01\" \"1980-07-02\" \"1980-07-03\" \"1980-07-04\" #> [186] \"1980-07-05\" \"1980-07-06\" \"1980-07-07\" \"1980-07-08\" \"1980-07-09\" #> [191] \"1980-07-10\" \"1980-07-11\" \"1980-07-12\" \"1980-07-13\" \"1980-07-14\" #> [196] \"1980-07-15\" \"1980-07-16\" \"1980-07-17\" \"1980-07-18\" \"1980-07-19\" #> [201] \"1980-07-20\" \"1980-07-21\" \"1980-07-22\" \"1980-07-23\" \"1980-07-24\" #> [206] \"1980-07-25\" \"1980-07-26\" \"1980-07-27\" \"1980-07-28\" \"1980-07-29\" #> [211] \"1980-07-30\" \"1980-07-31\" \"1980-08-01\" \"1980-08-02\" \"1980-08-03\" #> [216] \"1980-08-04\" \"1980-08-05\" \"1980-08-06\" \"1980-08-07\" \"1980-08-08\" #> [221] \"1980-08-09\" \"1980-08-10\" \"1980-08-11\" \"1980-08-12\" \"1980-08-13\" #> [226] \"1980-08-14\" \"1980-08-15\" \"1980-08-16\" \"1980-08-17\" \"1980-08-18\" #> [231] \"1980-08-19\" \"1980-08-20\" \"1980-08-21\" \"1980-08-22\" \"1980-08-23\" #> [236] \"1980-08-24\" \"1980-08-25\" \"1980-08-26\" \"1980-08-27\" \"1980-08-28\" #> [241] \"1980-08-29\" \"1980-08-30\" \"1980-08-31\" \"1980-09-01\" \"1980-09-02\" #> [246] \"1980-09-03\" \"1980-09-04\" \"1980-09-05\" \"1980-09-06\" \"1980-09-07\" #> [251] \"1980-09-08\" \"1980-09-09\" \"1980-09-10\" \"1980-09-11\" \"1980-09-12\" #> [256] \"1980-09-13\" \"1980-09-14\" \"1980-09-15\" \"1980-09-16\" \"1980-09-17\" #> [261] \"1980-09-18\" \"1980-09-19\" \"1980-09-20\" \"1980-09-21\" \"1980-09-22\" #> [266] \"1980-09-23\" \"1980-09-24\" \"1980-09-25\" \"1980-09-26\" \"1980-09-27\" #> [271] \"1980-09-28\" \"1980-09-29\" \"1980-09-30\" \"1980-10-01\" \"1980-10-02\" #> [276] \"1980-10-03\" \"1980-10-04\" \"1980-10-05\" \"1980-10-06\" \"1980-10-07\" #> [281] \"1980-10-08\" \"1980-10-09\" \"1980-10-10\" \"1980-10-11\" \"1980-10-12\" #> [286] \"1980-10-13\" \"1980-10-14\" \"1980-10-15\" \"1980-10-16\" \"1980-10-17\" #> [291] \"1980-10-18\" \"1980-10-19\" \"1980-10-20\" \"1980-10-21\" \"1980-10-22\" #> [296] \"1980-10-23\" \"1980-10-24\" \"1980-10-25\" \"1980-10-26\" \"1980-10-27\" #> [301] \"1980-10-28\" \"1980-10-29\" \"1980-10-30\" \"1980-10-31\" \"1980-11-01\" #> [306] \"1980-11-02\" \"1980-11-03\" \"1980-11-04\" \"1980-11-05\" \"1980-11-06\" #> [311] \"1980-11-07\" \"1980-11-08\" \"1980-11-09\" \"1980-11-10\" \"1980-11-11\" #> [316] \"1980-11-12\" \"1980-11-13\" \"1980-11-14\" \"1980-11-15\" \"1980-11-16\" #> [321] \"1980-11-17\" \"1980-11-18\" \"1980-11-19\" \"1980-11-20\" \"1980-11-21\" #> [326] \"1980-11-22\" \"1980-11-23\" \"1980-11-24\" \"1980-11-25\" \"1980-11-26\" #> [331] \"1980-11-27\" \"1980-11-28\" \"1980-11-29\" \"1980-11-30\" \"1980-12-01\" #> [336] \"1980-12-02\" \"1980-12-03\" \"1980-12-04\" \"1980-12-05\" \"1980-12-06\" #> [341] \"1980-12-07\" \"1980-12-08\" \"1980-12-09\" \"1980-12-10\" \"1980-12-11\" #> [346] \"1980-12-12\" \"1980-12-13\" \"1980-12-14\" \"1980-12-15\" \"1980-12-16\" #> [351] \"1980-12-17\" \"1980-12-18\" \"1980-12-19\" \"1980-12-20\" \"1980-12-21\" #> [356] \"1980-12-22\" \"1980-12-23\" \"1980-12-24\" \"1980-12-25\" \"1980-12-26\" #> [361] \"1980-12-27\" \"1980-12-28\" \"1980-12-29\" \"1980-12-30\" \"1980-12-31\" generate_noleap_dates(as.Date(\"1995-02-28\"), 1000) #>    [1] \"1995-02-28\" \"1995-03-01\" \"1995-03-02\" \"1995-03-03\" \"1995-03-04\" #>    [6] \"1995-03-05\" \"1995-03-06\" \"1995-03-07\" \"1995-03-08\" \"1995-03-09\" #>   [11] \"1995-03-10\" \"1995-03-11\" \"1995-03-12\" \"1995-03-13\" \"1995-03-14\" #>   [16] \"1995-03-15\" \"1995-03-16\" \"1995-03-17\" \"1995-03-18\" \"1995-03-19\" #>   [21] \"1995-03-20\" \"1995-03-21\" \"1995-03-22\" \"1995-03-23\" \"1995-03-24\" #>   [26] \"1995-03-25\" \"1995-03-26\" \"1995-03-27\" \"1995-03-28\" \"1995-03-29\" #>   [31] \"1995-03-30\" \"1995-03-31\" \"1995-04-01\" \"1995-04-02\" \"1995-04-03\" #>   [36] \"1995-04-04\" \"1995-04-05\" \"1995-04-06\" \"1995-04-07\" \"1995-04-08\" #>   [41] \"1995-04-09\" \"1995-04-10\" \"1995-04-11\" \"1995-04-12\" \"1995-04-13\" #>   [46] \"1995-04-14\" \"1995-04-15\" \"1995-04-16\" \"1995-04-17\" \"1995-04-18\" #>   [51] \"1995-04-19\" \"1995-04-20\" \"1995-04-21\" \"1995-04-22\" \"1995-04-23\" #>   [56] \"1995-04-24\" \"1995-04-25\" \"1995-04-26\" \"1995-04-27\" \"1995-04-28\" #>   [61] \"1995-04-29\" \"1995-04-30\" \"1995-05-01\" \"1995-05-02\" \"1995-05-03\" #>   [66] \"1995-05-04\" \"1995-05-05\" \"1995-05-06\" \"1995-05-07\" \"1995-05-08\" #>   [71] \"1995-05-09\" \"1995-05-10\" \"1995-05-11\" \"1995-05-12\" \"1995-05-13\" #>   [76] \"1995-05-14\" \"1995-05-15\" \"1995-05-16\" \"1995-05-17\" \"1995-05-18\" #>   [81] \"1995-05-19\" \"1995-05-20\" \"1995-05-21\" \"1995-05-22\" \"1995-05-23\" #>   [86] \"1995-05-24\" \"1995-05-25\" \"1995-05-26\" \"1995-05-27\" \"1995-05-28\" #>   [91] \"1995-05-29\" \"1995-05-30\" \"1995-05-31\" \"1995-06-01\" \"1995-06-02\" #>   [96] \"1995-06-03\" \"1995-06-04\" \"1995-06-05\" \"1995-06-06\" \"1995-06-07\" #>  [101] \"1995-06-08\" \"1995-06-09\" \"1995-06-10\" \"1995-06-11\" \"1995-06-12\" #>  [106] \"1995-06-13\" \"1995-06-14\" \"1995-06-15\" \"1995-06-16\" \"1995-06-17\" #>  [111] \"1995-06-18\" \"1995-06-19\" \"1995-06-20\" \"1995-06-21\" \"1995-06-22\" #>  [116] \"1995-06-23\" \"1995-06-24\" \"1995-06-25\" \"1995-06-26\" \"1995-06-27\" #>  [121] \"1995-06-28\" \"1995-06-29\" \"1995-06-30\" \"1995-07-01\" \"1995-07-02\" #>  [126] \"1995-07-03\" \"1995-07-04\" \"1995-07-05\" \"1995-07-06\" \"1995-07-07\" #>  [131] \"1995-07-08\" \"1995-07-09\" \"1995-07-10\" \"1995-07-11\" \"1995-07-12\" #>  [136] \"1995-07-13\" \"1995-07-14\" \"1995-07-15\" \"1995-07-16\" \"1995-07-17\" #>  [141] \"1995-07-18\" \"1995-07-19\" \"1995-07-20\" \"1995-07-21\" \"1995-07-22\" #>  [146] \"1995-07-23\" \"1995-07-24\" \"1995-07-25\" \"1995-07-26\" \"1995-07-27\" #>  [151] \"1995-07-28\" \"1995-07-29\" \"1995-07-30\" \"1995-07-31\" \"1995-08-01\" #>  [156] \"1995-08-02\" \"1995-08-03\" \"1995-08-04\" \"1995-08-05\" \"1995-08-06\" #>  [161] \"1995-08-07\" \"1995-08-08\" \"1995-08-09\" \"1995-08-10\" \"1995-08-11\" #>  [166] \"1995-08-12\" \"1995-08-13\" \"1995-08-14\" \"1995-08-15\" \"1995-08-16\" #>  [171] \"1995-08-17\" \"1995-08-18\" \"1995-08-19\" \"1995-08-20\" \"1995-08-21\" #>  [176] \"1995-08-22\" \"1995-08-23\" \"1995-08-24\" \"1995-08-25\" \"1995-08-26\" #>  [181] \"1995-08-27\" \"1995-08-28\" \"1995-08-29\" \"1995-08-30\" \"1995-08-31\" #>  [186] \"1995-09-01\" \"1995-09-02\" \"1995-09-03\" \"1995-09-04\" \"1995-09-05\" #>  [191] \"1995-09-06\" \"1995-09-07\" \"1995-09-08\" \"1995-09-09\" \"1995-09-10\" #>  [196] \"1995-09-11\" \"1995-09-12\" \"1995-09-13\" \"1995-09-14\" \"1995-09-15\" #>  [201] \"1995-09-16\" \"1995-09-17\" \"1995-09-18\" \"1995-09-19\" \"1995-09-20\" #>  [206] \"1995-09-21\" \"1995-09-22\" \"1995-09-23\" \"1995-09-24\" \"1995-09-25\" #>  [211] \"1995-09-26\" \"1995-09-27\" \"1995-09-28\" \"1995-09-29\" \"1995-09-30\" #>  [216] \"1995-10-01\" \"1995-10-02\" \"1995-10-03\" \"1995-10-04\" \"1995-10-05\" #>  [221] \"1995-10-06\" \"1995-10-07\" \"1995-10-08\" \"1995-10-09\" \"1995-10-10\" #>  [226] \"1995-10-11\" \"1995-10-12\" \"1995-10-13\" \"1995-10-14\" \"1995-10-15\" #>  [231] \"1995-10-16\" \"1995-10-17\" \"1995-10-18\" \"1995-10-19\" \"1995-10-20\" #>  [236] \"1995-10-21\" \"1995-10-22\" \"1995-10-23\" \"1995-10-24\" \"1995-10-25\" #>  [241] \"1995-10-26\" \"1995-10-27\" \"1995-10-28\" \"1995-10-29\" \"1995-10-30\" #>  [246] \"1995-10-31\" \"1995-11-01\" \"1995-11-02\" \"1995-11-03\" \"1995-11-04\" #>  [251] \"1995-11-05\" \"1995-11-06\" \"1995-11-07\" \"1995-11-08\" \"1995-11-09\" #>  [256] \"1995-11-10\" \"1995-11-11\" \"1995-11-12\" \"1995-11-13\" \"1995-11-14\" #>  [261] \"1995-11-15\" \"1995-11-16\" \"1995-11-17\" \"1995-11-18\" \"1995-11-19\" #>  [266] \"1995-11-20\" \"1995-11-21\" \"1995-11-22\" \"1995-11-23\" \"1995-11-24\" #>  [271] \"1995-11-25\" \"1995-11-26\" \"1995-11-27\" \"1995-11-28\" \"1995-11-29\" #>  [276] \"1995-11-30\" \"1995-12-01\" \"1995-12-02\" \"1995-12-03\" \"1995-12-04\" #>  [281] \"1995-12-05\" \"1995-12-06\" \"1995-12-07\" \"1995-12-08\" \"1995-12-09\" #>  [286] \"1995-12-10\" \"1995-12-11\" \"1995-12-12\" \"1995-12-13\" \"1995-12-14\" #>  [291] \"1995-12-15\" \"1995-12-16\" \"1995-12-17\" \"1995-12-18\" \"1995-12-19\" #>  [296] \"1995-12-20\" \"1995-12-21\" \"1995-12-22\" \"1995-12-23\" \"1995-12-24\" #>  [301] \"1995-12-25\" \"1995-12-26\" \"1995-12-27\" \"1995-12-28\" \"1995-12-29\" #>  [306] \"1995-12-30\" \"1995-12-31\" \"1996-01-01\" \"1996-01-02\" \"1996-01-03\" #>  [311] \"1996-01-04\" \"1996-01-05\" \"1996-01-06\" \"1996-01-07\" \"1996-01-08\" #>  [316] \"1996-01-09\" \"1996-01-10\" \"1996-01-11\" \"1996-01-12\" \"1996-01-13\" #>  [321] \"1996-01-14\" \"1996-01-15\" \"1996-01-16\" \"1996-01-17\" \"1996-01-18\" #>  [326] \"1996-01-19\" \"1996-01-20\" \"1996-01-21\" \"1996-01-22\" \"1996-01-23\" #>  [331] \"1996-01-24\" \"1996-01-25\" \"1996-01-26\" \"1996-01-27\" \"1996-01-28\" #>  [336] \"1996-01-29\" \"1996-01-30\" \"1996-01-31\" \"1996-02-01\" \"1996-02-02\" #>  [341] \"1996-02-03\" \"1996-02-04\" \"1996-02-05\" \"1996-02-06\" \"1996-02-07\" #>  [346] \"1996-02-08\" \"1996-02-09\" \"1996-02-10\" \"1996-02-11\" \"1996-02-12\" #>  [351] \"1996-02-13\" \"1996-02-14\" \"1996-02-15\" \"1996-02-16\" \"1996-02-17\" #>  [356] \"1996-02-18\" \"1996-02-19\" \"1996-02-20\" \"1996-02-21\" \"1996-02-22\" #>  [361] \"1996-02-23\" \"1996-02-24\" \"1996-02-25\" \"1996-02-26\" \"1996-02-27\" #>  [366] \"1996-02-28\" \"1996-03-01\" \"1996-03-02\" \"1996-03-03\" \"1996-03-04\" #>  [371] \"1996-03-05\" \"1996-03-06\" \"1996-03-07\" \"1996-03-08\" \"1996-03-09\" #>  [376] \"1996-03-10\" \"1996-03-11\" \"1996-03-12\" \"1996-03-13\" \"1996-03-14\" #>  [381] \"1996-03-15\" \"1996-03-16\" \"1996-03-17\" \"1996-03-18\" \"1996-03-19\" #>  [386] \"1996-03-20\" \"1996-03-21\" \"1996-03-22\" \"1996-03-23\" \"1996-03-24\" #>  [391] \"1996-03-25\" \"1996-03-26\" \"1996-03-27\" \"1996-03-28\" \"1996-03-29\" #>  [396] \"1996-03-30\" \"1996-03-31\" \"1996-04-01\" \"1996-04-02\" \"1996-04-03\" #>  [401] \"1996-04-04\" \"1996-04-05\" \"1996-04-06\" \"1996-04-07\" \"1996-04-08\" #>  [406] \"1996-04-09\" \"1996-04-10\" \"1996-04-11\" \"1996-04-12\" \"1996-04-13\" #>  [411] \"1996-04-14\" \"1996-04-15\" \"1996-04-16\" \"1996-04-17\" \"1996-04-18\" #>  [416] \"1996-04-19\" \"1996-04-20\" \"1996-04-21\" \"1996-04-22\" \"1996-04-23\" #>  [421] \"1996-04-24\" \"1996-04-25\" \"1996-04-26\" \"1996-04-27\" \"1996-04-28\" #>  [426] \"1996-04-29\" \"1996-04-30\" \"1996-05-01\" \"1996-05-02\" \"1996-05-03\" #>  [431] \"1996-05-04\" \"1996-05-05\" \"1996-05-06\" \"1996-05-07\" \"1996-05-08\" #>  [436] \"1996-05-09\" \"1996-05-10\" \"1996-05-11\" \"1996-05-12\" \"1996-05-13\" #>  [441] \"1996-05-14\" \"1996-05-15\" \"1996-05-16\" \"1996-05-17\" \"1996-05-18\" #>  [446] \"1996-05-19\" \"1996-05-20\" \"1996-05-21\" \"1996-05-22\" \"1996-05-23\" #>  [451] \"1996-05-24\" \"1996-05-25\" \"1996-05-26\" \"1996-05-27\" \"1996-05-28\" #>  [456] \"1996-05-29\" \"1996-05-30\" \"1996-05-31\" \"1996-06-01\" \"1996-06-02\" #>  [461] \"1996-06-03\" \"1996-06-04\" \"1996-06-05\" \"1996-06-06\" \"1996-06-07\" #>  [466] \"1996-06-08\" \"1996-06-09\" \"1996-06-10\" \"1996-06-11\" \"1996-06-12\" #>  [471] \"1996-06-13\" \"1996-06-14\" \"1996-06-15\" \"1996-06-16\" \"1996-06-17\" #>  [476] \"1996-06-18\" \"1996-06-19\" \"1996-06-20\" \"1996-06-21\" \"1996-06-22\" #>  [481] \"1996-06-23\" \"1996-06-24\" \"1996-06-25\" \"1996-06-26\" \"1996-06-27\" #>  [486] \"1996-06-28\" \"1996-06-29\" \"1996-06-30\" \"1996-07-01\" \"1996-07-02\" #>  [491] \"1996-07-03\" \"1996-07-04\" \"1996-07-05\" \"1996-07-06\" \"1996-07-07\" #>  [496] \"1996-07-08\" \"1996-07-09\" \"1996-07-10\" \"1996-07-11\" \"1996-07-12\" #>  [501] \"1996-07-13\" \"1996-07-14\" \"1996-07-15\" \"1996-07-16\" \"1996-07-17\" #>  [506] \"1996-07-18\" \"1996-07-19\" \"1996-07-20\" \"1996-07-21\" \"1996-07-22\" #>  [511] \"1996-07-23\" \"1996-07-24\" \"1996-07-25\" \"1996-07-26\" \"1996-07-27\" #>  [516] \"1996-07-28\" \"1996-07-29\" \"1996-07-30\" \"1996-07-31\" \"1996-08-01\" #>  [521] \"1996-08-02\" \"1996-08-03\" \"1996-08-04\" \"1996-08-05\" \"1996-08-06\" #>  [526] \"1996-08-07\" \"1996-08-08\" \"1996-08-09\" \"1996-08-10\" \"1996-08-11\" #>  [531] \"1996-08-12\" \"1996-08-13\" \"1996-08-14\" \"1996-08-15\" \"1996-08-16\" #>  [536] \"1996-08-17\" \"1996-08-18\" \"1996-08-19\" \"1996-08-20\" \"1996-08-21\" #>  [541] \"1996-08-22\" \"1996-08-23\" \"1996-08-24\" \"1996-08-25\" \"1996-08-26\" #>  [546] \"1996-08-27\" \"1996-08-28\" \"1996-08-29\" \"1996-08-30\" \"1996-08-31\" #>  [551] \"1996-09-01\" \"1996-09-02\" \"1996-09-03\" \"1996-09-04\" \"1996-09-05\" #>  [556] \"1996-09-06\" \"1996-09-07\" \"1996-09-08\" \"1996-09-09\" \"1996-09-10\" #>  [561] \"1996-09-11\" \"1996-09-12\" \"1996-09-13\" \"1996-09-14\" \"1996-09-15\" #>  [566] \"1996-09-16\" \"1996-09-17\" \"1996-09-18\" \"1996-09-19\" \"1996-09-20\" #>  [571] \"1996-09-21\" \"1996-09-22\" \"1996-09-23\" \"1996-09-24\" \"1996-09-25\" #>  [576] \"1996-09-26\" \"1996-09-27\" \"1996-09-28\" \"1996-09-29\" \"1996-09-30\" #>  [581] \"1996-10-01\" \"1996-10-02\" \"1996-10-03\" \"1996-10-04\" \"1996-10-05\" #>  [586] \"1996-10-06\" \"1996-10-07\" \"1996-10-08\" \"1996-10-09\" \"1996-10-10\" #>  [591] \"1996-10-11\" \"1996-10-12\" \"1996-10-13\" \"1996-10-14\" \"1996-10-15\" #>  [596] \"1996-10-16\" \"1996-10-17\" \"1996-10-18\" \"1996-10-19\" \"1996-10-20\" #>  [601] \"1996-10-21\" \"1996-10-22\" \"1996-10-23\" \"1996-10-24\" \"1996-10-25\" #>  [606] \"1996-10-26\" \"1996-10-27\" \"1996-10-28\" \"1996-10-29\" \"1996-10-30\" #>  [611] \"1996-10-31\" \"1996-11-01\" \"1996-11-02\" \"1996-11-03\" \"1996-11-04\" #>  [616] \"1996-11-05\" \"1996-11-06\" \"1996-11-07\" \"1996-11-08\" \"1996-11-09\" #>  [621] \"1996-11-10\" \"1996-11-11\" \"1996-11-12\" \"1996-11-13\" \"1996-11-14\" #>  [626] \"1996-11-15\" \"1996-11-16\" \"1996-11-17\" \"1996-11-18\" \"1996-11-19\" #>  [631] \"1996-11-20\" \"1996-11-21\" \"1996-11-22\" \"1996-11-23\" \"1996-11-24\" #>  [636] \"1996-11-25\" \"1996-11-26\" \"1996-11-27\" \"1996-11-28\" \"1996-11-29\" #>  [641] \"1996-11-30\" \"1996-12-01\" \"1996-12-02\" \"1996-12-03\" \"1996-12-04\" #>  [646] \"1996-12-05\" \"1996-12-06\" \"1996-12-07\" \"1996-12-08\" \"1996-12-09\" #>  [651] \"1996-12-10\" \"1996-12-11\" \"1996-12-12\" \"1996-12-13\" \"1996-12-14\" #>  [656] \"1996-12-15\" \"1996-12-16\" \"1996-12-17\" \"1996-12-18\" \"1996-12-19\" #>  [661] \"1996-12-20\" \"1996-12-21\" \"1996-12-22\" \"1996-12-23\" \"1996-12-24\" #>  [666] \"1996-12-25\" \"1996-12-26\" \"1996-12-27\" \"1996-12-28\" \"1996-12-29\" #>  [671] \"1996-12-30\" \"1996-12-31\" \"1997-01-01\" \"1997-01-02\" \"1997-01-03\" #>  [676] \"1997-01-04\" \"1997-01-05\" \"1997-01-06\" \"1997-01-07\" \"1997-01-08\" #>  [681] \"1997-01-09\" \"1997-01-10\" \"1997-01-11\" \"1997-01-12\" \"1997-01-13\" #>  [686] \"1997-01-14\" \"1997-01-15\" \"1997-01-16\" \"1997-01-17\" \"1997-01-18\" #>  [691] \"1997-01-19\" \"1997-01-20\" \"1997-01-21\" \"1997-01-22\" \"1997-01-23\" #>  [696] \"1997-01-24\" \"1997-01-25\" \"1997-01-26\" \"1997-01-27\" \"1997-01-28\" #>  [701] \"1997-01-29\" \"1997-01-30\" \"1997-01-31\" \"1997-02-01\" \"1997-02-02\" #>  [706] \"1997-02-03\" \"1997-02-04\" \"1997-02-05\" \"1997-02-06\" \"1997-02-07\" #>  [711] \"1997-02-08\" \"1997-02-09\" \"1997-02-10\" \"1997-02-11\" \"1997-02-12\" #>  [716] \"1997-02-13\" \"1997-02-14\" \"1997-02-15\" \"1997-02-16\" \"1997-02-17\" #>  [721] \"1997-02-18\" \"1997-02-19\" \"1997-02-20\" \"1997-02-21\" \"1997-02-22\" #>  [726] \"1997-02-23\" \"1997-02-24\" \"1997-02-25\" \"1997-02-26\" \"1997-02-27\" #>  [731] \"1997-02-28\" \"1997-03-01\" \"1997-03-02\" \"1997-03-03\" \"1997-03-04\" #>  [736] \"1997-03-05\" \"1997-03-06\" \"1997-03-07\" \"1997-03-08\" \"1997-03-09\" #>  [741] \"1997-03-10\" \"1997-03-11\" \"1997-03-12\" \"1997-03-13\" \"1997-03-14\" #>  [746] \"1997-03-15\" \"1997-03-16\" \"1997-03-17\" \"1997-03-18\" \"1997-03-19\" #>  [751] \"1997-03-20\" \"1997-03-21\" \"1997-03-22\" \"1997-03-23\" \"1997-03-24\" #>  [756] \"1997-03-25\" \"1997-03-26\" \"1997-03-27\" \"1997-03-28\" \"1997-03-29\" #>  [761] \"1997-03-30\" \"1997-03-31\" \"1997-04-01\" \"1997-04-02\" \"1997-04-03\" #>  [766] \"1997-04-04\" \"1997-04-05\" \"1997-04-06\" \"1997-04-07\" \"1997-04-08\" #>  [771] \"1997-04-09\" \"1997-04-10\" \"1997-04-11\" \"1997-04-12\" \"1997-04-13\" #>  [776] \"1997-04-14\" \"1997-04-15\" \"1997-04-16\" \"1997-04-17\" \"1997-04-18\" #>  [781] \"1997-04-19\" \"1997-04-20\" \"1997-04-21\" \"1997-04-22\" \"1997-04-23\" #>  [786] \"1997-04-24\" \"1997-04-25\" \"1997-04-26\" \"1997-04-27\" \"1997-04-28\" #>  [791] \"1997-04-29\" \"1997-04-30\" \"1997-05-01\" \"1997-05-02\" \"1997-05-03\" #>  [796] \"1997-05-04\" \"1997-05-05\" \"1997-05-06\" \"1997-05-07\" \"1997-05-08\" #>  [801] \"1997-05-09\" \"1997-05-10\" \"1997-05-11\" \"1997-05-12\" \"1997-05-13\" #>  [806] \"1997-05-14\" \"1997-05-15\" \"1997-05-16\" \"1997-05-17\" \"1997-05-18\" #>  [811] \"1997-05-19\" \"1997-05-20\" \"1997-05-21\" \"1997-05-22\" \"1997-05-23\" #>  [816] \"1997-05-24\" \"1997-05-25\" \"1997-05-26\" \"1997-05-27\" \"1997-05-28\" #>  [821] \"1997-05-29\" \"1997-05-30\" \"1997-05-31\" \"1997-06-01\" \"1997-06-02\" #>  [826] \"1997-06-03\" \"1997-06-04\" \"1997-06-05\" \"1997-06-06\" \"1997-06-07\" #>  [831] \"1997-06-08\" \"1997-06-09\" \"1997-06-10\" \"1997-06-11\" \"1997-06-12\" #>  [836] \"1997-06-13\" \"1997-06-14\" \"1997-06-15\" \"1997-06-16\" \"1997-06-17\" #>  [841] \"1997-06-18\" \"1997-06-19\" \"1997-06-20\" \"1997-06-21\" \"1997-06-22\" #>  [846] \"1997-06-23\" \"1997-06-24\" \"1997-06-25\" \"1997-06-26\" \"1997-06-27\" #>  [851] \"1997-06-28\" \"1997-06-29\" \"1997-06-30\" \"1997-07-01\" \"1997-07-02\" #>  [856] \"1997-07-03\" \"1997-07-04\" \"1997-07-05\" \"1997-07-06\" \"1997-07-07\" #>  [861] \"1997-07-08\" \"1997-07-09\" \"1997-07-10\" \"1997-07-11\" \"1997-07-12\" #>  [866] \"1997-07-13\" \"1997-07-14\" \"1997-07-15\" \"1997-07-16\" \"1997-07-17\" #>  [871] \"1997-07-18\" \"1997-07-19\" \"1997-07-20\" \"1997-07-21\" \"1997-07-22\" #>  [876] \"1997-07-23\" \"1997-07-24\" \"1997-07-25\" \"1997-07-26\" \"1997-07-27\" #>  [881] \"1997-07-28\" \"1997-07-29\" \"1997-07-30\" \"1997-07-31\" \"1997-08-01\" #>  [886] \"1997-08-02\" \"1997-08-03\" \"1997-08-04\" \"1997-08-05\" \"1997-08-06\" #>  [891] \"1997-08-07\" \"1997-08-08\" \"1997-08-09\" \"1997-08-10\" \"1997-08-11\" #>  [896] \"1997-08-12\" \"1997-08-13\" \"1997-08-14\" \"1997-08-15\" \"1997-08-16\" #>  [901] \"1997-08-17\" \"1997-08-18\" \"1997-08-19\" \"1997-08-20\" \"1997-08-21\" #>  [906] \"1997-08-22\" \"1997-08-23\" \"1997-08-24\" \"1997-08-25\" \"1997-08-26\" #>  [911] \"1997-08-27\" \"1997-08-28\" \"1997-08-29\" \"1997-08-30\" \"1997-08-31\" #>  [916] \"1997-09-01\" \"1997-09-02\" \"1997-09-03\" \"1997-09-04\" \"1997-09-05\" #>  [921] \"1997-09-06\" \"1997-09-07\" \"1997-09-08\" \"1997-09-09\" \"1997-09-10\" #>  [926] \"1997-09-11\" \"1997-09-12\" \"1997-09-13\" \"1997-09-14\" \"1997-09-15\" #>  [931] \"1997-09-16\" \"1997-09-17\" \"1997-09-18\" \"1997-09-19\" \"1997-09-20\" #>  [936] \"1997-09-21\" \"1997-09-22\" \"1997-09-23\" \"1997-09-24\" \"1997-09-25\" #>  [941] \"1997-09-26\" \"1997-09-27\" \"1997-09-28\" \"1997-09-29\" \"1997-09-30\" #>  [946] \"1997-10-01\" \"1997-10-02\" \"1997-10-03\" \"1997-10-04\" \"1997-10-05\" #>  [951] \"1997-10-06\" \"1997-10-07\" \"1997-10-08\" \"1997-10-09\" \"1997-10-10\" #>  [956] \"1997-10-11\" \"1997-10-12\" \"1997-10-13\" \"1997-10-14\" \"1997-10-15\" #>  [961] \"1997-10-16\" \"1997-10-17\" \"1997-10-18\" \"1997-10-19\" \"1997-10-20\" #>  [966] \"1997-10-21\" \"1997-10-22\" \"1997-10-23\" \"1997-10-24\" \"1997-10-25\" #>  [971] \"1997-10-26\" \"1997-10-27\" \"1997-10-28\" \"1997-10-29\" \"1997-10-30\" #>  [976] \"1997-10-31\" \"1997-11-01\" \"1997-11-02\" \"1997-11-03\" \"1997-11-04\" #>  [981] \"1997-11-05\" \"1997-11-06\" \"1997-11-07\" \"1997-11-08\" \"1997-11-09\" #>  [986] \"1997-11-10\" \"1997-11-11\" \"1997-11-12\" \"1997-11-13\" \"1997-11-14\" #>  [991] \"1997-11-15\" \"1997-11-16\" \"1997-11-17\" \"1997-11-18\" \"1997-11-19\" #>  [996] \"1997-11-20\" \"1997-11-21\" \"1997-11-22\" \"1997-11-23\" \"1997-11-24\""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"Creates invisible points x = y min/max range per facet force ggplot use symmetric x/y limits within facet scales free.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"","code":"generate_symmetric_dummy_points(df, facet_var, x_col, y_col)"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"df Data frame containing plotted data. facet_var Character; name facet column df. x_col Character; name x column df. y_col Character; name y column df.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"Data frame columns facet_var, Observed, Simulated   (using x_col y_col names) containing min/max dummy points.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"output includes two points per facet (min max). points can added geom_blank() enforce consistent axis limits without affecting visible data.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"","code":"df <- data.frame(   variable = c(\"precip\", \"precip\", \"temp\", \"temp\"),   Observed = c(1, 5, 10, 12),   Simulated = c(0.5, 6, 9, 13) ) generate_symmetric_dummy_points(df, \"variable\", \"Observed\", \"Simulated\") #> # A tibble: 4 × 3 #>   variable Observed Simulated #>   <chr>       <dbl>     <dbl> #> 1 precip        0.5       0.5 #> 2 temp          9         9   #> 3 precip        6         6   #> 4 temp         13        13"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Synthetic Gridded Daily Weather Series — generate_weather","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"Generates stochastic gridded daily weather coupling annual-scale low-frequency generator daily-scale resampling persistence logic. workflow combines: Wavelet Autoregressive Modeling (WARM) annual aggregate     warm_var simulate low-frequency variability, annual K-nearest-neighbor (KNN) matching select historical analogue years, three-state (dry, wet, extreme) daily Markov chain control spell persistence, daily KNN resampling precipitation temperature anomalies. simulation-year defINITion inferred year_start_month: year_start_month == 1: calendar-year simulation, year_start_month != 1: water-year simulation starting year_start_month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"","code":"generate_weather(   obs_data = NULL,   obs_grid = NULL,   obs_dates = NULL,   vars = NULL,   n_years = NULL,   start_year = 2020,   year_start_month = 1,   n_realizations = 5,   warm_var = \"precip\",   warm_signif = 0.9,   warm_pool_size = 5000,   annual_knn_n = 120,   wet_q = 0.3,   extreme_q = 0.8,   dry_spell_factor = rep(1, 12),   wet_spell_factor = rep(1, 12),   out_dir = tempdir(),   seed = NULL,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"obs_data Named list data.frames (one per grid cell) observed daily weather. data.frame must one row per day corresponding obs_dates, columns vars. obs_grid Data.frame describing grid cells. Must contain columns xind, yind, x, y. id missing, created sequential index. obs_dates Vector class Date corresponding rows obs_data[[]]. May include Feb 29; Feb 29 removed internally along corresponding rows obs_data. vars Character vector daily variables simulate (e.g., c(\"precip\",\"temp\")). n_years Integer number years simulate. NULL, defaults number complete historical simulation-years available enforcing 365-day calendar restricting longest contiguous block complete years. start_year Integer first simulation year (calendar year year_start_month == 1, otherwise first water year label). year_start_month Integer 1:12. First month simulation year. Use 1 calendar years; use 10 Oct–Sep water years, etc. n_realizations Integer number realizations generate. warm_var Character name annual driver variable used WARM. Must present vars. warm_signif Numeric (0,1). Wavelet significance level used retain low-frequency components WARM. warm_pool_size Integer number candidate annual traces generate filtering n_realizations. annual_knn_n Integer number historical analogue years considered annual KNN step disaggregation. wet_q Numeric (0,1). Wet-day threshold quantile used daily Markov chain classification. extreme_q Numeric (0,1). Extreme-day threshold quantile used daily Markov chain classification. Must greater wet_q. dry_spell_factor Numeric length-12 vector monthly dry-spell adjustment factors applied Markov-chain persistence logic. wet_spell_factor Numeric length-12 vector monthly wet-spell adjustment factors applied Markov-chain persistence logic. out_dir Character directory diagnostics CSV outputs. directory created exist. seed Optional integer seed reproducibility. Used initialize RNG streams annual (WARM) daily resampling components. parallel Logical; TRUE, run daily disaggregation across realizations parallel using PSOCK cluster. n_cores Optional integer number cores parallel execution. NULL parallel = TRUE, defaults max(1, parallel::detectCores() - 1). verbose Logical; TRUE, emits progress logs via .log().","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"list : resampled Tibble/data.frame one column per realization.     column contains historical observation dates (dateo) selected     analogues simulated day. Column names rlz_1, rlz_2, ... dates Vector class Date giving simulated daily time axis     (Feb 29 excluded).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"Calendar handling (robust Gregorian input): Inputs may Gregorian calendar may include Feb 29. Internally, function enforces 365-day calendar removing Feb 29 obs_dates dropping corresponding rows every element obs_data. downstream processing outputs therefore use 365-day calendar. Workflow: Historical preprocessing: Enforce 365-day calendar, compute     calendar/water-year indices, build historical dates table used     KNN matching Markov chain sequencing. Annual WARM simulation: Aggregate historical daily data annual     means (water year applicable), run wavelet analysis annual     series, simulate candidate annual traces via simulate_warm,     subset traces using filter_warm_pool. Daily disaggregation: realization, call     resample_weather_dates generate simulated sequence     historical analogue dates (internal 365-day calendar). Output construction: Map resampled internal dates back     historical observation dates (dateo) return simulated dates.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"","code":"if (FALSE) { # \\dontrun{ # obs_data: list of grid-cell data.frames with columns precip/temp # obs_grid: data.frame with xind/yind/x/y # obs_dates: Date vector aligned with rows of each obs_data[[i]] out <- generate_weather(   obs_data = obs_data,   obs_grid = obs_grid,   obs_dates = obs_dates,   vars = c(\"precip\", \"temp\"),   start_year = 2020,   n_years = 30,   year_start_month = 10,   n_realizations = 20,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 5000,   annual_knn_n = 120,   wet_q = 0.30,   extreme_q = 0.80,   out_dir = tempdir(),   seed = 123,   parallel = TRUE,   n_cores = 4,   verbose = TRUE ) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely Get or Sample an Index from a Vector — get_result_index","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"Returns valid index `candidate_prcp` based provided `idx`. `idx` missing, bounds, invalid, random index sampled instead. `candidate_prcp` empty, `NA_integer_` returned.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"","code":"get_result_index(idx, candidate_prcp)"},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"idx Integer. Proposed index retrieving element `candidate_prcp`. candidate_prcp Numeric vector. set candidate precipitation values (e.g., next day).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"Integer. valid index `candidate_prcp`, `NA_integer_` `candidate_prcp` empty.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"","code":"candidate_prcp <- c(0, 5, 10, 20) get_result_index(2, candidate_prcp) #> [1] 2  set.seed(1) get_result_index(10, candidate_prcp) #> [1] 1  get_result_index(NA, candidate_prcp) #> [1] 4 get_result_index(1, numeric(0)) #> [1] NA"},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":null,"dir":"Reference","previous_headings":"","what":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"Linearly interpolates global wavelet spectrum wavelet analysis output onto target period grid fills edge values using nearest-neighbor filling.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"","code":"gws_regrid(wavelet, target_period, use_unmasked = FALSE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"wavelet List output analyze_wavelet_spectrum. target_period Numeric vector. Target periods interpolation. use_unmasked Logical. TRUE available, uses wavelet$gws_unmasked; otherwise uses wavelet$gws.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"Numeric vector interpolated GWS values target_period.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"Given set candidate vectors target vector, selects indices k nearest candidates (using weighted Euclidean distance) target, samples n indices neighbors, either uniformly rank-based distance-based probabilities. Optionally, random seed can set reproducibility.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"","code":"knn_sample(   candidates,   target,   k,   n = 1,   prob = FALSE,   weights = NULL,   seed = NULL,   sampling = c(\"rank\", \"distance\"),   bandwidth = NULL,   epsilon = 1e-08 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"candidates Numeric matrix data frame. row candidate vector. target Numeric vector. target vector comparison. k Integer. Number nearest neighbors consider (k <= number candidates). n Integer. Number samples draw (default = 1). prob Logical. TRUE, sampling probabilities favor closer neighbors; FALSE (default), sampling uniform among k nearest neighbors. weights Optional numeric vector length equal ncol(candidates). Feature weights distance calculation. Default equal weights. seed Optional integer. provided, sets random seed reproducible sampling. seed state restored exit. sampling Character. Sampling method prob = TRUE. Either \"rank\" (default, probability decreases neighbor rank: 1, 1/2, 1/3, ...) \"distance\" (probability based Gaussian kernel distances). Ignored prob = FALSE. bandwidth Numeric. Bandwidth parameter distance-based sampling kernel. NULL (default), uses median nearest neighbor distance. used sampling = \"distance\" prob = TRUE. epsilon Numeric. Small constant added distance-based probabilities prevent zero probabilities (default = 1e-8). used sampling = \"distance\" prob = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"Integer vector length n, giving indices sampled candidates (rows candidates).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"function computes weighted Euclidean distance candidate target. k nearest neighbors (smallest distances) identified. Sampling modes: prob = FALSE k neighbors sampled equal probability (uniform) prob = TRUE, sampling = \"rank\" Probability = 1/rank, normalized.         Closest neighbor highest probability. prob = TRUE, sampling = \"distance\" Probability based Gaussian         kernel: exp(-distance^2 / (2 * bandwidth^2)) Sampling replacement. seed set, random seed temporarily changed restored exit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"","code":"set.seed(42) candidates <- matrix(rnorm(50), ncol = 2) target <- c(0, 0)  # Sample 1 index from 5 nearest neighbors, uniform probability knn_sample(candidates, target, k = 5, n = 1) #> [1] 21  # Sample 3 indices from 5 nearest neighbors, rank-weighted probability knn_sample(candidates, target, k = 5, n = 3, prob = TRUE, seed = 123) #> [1] 15  6 15  # Using feature weights (weight first dimension more heavily) knn_sample(candidates, target, k = 5, n = 2, weights = c(2, 1), seed = 10) #> [1] 17 10  # Distance-based sampling with custom bandwidth knn_sample(candidates, target, k = 10, n = 5, prob = TRUE,            sampling = \"distance\", bandwidth = 1.5) #> [1]  6  6 10  8  8"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":null,"dir":"Reference","previous_headings":"","what":"Log initial setup information — log_filtering_start","title":"Log initial setup information — log_filtering_start","text":"Internal helper. Displays general information start filtering.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log initial setup information — log_filtering_start","text":"","code":"log_filtering_start(   n_obs,   n_sim,   n_realizations,   sample_target,   relax_priority )"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log initial setup information — log_filtering_start","text":"n_obs Integer scalar. Number observations observed series. n_sim Integer scalar. Number years simulated series used windowing. n_realizations Integer scalar. Number candidate realizations. sample_target Integer scalar. Target number select. relax_priority Character vector. Relaxation priority vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log initial setup information — log_filtering_start","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":null,"dir":"Reference","previous_headings":"","what":"Log filter iteration details — log_filter_iteration","title":"Log filter iteration details — log_filter_iteration","text":"Internal helper. Prints iteration diagnostics compact table-like format.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log filter iteration details — log_filter_iteration","text":"","code":"log_filter_iteration(   iter,   passes,   pool,   n_total,   target,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars,   note = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log filter iteration details — log_filter_iteration","text":"iter Integer scalar. Iteration number. passes Named list logical vectors. Per-filter pass vectors. pool Integer vector. Pool indices passing active filters. n_total Integer scalar. Total number realizations. target Integer scalar. Target pool size. bounds Environment list bounds. tail_metrics List. Tail metrics used criteria display. wavelet_active Logical scalar. wavelet_pars List. Wavelet parameter list. note Optional character scalar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log filter iteration details — log_filter_iteration","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Log final filtering summary — log_final_summary","title":"Log final filtering summary — log_final_summary","text":"Internal helper. Displays final filtering results.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log final filtering summary — log_final_summary","text":"","code":"log_final_summary(pool_size, n_total, n_sampled, relaxation_level)"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log final filtering summary — log_final_summary","text":"pool_size Integer scalar. Final pool size. n_total Integer scalar. Total realizations. n_sampled Integer scalar. Number sampled. relaxation_level Character scalar. Selection mode / relaxation level reached.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log final filtering summary — log_final_summary","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_step.html","id":null,"dir":"Reference","previous_headings":"","what":"Log major step progress — log_step","title":"Log major step progress — log_step","text":"Internal helper. Displays progress message major computational steps.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_step.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log major step progress — log_step","text":"","code":"log_step(step_name, details = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_step.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log major step progress — log_step","text":"step_name Character scalar. Name step. details Optional character scalar. Details string.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_step.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log major step progress — log_step","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Next State in a First-Order Markov Chain — markov_next_state","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"Given previous state random number `u_rand`, function returns next state 3-state first-order Markov chain. transition probabilities state- index-specific.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"","code":"markov_next_state(state_prev, u_rand, idx, p00, p01, p10, p11, p20, p21)"},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"state_prev Integer. current (previous) state (0, 1, 2). u_rand Numeric. random number [0, 1] used sample next state. idx Integer. Index selecting transition probabilities (e.g., time step spatial location). p00 Numeric vector. Probability transition state 0 0. p01 Numeric vector. Probability transition state 0 1. p10 Numeric vector. Probability transition state 1 0. p11 Numeric vector. Probability transition state 1 1. p20 Numeric vector. Probability transition state 2 0. p21 Numeric vector. Probability transition state 2 1.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"Integer. next state (0, 1, 2).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"States typically defined : - 0: Dry - 1: Wet - 2: Extreme transition determined using cumulative probabilities transitions state 0 1. remaining probability assigned state 2.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"","code":"set.seed(123) u_rand <- runif(1) markov_next_state(   state_prev = 1,   u_rand = u_rand,   idx = 5,   p00 = rep(0.7, 10),   p01 = rep(0.2, 10),   p10 = rep(0.3, 10),   p11 = rep(0.4, 10),   p20 = rep(0.1, 10),   p21 = rep(0.3, 10) ) #> [1] 0"},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Returns positions within `day0_idx` specified state transition occurs, based wet/dry/extreme day thresholds.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"","code":"match_transition_positions(   state_from,   state_to,   prcp_vec,   day0_idx,   wet_threshold,   extreme_threshold )"},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"state_from Integer. current occurrence state (0 = dry, 1 = wet, 2 = extreme). state_to Integer. next occurrence state (0 = dry, 1 = wet, 2 = extreme). prcp_vec Numeric vector precipitation values. day0_idx Integer vector indices representing candidate \"day 0\" positions time series. wet_threshold Numeric. Threshold separating dry wet days. extreme_threshold Numeric. Threshold days considered extreme.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Integer vector positions within `day0_idx` transition `state_from` `state_to` occurs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Occurrence states defined : - 0: Dry day (precipitation <= wet_threshold) - 1: Wet day (precipitation > wet_threshold <= extreme_threshold) - 2: Extreme wet day (precipitation > extreme_threshold)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"","code":"prcp_vec <- c(0, 0, 5, 15, 30, 0, 2, 25, 40, 0) day0_idx <- 1:(length(prcp_vec) - 1) wet_threshold <- 1 extreme_threshold <- 20  match_transition_positions(0, 1, prcp_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 2 6 match_transition_positions(1, 2, prcp_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 4 7 match_transition_positions(2, 0, prcp_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 5 9"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Morlet Wavelet Parameters — morlet_parameters","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"Computes key parameters Morlet wavelets: Fourier factor (scale->period), cone--influence (COI) e-folding time, minimum degrees freedom.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"","code":"morlet_parameters(k0 = 6)"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"k0 Numeric scalar. Morlet nondimensional frequency (default: 6).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"Named numeric vector: fourier_factor, coi, dofmin.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":null,"dir":"Reference","previous_headings":"","what":"Morlet Wavelet in Fourier Domain — morlet_wavelet","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"Computes Morlet wavelet \"daughter\" Fourier space given scale. Normalization follows Torrence & Compo (1998).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"","code":"morlet_wavelet(k, scale, k0 = 6)"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"k Numeric vector. Angular frequencies FFT ordering. scale Numeric scalar. Wavelet scale (inverse frequency), must positive. k0 Numeric scalar. Morlet nondimensional frequency (default: 6).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"Numeric vector (complex). Morlet wavelet Fourier space.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"Normalizes numeric vector sum one, treating non-finite negative values zero. total mass zero cleaning, fallback distribution returned instead.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"","code":"normalize_probs(prob, fallback_prob = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"prob Numeric vector (unnormalized) probabilities weights. Non-finite values (NA, NaN, Inf) negative values set zero prior normalization. fallback_prob Optional numeric vector return prob zero total mass cleaning. NULL (default), uniform distribution length length(prob) returned.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"Numeric vector probabilities summing one. fallback used, returned vector either fallback_prob uniform distribution.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"helper intended internal use stochastic probabilistic workflows degenerate numerically unstable probability vectors may arise. function check fallback_prob sums one; assumed ensured caller.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"","code":"if (FALSE) { # \\dontrun{ prob <- c(0.2, NA, -0.1, 0.5) normalize_probs(prob)  normalize_probs(c(0, 0, 0))  normalize_probs(c(0, 0, 0), fallback_prob = c(0.7, 0.2, 0.1)) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":null,"dir":"Reference","previous_headings":"","what":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"Applies quantile mapping adjust daily precipitation time series reflect changes monthly mean variance, consistent climate change scenarios. method fits gamma distribution observed nonzero precipitation calendar month, modifies distribution's mean variance according supplied monthly/yearly change factors, maps original values new quantiles perturbed distribution. function designed climate stress-testing workflows impose user-specified changes mean variance daily precipitation data preserving realistic distributional characteristics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"","code":"perturb_prcp_qm(   prcp = NULL,   mean_factor = NULL,   var_factor = NULL,   month = NULL,   year = NULL,   fit_method = \"mme\",   min_events = 10,   validate_output = TRUE,   diagnostics = FALSE,   seed = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"prcp Numeric vector. Original daily precipitation values perturb (typically one grid cell). Must non-negative. mean_factor Numeric matrix mean change factors (multiplicative), dimension: `n_years` x 12 (year, month). entry scales year-month's mean. var_factor Numeric matrix variance change factors (multiplicative), dimension: `n_years` x 12 (year, month). entry scales year-month's variance. month Integer vector (length `prcp`). Calendar month day (1-12). year Integer vector (length `prcp`). Simulation year index day (1 = first year, etc). fit_method Character. Method fitting base gamma distribution; passed [fitdistrplus::fitdist()]. Default `\"mme\"` (method moments). min_events Integer. Minimum number non-zero precipitation events required per month distribution fitting. Default 10. validate_output Logical. TRUE, checks output NaN/Inf replaces diagnostics Logical. TRUE, return diagnostics information output. seed Integer. Optional random seed used diagnostics require stochastic elements. original values. Default TRUE. verbose Logical. TRUE, prints diagnostic messages months perturbed. Default FALSE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"Numeric vector, length `prcp`. Precipitation time series perturbed according quantile mapping procedure. Includes attributes: `perturbed_months`: Integer vector months successfully perturbed `skipped_months`: Integer vector months skipped due insufficient data `n_failed_fits`: Number distribution fits failed","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"## Distribution Fitting function fits gamma distribution non-zero precipitation calendar month. Months fewer `min_events` non-zero days skipped. gamma distribution parameterized shape scale parameters derived method moments maximum likelihood estimation. ## Quantile Mapping Procedure 1. Fit base gamma distribution observed non-zero precipitation month 2. Compute target distribution parameters scaling base mean variance 3. Map original prcp quantile base distribution 4. Transform quantile target distribution ## Limitations - Zero precipitation values remain zero (dry day frequency unchanged) - Requires sufficient non-zero events per month reliable fitting - Extrapolation beyond observed range may produce unrealistic extreme values - Change factors must positive; negative zero values cause errors","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/perturb_prcp_qm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Quantile Mapping for Climate Change Perturbation of Precipitation — perturb_prcp_qm","text":"","code":"if (FALSE) { # \\dontrun{ # Example: 2 years of daily data, 5% mean and 10% variance increase set.seed(123) n_days <- 730 year <- rep(1:2, each = 365) month_idx <- rep(rep(1:12, times = c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)), 2)[1:n_days] daily_precip <- rgamma(n_days, shape = 1, scale = 5)  mean_factor <- matrix(1.05, nrow = 2, ncol = 12) var_factor <- matrix(1.10, nrow = 2, ncol = 12)  perturbed_precip <- perturb_prcp_qm(   prcp = daily_precip,   mean_factor = mean_factor,   var_factor = var_factor,   month = month_idx,   year = year )  # Check which months were perturbed attr(perturbed_precip, \"perturbed_months\") attr(perturbed_precip, \"skipped_months\") } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot.prcp_qm_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot diagnostics for precipitation QM — plot.prcp_qm_diagnostics","title":"Plot diagnostics for precipitation QM — plot.prcp_qm_diagnostics","text":"Plots selected diagnostic panels \"prcp_qm_diagnostics\" object.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot.prcp_qm_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot diagnostics for precipitation QM — plot.prcp_qm_diagnostics","text":"","code":"# S3 method for class 'prcp_qm_diagnostics' plot(x, which = c(\"all\", \"moments\", \"quantiles\", \"extremes\", \"monthly\"), ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot.prcp_qm_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot diagnostics for precipitation QM — plot.prcp_qm_diagnostics","text":"x \"prcp_qm_diagnostics\" object. Character. plot return. ... Additional arguments passed plotting functions (unused).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot.prcp_qm_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot diagnostics for precipitation QM — plot.prcp_qm_diagnostics","text":"ggplot object single plot requested, list plots   = \"\" gridExtra unavailable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"Internal function used filter_warm_pool() create diagnostic plots. Shows time series, statistics scatter, wavelet GWS comparisons.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"","code":"plot_filter_diagnostics(   obs_series,   sim_series,   pool,   rel_diff_mean,   rel_diff_sd,   tail_metrics,   power_period,   power_obs,   power_signif,   gws_cache,   wavelet_q = c(0.05, 0.95) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"obs_series Numeric vector observed values sim_series Numeric matrix simulated values pool Integer vector pool indices rel_diff_mean Relative differences mean rel_diff_sd Relative differences SD tail_metrics Tail metrics list power_period Wavelet periods power_obs Observed GWS power_signif Significance curve gws_cache Cached GWS matrix (n_periods x n_realizations) wavelet_q Two quantiles ribbon (e.g., c(0.50, 0.95))","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"List ggplot objects (timeseries, stats, wavelet_gws)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"Plots global wavelet spectrum (time-averaged wavelet power period) observed series, together period-wise significance threshold. Optionally overlays ensemble mean simulated global spectra.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"","code":"plot_wavelet_global_spectrum(period, signif, obs_power, sim_power = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"period Numeric vector wavelet periods (scales), typically years (days). strictly increasing meaningful interpretation. signif Numeric vector length length(period) giving global-spectrum significance threshold period. obs_power Numeric vector length length(period) giving observed global wavelet spectrum. sim_power Optional numeric matrix simulated global spectra nrow(sim_power) == length(period) one column per simulation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"ggplot object.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"plot Identify dominant variability scales (peaks global power). Compare observed spectral structure simulated ensemble. Interpret variability relative significance threshold. Ensemble behavior sim_power provided, function adds ensemble mean solid line. function intentionally keeps default view simple; want ensemble envelope (e.g., min/max quantiles) add outside function.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"","code":"if (FALSE) { # \\dontrun{ p <- plot_wavelet_global_spectrum(   period   = w$period,   signif   = w$gws_signif,   obs_power = w$gws,   sim_power = w$gws_sim  # matrix: period x n_sim (optional) ) print(p) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"Produces two-panel diagnostic figure 1D time series wavelet analysis: (1) time-period wavelet power field (2) global wavelet spectrum (time-averaged power period) significance threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"","code":"plot_wavelet_power(   series,   time = NULL,   period,   power,   gws,   gws_signif,   coi,   signif_mask,   unit = \"mm\" )"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"series Numeric vector. time series used define time dimension (length must match number columns power). time Optional numeric vector length length(series) used x-axis. Must strictly increasing. NULL, uses seq_len(length(series)). period Numeric vector wavelet periods (scales), typically years (days), strictly increasing. power Numeric matrix wavelet power dimensions length(period) x length(series). gws Numeric vector. Global wavelet spectrum (mean power period). Must length length(period). gws_signif Numeric vector. Significance threshold gws. Must length length(period). coi Numeric vector length length(series) giving cone influence units period. Values outside plotted period range ignored. signif_mask Numeric matrix dimensions length(period) x length(series). contour drawn 1. typically significance ratio binary mask encoded 0/1 (NA). unit Character. Unit label used global spectrum axis label (default: \"mm\").","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"patchwork object combining power-field panel global spectrum panel.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"plot Identify specific periodicities active time (power field). Summarize dominant variability scales across full record (global spectrum). Check edge effects statistical significance (COI contour). Key plotting choices Power shown \\(\\log_2\\) scale discarding non-finite values   non-positive power. power field drawn native wavelet grid (interpolation) using   explicit cell boundaries, avoids smoothing artifacts. Color limits set using robust quantiles (5th-95th percentile) avoid   low-contrast fields dynamic range large. Inputs must consistent n_time = length(series) n_period = length(period). power signif_mask must dimensions   n_period x n_time. coi must length n_time. period must strictly increasing. supplied, time must strictly increasing length n_time.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"","code":"if (FALSE) { # \\dontrun{ # Assuming you computed wavelet outputs elsewhere: # w <- analyze_wavelet_spectrum(series) p <- plot_wavelet_power(   series      = series,   time        = years,   period      = w$period,   power       = w$power,   gws         = w$gws,   gws_signif  = w$gws_signif,   coi         = w$coi,   signif_mask = w$signif_mask,   unit        = \"mm\" ) print(p) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/print.prcp_qm_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Print precipitation QM diagnostics — print.prcp_qm_diagnostics","title":"Print precipitation QM diagnostics — print.prcp_qm_diagnostics","text":"Prints compact summary quantile-mapping diagnostics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/print.prcp_qm_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print precipitation QM diagnostics — print.prcp_qm_diagnostics","text":"","code":"# S3 method for class 'prcp_qm_diagnostics' print(x, ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/print.prcp_qm_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print precipitation QM diagnostics — print.prcp_qm_diagnostics","text":"x \"prcp_qm_diagnostics\" object. ... Additional arguments (unused).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/print.prcp_qm_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print precipitation QM diagnostics — print.prcp_qm_diagnostics","text":"Invisibly returns x.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Read NetCDF variables into tidy data frames — read_netcdf","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Reads one variables NetCDF file returns named list data.frames (one per variable). data.frame contains coordinate columns (e.g., lon/lat/time) plus single value column (optionally renamed).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"","code":"read_netcdf(   nc_path,   var = NULL,   var_name = NULL,   keep_leap_day = TRUE,   drop_all_na = TRUE,   spatial_ref = \"spatial_ref\",   signif_digits = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"nc_path Character. Path NetCDF file. var Character vector NULL. Variables read. NULL, reads non-coordinate variables (excludes `spatial_ref` present). var_name NULL, named character vector. - named: names original variable names values new names. Renaming applies output list names value-column name. keep_leap_day Logical. FALSE time convertible Date, removes Feb 29 rows. drop_all_na Logical. TRUE, drop variables whose values NA applying _FillValue/missing_value handling. spatial_ref Character. Name spatial reference variable ignore auto-selecting variables (common CF/CRS-encoded files). signif_digits Integer NULL. provided, rounds numeric values via signif(x, signif_digits). verbose Logical. TRUE, prints basic progress messages.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Named list data.frames.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Robust common NetCDF conventions avoids \"replacement N rows, data 0\" failure always building coordinate table correct length assigning values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Relax bounds for one filter — relax_bounds_one_filter","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"Applies one relaxation step single filter. Updates bounds place.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"","code":"relax_bounds_one_filter(   filter_name,   bounds_env,   wavelet_active_env,   recompute_tailmass_fn )"},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"filter_name Character. Name filter relax. bounds_env Environment containing bounds (snake_case keys). wavelet_active_env Environment containing wavelet_active flag. recompute_tailmass_fn Function recompute tail mass thresholds change.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"List changed (logical) msg (character).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"Resamples daily precipitation temperature sequences combining: annual K-nearest-neighbor (KNN) selection observed years, three-state Markov chain wet dry spell persistence, daily KNN resampling precipitation temperature anomalies. function supports calendar-year water-year simulations. regime inferred automatically `year_start_month`: `year_start_month == 1`, calendar-year logic used; otherwise, water-year logic assumed.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"","code":"resample_weather_dates(   sim_annual_prcp,   obs_annual_prcp,   obs_daily_prcp,   obs_daily_temp,   year_start,   realization_idx,   n_years,   obs_dates_df,   sim_dates_df,   year_start_month = 1,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   dry_spell_factor = rep(1, 12),   wet_spell_factor = rep(1, 12),   seed = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"sim_annual_prcp Numeric vector length `n_years`. Synthetic annual precipitation totals generated annual model (e.g., WARM), indexed simulated year. obs_annual_prcp Numeric vector. Observed annual precipitation totals corresponding historical water years. obs_daily_prcp Numeric vector. Observed daily precipitation values (leap days), aligned `obs_dates_df`. obs_daily_temp Numeric vector. Observed daily temperature values (leap days), aligned `obs_dates_df`. year_start Integer. First simulation year (calendar year `year_start_month == 1`, otherwise first water year). realization_idx Integer. Realization index, used perturb random seed multiple realizations independent. n_years Integer. Number simulated years. obs_dates_df Data frame containing observed date information. Must include columns `date`, `month`, `day`, `wyear`. sim_dates_df Data frame containing simulated date information (leap days). Must include columns `month`, `day`, `wyear`. year_start_month Integer 1:12. First month simulation year. Use 1 calendar-year simulations, another month water-year simulations. annual_knn_n Integer. Number historical years sampled annual KNN step. wet_q Numeric 0 1. Quantile used define wet threshold daily precipitation states. extreme_q Numeric 0 1. Quantile used define wet (extreme) precipitation threshold. dry_spell_factor Numeric vector length 12. Monthly adjustment factors controlling dry spell persistence Markov chain. wet_spell_factor Numeric vector length 12. Monthly adjustment factors controlling wet spell persistence Markov chain. seed Optional integer. Base random seed reproducibility.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"`Date` vector length equal `nrow(sim_dates_df)`, giving resampled observed dates corresponding simulated day.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"simulated year, subset observed water years selected using annual KNN matching `sim_annual_prcp`. Daily weather generated sequentially: first day simulated year sampled observed         days matching simulated month day. Subsequent days generated using Markov chain simulate         wet dry states. Conditional simulated state, candidate observed days         selected using calendar constraints expanded search windows. daily KNN step precipitation temperature anomalies         used select next-day weather values. calendar-year mode (`year_start_month == 1`), transitions cross December January explicitly excluded avoid cross-year contamination.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":null,"dir":"Reference","previous_headings":"","what":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"Simulates synthetic series modeling wavelet component ARIMA model, simulating component forward, summing across components. Optionally rescales simulated components match observed component variance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"","code":"simulate_warm(   components = NULL,   n = NULL,   n_sim = 1000,   seed = NULL,   match_variance = TRUE,   var_tol = 0.1,   check_diagnostics = FALSE,   verbose = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"components Matrix, data.frame, list numeric vectors. Wavelet components, typically produced extract_wavelet_components. n Integer. Length simulated series. n_sim Integer. Number realizations generate. seed Optional integer. Base RNG seed reproducibility. match_variance Logical. TRUE, rescales simulated component match observed component standard deviation. var_tol Numeric [0, 1]. Relative tolerance used trigger variance rescaling. check_diagnostics Logical. TRUE, runs simple ARIMA diagnostics warns issues. verbose Logical. TRUE, emits informational logs (via logger::log_info available).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"Numeric matrix dimension n x n_sim. column simulated realization.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.prcp_qm_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize precipitation QM diagnostics — summary.prcp_qm_diagnostics","title":"Summarize precipitation QM diagnostics — summary.prcp_qm_diagnostics","text":"Prints text summary \"prcp_qm_diagnostics\" object.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.prcp_qm_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize precipitation QM diagnostics — summary.prcp_qm_diagnostics","text":"","code":"# S3 method for class 'prcp_qm_diagnostics' summary(object, ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.prcp_qm_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize precipitation QM diagnostics — summary.prcp_qm_diagnostics","text":"object \"prcp_qm_diagnostics\" object. ... Additional arguments (unused).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.prcp_qm_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize precipitation QM diagnostics — summary.prcp_qm_diagnostics","text":"Invisibly returns object.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"Computes validation diagnostics comparing original adjusted precipitation series using metrics returned diagnose_prcp_qm.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"","code":"validate_quantile_mapping(   prcp_org,   prcp_adjusted,   month = NULL,   year = NULL,   mean_factor = NULL,   var_factor = NULL,   wet_thresh = 0.1,   probs = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"prcp_org Numeric vector. Original precipitation values. prcp_adjusted Numeric vector. Adjusted precipitation values (length prcp_org). month Integer vector (optional). Month index (1–12) observation. year Integer vector (optional). Year index (1..n_years) observation. mean_factor Numeric matrix (optional). Target mean scaling factors (n_years x 12). var_factor Numeric matrix (optional). Target variance scaling factors (n_years x 12). wet_thresh Numeric. Threshold defining wet days (default = 0.1 mm). probs Numeric vector. Quantile probabilities evaluate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"list class \"prcp_qm_diagnostics\" diagnostic tables   summary information (see diagnose_prcp_qm details).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"convenience wrapper around diagnose_prcp_qm argument names aligned quantile-mapping workflows.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"","code":"prcp_org <- c(0, 1, 2, 0, 5, 3) prcp_adjusted <- c(0, 1.1, 2.2, 0, 4.8, 3.1) month <- c(1, 1, 1, 1, 1, 1) year <- c(1, 1, 1, 1, 1, 1) validate_quantile_mapping(prcp_org, prcp_adjusted, month = month, year = year) #>  #> === Precipitation QM Diagnostics === #>  #> Overall Assessment: excellent  #> Overall Score: 83.2 / 100 #>  #> Component Scores: #>   moments: 20.0 #>   quantiles: 24.0 #>   extremes: 19.2 #>   spells: 10.0 #>   drydays: 10.0 #>  #> Key Findings: #>   Mean change: 1.8% #>   Variance change: -16.1% #>   Dry days preserved: TRUE #>   Extreme amplification: 0.96x #>  #> Moment Preservation: #>    metric original adjusted pct_change assessment #>      mean    2.750    2.800      1.818  excellent #>        sd    1.708    1.564     -8.411       good #>  variance    2.917    2.447    -16.114       poor #>        cv    0.621    0.559    -10.046       good #>  skewness    0.282    0.189    -32.943       poor #>  kurtosis   -1.962   -1.977      0.788       good #>  #> Dry/Wet Day Preservation: #>  category original adjusted assessment #>  dry_days        2        2    perfect #>  wet_days        4        4    perfect #>"},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"Writes gridded climate/weather time series NetCDF file using template NetCDF schema source (dimensions, spatial reference variable, global attributes).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"","code":"write_netcdf(   data = NULL,   grid = NULL,   out_dir = NULL,   origin_date = NULL,   calendar = \"noleap\",   template_path = NULL,   compression = 4,   spatial_ref = \"spatial_ref\",   file_prefix = \"clim_change_rlz\",   file_suffix = \"\",   signif_digits = NULL,   verbose = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"data List length nrow(grid). element named list numeric vectors (time series) variable written. list elements must identical variable names equal length. grid data.frame least xind yind integer indices mapping list element output grid cell. out_dir Character. Output directory. origin_date Character Date. Origin date used NetCDF time units (e.g., \"1970-01-01\"). calendar Character. NetCDF calendar type (e.g., \"noleap\"). template_path Character. Path template NetCDF file. compression Integer 0-9. NetCDF4 deflation level. spatial_ref Character. Spatial reference variable name template. file_prefix Character. Prefix output filename. file_suffix Character. Optional suffix appended filename. signif_digits Integer. NULL, round values many significant digits. verbose Logical. TRUE, emit progress logs via .log().","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"Invisibly returns written file path.","code":""}]
