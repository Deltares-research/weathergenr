[{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"purpose","dir":"Articles","previous_headings":"","what":"Purpose","title":"Climate Perturbations","text":"vignette demonstrates apply climate perturbations daily weather series using weathergenr. workflow modifies precipitation temperature controlled way reflect user-defined stress scenarios preserving realistic daily variability. useful hydrological stress testing, climate sensitivity analysis, impact modeling.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Climate Perturbations","text":"","code":"library(weathergenr) library(ggplot2)  ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\") ncdata <- read_netcdf(ncfile)"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"define-climate-scenario","dir":"Articles","previous_headings":"","what":"Define climate scenario","title":"Climate Perturbations","text":"define stress-test scenario representing drier warmer climate: 30% reduction mean precipitation +2 degrees Celsius temperature increase.","code":"obs_date <- ncdata$date obs_month <- as.integer(format(obs_date, \"%m\")) obs_year <- as.integer(format(obs_date, \"%Y\")) obs_year_idx <- obs_year - min(obs_year) + 1L n_years <- max(obs_year_idx)  # Monthly perturbation vectors (length 12) precip_mean_change <- rep(0.7, 12) precip_var_change <- rep(1.0, 12) temp_mean_change <- rep(2, 12)  # Expand to matrices (n_years x 12) for quantile mapping precip_mean_change_m <- matrix(precip_mean_change, nrow = n_years, ncol = 12, byrow = TRUE) precip_var_change_m <- matrix(precip_var_change, nrow = n_years, ncol = 12, byrow = TRUE)"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"preview-quantile-mapping","dir":"Articles","previous_headings":"","what":"Preview quantile mapping","title":"Climate Perturbations","text":"applying perturbations across grid cells, preview quantile-mapping diagnostics single cell verify target changes achieved.","code":"precip_qm <- adjust_precipitation_qm(   precip = ncdata$data[[1]]$precip,   mean_factor = precip_mean_change_m,   var_factor = precip_var_change_m,   scale_var_with_mean = TRUE,   exaggerate_extremes = FALSE,   enforce_target_mean = TRUE,   month = obs_month,   year = obs_year_idx,   min_events = 10,   validate_output = TRUE,   diagnostics = TRUE,   verbose = FALSE )  print(precip_qm$diagnostics) === Precipitation QM Diagnostics ===  Mean and variance changes:  Statistic Original Adjusted Target Achieved Error       Mean     7.64     5.35   -30%     -30%   +0%   Variance    87.85    32.48   -51%     -63%  -12%  Wet/dry day counts:  Category Original Adjusted Difference  Dry days      161      183         22  Wet days     7510     7488        -22  Percentiles (wet days):    Percentile Original Adjusted Change  P50 (Median)     5.62     4.03   -28%           P90    16.13    11.41   -29%           P95    20.52    14.55   -29%           P99    39.35    25.23   -36%  Extreme tails:              Tail Threshold change Mean change     Top 10% (P90)             -29%        -34%      Top 5% (P95)             -29%        -36%      Top 1% (P99)             -36%        -43%  Top 0.1% (P99.9)             -47%        -51%  Spell lengths:        Type Original (days) Adjusted (days) Change  Dry spells             1.3             1.3    +3%  Wet spells            60.6            54.7   -10%  Monthly mean changes:  Month Target Achieved Error    Jan   -30%     -30%   +0%    Feb   -30%     -30%   +0%    Mar   -30%     -30%   +0%    Apr   -30%     -30%   +0%    May   -30%     -30%   +0%    Jun   -30%     -30%   +0%    Jul   -30%     -30%   -0%    Aug   -30%     -30%   +0%    Sep   -30%     -30%   +0%    Oct   -30%     -30%   +0%    Nov   -30%     -30%   +0%    Dec   -30%     -30%   +0%"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"apply-climate-perturbations","dir":"Articles","previous_headings":"","what":"Apply climate perturbations","title":"Climate Perturbations","text":"apply_climate_perturbations() function processes grid cells. accepts list data frames (data), grid metadata (grid), date vector (date). Monthly perturbation factors control precipitation mean/variance scaling temperature shifts. diagnostic = TRUE, function returns perturbed data validation diagnostics. output contains data (list perturbed data frames) diagnostic (list per-grid validation objects, precipitation ).","code":"rlz_future <- apply_climate_perturbations(   data = ncdata$data,   grid = ncdata$grid,   date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   precip_occurrence_factor = NULL,   precip_intensity_threshold = 0,   temp_transient = TRUE,   precip_transient = TRUE,   precip_occurrence_transient = TRUE,   compute_pet = FALSE,   pet_method = \"hargreaves\",   qm_fit_method = \"mme\",   scale_var_with_mean = TRUE,   exaggerate_extremes = FALSE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   enforce_target_mean = TRUE,   precip_cap_mm_day = NULL,   precip_floor_mm_day = NULL,   precip_cap_quantile = NULL,   seed = 42,   diagnostic = TRUE,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"visualizations","dir":"Articles","previous_headings":"","what":"Visualizations","title":"Climate Perturbations","text":"","code":"obs_cell <- ncdata$data[[1]] sim_cell <- rlz_future$data[[1]]  obs_monthly <- tapply(obs_cell$precip, obs_month, mean, na.rm = TRUE) sim_monthly <- tapply(sim_cell$precip, obs_month, mean, na.rm = TRUE)  plot_data <- data.frame(   Month = factor(month.abb[1:12], levels = month.abb),   Observed = as.numeric(obs_monthly),   Perturbed = as.numeric(sim_monthly) ) plot_data_long <- tidyr::pivot_longer(   plot_data, cols = c(\"Observed\", \"Perturbed\"),   names_to = \"Series\", values_to = \"Precipitation\" )  ggplot(plot_data_long, aes(x = Month, y = Precipitation, fill = Series)) +   geom_col(position = \"dodge\", width = 0.7) +   scale_fill_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   labs(     title = \"Monthly Mean Precipitation\",     subtitle = \"Observed vs. perturbed (30% reduction scenario)\",     y = \"Precipitation (mm/day)\", x = NULL   ) +   theme_bw() +   theme(legend.position = \"bottom\") wet_obs <- obs_cell$precip[obs_cell$precip > 0] wet_sim <- sim_cell$precip[sim_cell$precip > 0]  dist_data <- data.frame(    Precipitation = c(wet_obs, wet_sim),   Series = factor(     c(rep(\"Observed\", length(wet_obs)), rep(\"Perturbed\", length(wet_sim))),     levels = c(\"Observed\", \"Perturbed\")   ) )  ggplot(dist_data, aes(x = Precipitation, color = Series, fill = Series)) +   geom_density(alpha = 0.3, linewidth = 1) +   scale_color_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   scale_fill_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   scale_x_continuous(limits = c(0, quantile(c(wet_obs, wet_sim), 0.98))) +   labs(     title = \"Wet-Day Precipitation Distribution\",     x = \"Precipitation (mm/day)\", y = \"Density\"   ) +   theme_bw() +   theme(legend.position = \"bottom\") plot_idx <- seq_len(nrow(obs_cell))  temp_ts <- data.frame(   Day = plot_idx,   Observed = obs_cell$temp[plot_idx],   Perturbed = sim_cell$temp[plot_idx] ) temp_ts_long <- tidyr::pivot_longer(   temp_ts, cols = c(\"Observed\", \"Perturbed\"),   names_to = \"Series\", values_to = \"Temperature\" )  ggplot(temp_ts_long, aes(x = Day, y = Temperature, color = Series)) +   geom_line(alpha = 0.7) +   scale_color_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   labs(     title = \"Daily Temperature Time Series\",     subtitle = \"Observed vs. +2 deg C shift scenario\",     x = \"Day\", y = \"Temperature (deg C)\"   ) +   theme_minimal() +   theme(legend.position = \"bottom\")"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"monthly-precipitation","dir":"Articles","previous_headings":"","what":"Monthly precipitation","title":"Climate Perturbations","text":"","code":"obs_cell <- ncdata$data[[1]] sim_cell <- rlz_future$data[[1]]  obs_monthly <- tapply(obs_cell$precip, obs_month, mean, na.rm = TRUE) sim_monthly <- tapply(sim_cell$precip, obs_month, mean, na.rm = TRUE)  plot_data <- data.frame(   Month = factor(month.abb[1:12], levels = month.abb),   Observed = as.numeric(obs_monthly),   Perturbed = as.numeric(sim_monthly) ) plot_data_long <- tidyr::pivot_longer(   plot_data, cols = c(\"Observed\", \"Perturbed\"),   names_to = \"Series\", values_to = \"Precipitation\" )  ggplot(plot_data_long, aes(x = Month, y = Precipitation, fill = Series)) +   geom_col(position = \"dodge\", width = 0.7) +   scale_fill_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   labs(     title = \"Monthly Mean Precipitation\",     subtitle = \"Observed vs. perturbed (30% reduction scenario)\",     y = \"Precipitation (mm/day)\", x = NULL   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"distribution-comparison","dir":"Articles","previous_headings":"","what":"Distribution comparison","title":"Climate Perturbations","text":"","code":"wet_obs <- obs_cell$precip[obs_cell$precip > 0] wet_sim <- sim_cell$precip[sim_cell$precip > 0]  dist_data <- data.frame(    Precipitation = c(wet_obs, wet_sim),   Series = factor(     c(rep(\"Observed\", length(wet_obs)), rep(\"Perturbed\", length(wet_sim))),     levels = c(\"Observed\", \"Perturbed\")   ) )  ggplot(dist_data, aes(x = Precipitation, color = Series, fill = Series)) +   geom_density(alpha = 0.3, linewidth = 1) +   scale_color_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   scale_fill_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   scale_x_continuous(limits = c(0, quantile(c(wet_obs, wet_sim), 0.98))) +   labs(     title = \"Wet-Day Precipitation Distribution\",     x = \"Precipitation (mm/day)\", y = \"Density\"   ) +   theme_bw() +   theme(legend.position = \"bottom\")"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"temperature-time-series","dir":"Articles","previous_headings":"","what":"Temperature time series","title":"Climate Perturbations","text":"","code":"plot_idx <- seq_len(nrow(obs_cell))  temp_ts <- data.frame(   Day = plot_idx,   Observed = obs_cell$temp[plot_idx],   Perturbed = sim_cell$temp[plot_idx] ) temp_ts_long <- tidyr::pivot_longer(   temp_ts, cols = c(\"Observed\", \"Perturbed\"),   names_to = \"Series\", values_to = \"Temperature\" )  ggplot(temp_ts_long, aes(x = Day, y = Temperature, color = Series)) +   geom_line(alpha = 0.7) +   scale_color_manual(values = c(Observed = \"steelblue\", Perturbed = \"coral\")) +   labs(     title = \"Daily Temperature Time Series\",     subtitle = \"Observed vs. +2 deg C shift scenario\",     x = \"Day\", y = \"Temperature (deg C)\"   ) +   theme_minimal() +   theme(legend.position = \"bottom\")"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"use-cases-and-extensions","dir":"Articles","previous_headings":"","what":"Use cases and extensions","title":"Climate Perturbations","text":"immediate perturbations instead transient ramps: modify wet-day frequency: propagate temperature changes PET: amplify upper-tail changes:","code":"rlz_step <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   temp_transient = FALSE,   precip_transient = FALSE,   diagnostic = TRUE ) occurrence_factor <- rep(1.0, 12) occurrence_factor[6:8] <- 0.8  # 20% fewer wet days in summer  rlz_dry_summer <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   precip_occurrence_factor = occurrence_factor,   temp_delta = temp_mean_change,   diagnostic = TRUE ) rlz_with_pet <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   compute_pet = TRUE,   pet_method = \"hargreaves\",   diagnostic = TRUE ) rlz_extreme <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   exaggerate_extremes = TRUE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"step-changes","dir":"Articles","previous_headings":"","what":"Step changes","title":"Climate Perturbations","text":"immediate perturbations instead transient ramps:","code":"rlz_step <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   temp_transient = FALSE,   precip_transient = FALSE,   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"occurrence-perturbations","dir":"Articles","previous_headings":"","what":"Occurrence perturbations","title":"Climate Perturbations","text":"modify wet-day frequency:","code":"occurrence_factor <- rep(1.0, 12) occurrence_factor[6:8] <- 0.8  # 20% fewer wet days in summer  rlz_dry_summer <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   precip_occurrence_factor = occurrence_factor,   temp_delta = temp_mean_change,   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"pet-recalculation","dir":"Articles","previous_headings":"","what":"PET recalculation","title":"Climate Perturbations","text":"propagate temperature changes PET:","code":"rlz_with_pet <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   compute_pet = TRUE,   pet_method = \"hargreaves\",   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"extreme-amplification","dir":"Articles","previous_headings":"","what":"Extreme amplification","title":"Climate Perturbations","text":"amplify upper-tail changes:","code":"rlz_extreme <- apply_climate_perturbations(   data = ncdata$data, grid = ncdata$grid, date = ncdata$date,   precip_mean_factor = precip_mean_change,   precip_var_factor = precip_var_change,   temp_delta = temp_mean_change,   exaggerate_extremes = TRUE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/climate_perturbation.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Climate Perturbations","text":"","code":"sessionInfo() R version 4.5.2 (2025-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 Running under: Windows 11 x64 (build 26200)  Matrix products: default   LAPACK version 3.12.1  locale: [1] LC_COLLATE=English_United States.utf8  [2] LC_CTYPE=English_United States.utf8    [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C                           [5] LC_TIME=English_United States.utf8      time zone: Europe/Amsterdam tzcode source: internal  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages: [1] ggplot2_4.0.1     weathergenr_1.0.1  loaded via a namespace (and not attached):  [1] generics_0.1.4     tidyr_1.3.2        class_7.3-23       lattice_0.22-7      [5] digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5     grid_4.5.2          [9] RColorBrewer_1.1-3 iterators_1.0.14   fastmap_1.2.0      Matrix_1.7-4       [13] foreach_1.5.2      jsonlite_2.0.0     e1071_1.7-17       nnet_7.3-20        [17] survival_3.8-6     forecast_9.0.0     purrr_1.2.1        scales_1.4.0       [21] codetools_0.2-20   cli_3.6.5          rlang_1.1.7        splines_4.5.2      [25] withr_3.0.2        yaml_2.3.12        otel_0.2.0         tools_4.5.2        [29] parallel_4.5.2     dplyr_1.1.4        ncdf4_1.24         colorspace_2.1-2   [33] fitdistrplus_1.2-4 curl_7.0.0         vctrs_0.6.5        R6_2.6.1           [37] zoo_1.8-15         proxy_0.4-29       lifecycle_1.0.5    tseries_0.10-59    [41] MASS_7.3-65        urca_1.3-4         pkgconfig_2.0.3    pillar_1.11.1      [45] gtable_0.3.6       quantmod_0.4.28    glue_1.8.0         Rcpp_1.1.1         [49] xfun_0.55          tibble_3.3.1       lmtest_0.9-40      tidyselect_1.2.1   [53] rstudioapi_0.18.0  knitr_1.51         farver_2.1.2       nlme_3.1-168       [57] htmltools_0.5.9    patchwork_1.3.2    labeling_0.4.3     xts_0.14.1         [61] rmarkdown_2.30     timeDate_4051.111  fracdiff_1.5-3     compiler_4.5.2     [65] quadprog_1.5-8     S7_0.2.1           TTR_0.24.4"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with weathergenr","text":"weathergenr package provides comprehensive toolkit stochastic weather generation climate data analysis. implements sophisticated statistical methods create synthetic daily weather series preserve statistical properties observed climate data enabling scenario-based climate impact assessments. vignette demonstrates core workflow: Reading gridded meteorological data NetCDF files Generating synthetic weather realizations using coupled statistical methods Evaluating quality synthetic weather historical observations Related functions [read_netcdf()] [generate_weather()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [analyze_wavelet_spectrum()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"load-required-packages","dir":"Articles","previous_headings":"","what":"Load Required Packages","title":"Getting Started with weathergenr","text":"Related functions [read_netcdf()] [generate_weather()] [evaluate_weather_generator()] [write_netcdf()] [apply_climate_perturbations()] [analyze_wavelet_spectrum()]","code":"library(weathergenr) library(dplyr) library(ggplot2)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"reading-gridded-multivariate-weather-data","dir":"Articles","previous_headings":"","what":"Reading Gridded Multivariate Weather Data","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution. {width=“65%”, fig-align=“left”} read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6  3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5  2     2     2     1      9.75      0.5  3     3     3     1     10         0.5  4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"about-the-example-dataset","dir":"Articles","previous_headings":"","what":"About the Example Dataset","title":"Getting Started with weathergenr","text":"tutorial, use ERA5 dataset (ECMWF Reanalysis v5) included package. data covers Ntoum Basin Gabon, tropical watershed West Central Africa. dataset includes daily precipitation, mean temperature, minimum temperature, maximum temperature 0.25-degree spatial resolution. {width=“65%”, fig-align=“left”}","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"loading-netcdf-data","dir":"Articles","previous_headings":"","what":"Loading NetCDF Data","title":"Getting Started with weathergenr","text":"read_netcdf() function provides efficient interface extracting meteorological data NetCDF files. handles complexities NetCDF format returns data tidy, analysis-ready structure optimized weathergenr workflow. function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation. read_netcdf() function supports several optional parameters customized data loading:","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile) # Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6  3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5  2     2     2     1      9.75      0.5  3     3     3     1     10         0.5  4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\" # Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"key-features","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Key Features","title":"Getting Started with weathergenr","text":"function performs several important operations: Extracts spatial coordinates temporal information Organizes data per-grid-cell time series Handles calendar systems including leap day management Provides variable renaming capabilities Optionally drops variables missing values reduce memory usage","code":"# Locate the example NetCDF file ncfile <- system.file(\"extdata\", \"ntoum_era5_data.nc\", package = \"weathergenr\")  # Read the NetCDF file with default settings ncdata <- read_netcdf(ncfile)"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-the-output-structure","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Understanding the Output Structure","title":"Getting Started with weathergenr","text":"read_netcdf() function returns list five components organize different aspects climate data: data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint. grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates) date element contains complete time axis vector Date objects: dimensions element stores raw dimension vectors NetCDF file: attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":"# Display the top-level structure names(ncdata) [1] \"data\"       \"grid\"       \"date\"       \"dimensions\" \"attributes\" # Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6  3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35 # View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5  2     2     2     1      9.75      0.5  3     3     3     1     10         0.5  4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25 # Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671 # View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"time-series-data","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"1. Time Series Data","title":"Getting Started with weathergenr","text":"data element contains list data frames, one grid cell. data frame represents daily time series columns meteorological variable: structure allows efficient access complete time series individual locations maintaining compact memory footprint.","code":"# Examine the first grid cell's time series head(ncdata$data[[1]]) # A tibble: 6 × 7   press_msl   kin temp_min temp_max  temp  kout precip       <dbl> <dbl>    <dbl>    <dbl> <dbl> <dbl>  <dbl> 1     1008.  174.     24.4     28.1  25.9  410.   9.12 2     1008.  162.     23.7     28.1  24.9  410.  15.6  3     1008.  201.     23.6     27.9  25.6  411.   4.84 4     1008.  177.     25.0     28.3  26.1  411.   5.20 5     1007.  218.     24.6     28.1  26.1  411.   1.54 6     1007.  199.     25.0     28.2  26.3  411.   8.35"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spatial-grid-information","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"2. Spatial Grid Information","title":"Getting Started with weathergenr","text":"grid element provides spatial metadata grid cell: row describes grid cell : id: Sequential identifier grid cell xind, yind: Array indices original NetCDF file x, y: Spatial coordinates (longitude/latitude projected coordinates)","code":"# View grid metadata head(ncdata$grid) # A tibble: 6 × 5      id  xind  yind         x         y   <int> <int> <int> <dbl[1d]> <dbl[1d]> 1     1     1     1      9.5       0.5  2     2     2     1      9.75      0.5  3     3     3     1     10         0.5  4     4     1     2      9.5       0.25 5     5     2     2      9.75      0.25 6     6     3     2     10         0.25"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"temporal-information","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"3. Temporal Information","title":"Getting Started with weathergenr","text":"date element contains complete time axis vector Date objects:","code":"# Display the first and last few dates head(ncdata$date) [1] \"2000-01-01\" \"2000-01-02\" \"2000-01-03\" \"2000-01-04\" \"2000-01-05\" [6] \"2000-01-06\" tail(ncdata$date) [1] \"2020-12-26\" \"2020-12-27\" \"2020-12-28\" \"2020-12-29\" \"2020-12-30\" [6] \"2020-12-31\" # Confirm the total number of days length(ncdata$date) [1] 7671"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"dimension-vectors","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"4. Dimension Vectors","title":"Getting Started with weathergenr","text":"dimensions element stores raw dimension vectors NetCDF file:","code":"# View available dimensions names(ncdata$dimensions) [1] \"longitude\" \"latitude\"  \"time\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"metadata-attributes","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"5. Metadata Attributes","title":"Getting Started with weathergenr","text":"attributes element preserves variable attributes, spatial reference information, global metadata NetCDF file, ensuring traceability documentation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"advanced-usage","dir":"Articles","previous_headings":"Reading Gridded Multivariate Weather Data","what":"Advanced Usage","title":"Getting Started with weathergenr","text":"read_netcdf() function supports several optional parameters customized data loading:","code":"# Example: Load specific variables and rename them ncdata <- read_netcdf(   nc_path = ncfile,   var = c(\"precip\", \"temp\"),   var_name = c(precip = \"precipitation\", temp = \"temperature\") )  # Example: Handle 365-day calendar data (no leap days) ncdata <- read_netcdf(   nc_path = ncfile,   keep_leap_day = FALSE )  # Example: Round values to reduce precision and memory ncdata <- read_netcdf(   nc_path = ncfile,   signif_digits = 4,   drop_all_na = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"generating-stochastic-weather-realizations","dir":"Articles","previous_headings":"","what":"Generating Stochastic Weather Realizations","title":"Getting Started with weathergenr","text":"generate_weather() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013). First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile) function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Create a temporary directory for outputs output_dir <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3 # Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather(   obs_data = ncdata$data,   obs_grid = ncdata$grid,   obs_dates = ncdata$date,   vars = variables,   n_years = 20,   start_year = 2020,   year_start_month = 1,   n_realizations = realization_num,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 10000,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   out_dir = output_dir,   seed = seed,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2016-01-02\" \"2016-01-01\" \"2016-01-02\" \"2016-01-03\" [6] \"2016-01-04\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3         <date>     <date>     <date>      1 2016-01-01 2018-01-01 2011-01-01  2 2016-01-02 2018-01-03 2011-01-03  3 2016-01-01 2002-01-01 2011-01-07  4 2016-01-02 2002-01-02 2011-01-08  5 2016-01-03 2002-01-03 2011-01-05  6 2016-01-04 2002-01-07 2011-01-06  7 2006-01-07 2002-12-31 2011-01-07  8 2015-01-09 2000-01-06 2011-01-10  9 2015-01-07 2000-01-07 2011-01-13 10 2011-01-09 2000-01-08 2011-01-09 # ℹ 7,290 more rows # Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"overview-of-the-weather-generation-method","dir":"Articles","previous_headings":"","what":"Overview of the Weather Generation Method","title":"Getting Started with weathergenr","text":"generate_weather() function implements sophisticated multi-scale weather generation framework combines several statistical methods: Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"statistical-components","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Statistical Components","title":"Getting Started with weathergenr","text":"Wavelet Autoregressive Modeling (WARM): Captures low-frequency (annual multi-year) climate variability decomposing annual precipitation signals wavelet components simulating temporal evolution using ARIMA models. Markov Chain Model: Controls persistence wet dry spells daily scale modeling transitions three precipitation states (dry, wet, extreme) monthly-varying transition probabilities. K-Nearest Neighbors (KNN) Resampling: Selects historical analogue years based similarity annual precipitation patterns resamples daily weather sequences analogues preserving spatial temporal correlations. coupled approach ensures synthetic weather series preserve : Temporal structure: Day--day persistence, seasonal cycles, interannual variability Spatial coherence: Correlations grid cells co-occurrence patterns weather events Statistical properties: Means, variances, extremes, distributional characteristics method described detail Steinschneider Brown (2013).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"setting-up-the-simulation","dir":"Articles","previous_headings":"","what":"Setting Up the Simulation","title":"Getting Started with weathergenr","text":"First, define output directory specify meteorological variables simulate: Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile)","code":"# Create a temporary directory for outputs output_dir <- tempdir()  # Define variables to simulate variables <- c(\"precip\", \"temp\", \"temp_min\", \"temp_max\")  # Labels for plotting (optional) variable_labels <- c(\"Precipitation\", \"Temperature (mean)\",                       \"Temperature (min)\", \"Temperature (max)\")  # Number of stochastic realizations to generate realization_num <- 3"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-simulation-parameters","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Understanding Simulation Parameters","title":"Getting Started with weathergenr","text":"Key parameters control different aspects weather generation: Temporal scope: n_years start_year define simulation period Realization count: n_realizations specifies many independent synthetic series create warm_var: primary driver variable (typically precipitation) warm_signif: Significance threshold retaining wavelet components (0.90 = 90% confidence) warm_pool_size: Number candidate annual traces generate filtering annual_knn_n: Number historical analogue years consider wet_q: Threshold wet day classification (0.3 = 30th percentile) extreme_q: Threshold extreme precipitation (0.8 = 80th percentile)","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"running-the-weather-generator","dir":"Articles","previous_headings":"","what":"Running the Weather Generator","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded) resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Set a seed for reproducibility seed <- 123  # Generate synthetic weather series stochastic_weather <- generate_weather(   obs_data = ncdata$data,   obs_grid = ncdata$grid,   obs_dates = ncdata$date,   vars = variables,   n_years = 20,   start_year = 2020,   year_start_month = 1,   n_realizations = realization_num,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 10000,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   out_dir = output_dir,   seed = seed,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE ) # View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2016-01-02\" \"2016-01-01\" \"2016-01-02\" \"2016-01-03\" [6] \"2016-01-04\" # Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3         <date>     <date>     <date>      1 2016-01-01 2018-01-01 2011-01-01  2 2016-01-02 2018-01-03 2011-01-03  3 2016-01-01 2002-01-01 2011-01-07  4 2016-01-02 2002-01-02 2011-01-08  5 2016-01-03 2002-01-03 2011-01-05  6 2016-01-04 2002-01-07 2011-01-06  7 2006-01-07 2002-12-31 2011-01-07  8 2015-01-09 2000-01-06 2011-01-10  9 2015-01-07 2000-01-07 2011-01-13 10 2011-01-09 2000-01-08 2011-01-09 # ℹ 7,290 more rows"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-the-output","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Understanding the Output","title":"Getting Started with weathergenr","text":"function returns list containing: resampled: historical dates selected analogues simulation day dates: simulated daily time axis (always 365-day calendar, Feb 29 excluded)","code":"# View the structure of the output names(stochastic_weather) [1] \"resampled\" \"dates\" # Check the simulated date range head(stochastic_weather$dates) [1] \"2020-01-01\" \"2020-01-02\" \"2020-01-03\" \"2020-01-04\" \"2020-01-05\" [6] \"2020-01-06\" tail(stochastic_weather$dates) [1] \"2039-12-26\" \"2039-12-27\" \"2039-12-28\" \"2039-12-29\" \"2039-12-30\" [6] \"2039-12-31\" # Examine resampled dates for the first realization head(stochastic_weather$resampled[[1]]) [1] \"2016-01-01\" \"2016-01-02\" \"2016-01-01\" \"2016-01-02\" \"2016-01-03\" [6] \"2016-01-04\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"interpreting-resampled-dates","dir":"Articles","previous_headings":"Generating Stochastic Weather Realizations","what":"Interpreting Resampled Dates","title":"Getting Started with weathergenr","text":"resampled dates show historical days selected analogues. information reveals: Whether generator drawing wet dry historical periods diversity historical conditions sampled Temporal clustering patterns resampling scheme","code":"# Display resampled dates for all realizations stochastic_weather$resampled # A tibble: 7,300 × 3    rlz_1      rlz_2      rlz_3         <date>     <date>     <date>      1 2016-01-01 2018-01-01 2011-01-01  2 2016-01-02 2018-01-03 2011-01-03  3 2016-01-01 2002-01-01 2011-01-07  4 2016-01-02 2002-01-02 2011-01-08  5 2016-01-03 2002-01-03 2011-01-05  6 2016-01-04 2002-01-07 2011-01-06  7 2006-01-07 2002-12-31 2011-01-07  8 2015-01-09 2000-01-06 2011-01-10  9 2015-01-07 2000-01-07 2011-01-13 10 2011-01-09 2000-01-08 2011-01-09 # ℹ 7,290 more rows"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"extracting-synthetic-weather-data","dir":"Articles","previous_headings":"","what":"Extracting Synthetic Weather Data","title":"Getting Started with weathergenr","text":"access actual weather values (just resampled dates), need extract corresponding data historical record:","code":"# Example: Extract synthetic weather for all realizations synthetic_data <- list()  for (i in 1:realization_num) {   # Get the day order for this realization   day_order <- match(stochastic_weather$resampled[[i]], ncdata$date)      # Extract corresponding weather data for each grid cell   synthetic_data[[i]] <- lapply(ncdata$data, function(cell_data) {     cell_data[day_order, variables] %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"evaluating-synthetic-weather-series","dir":"Articles","previous_headings":"","what":"Evaluating Synthetic Weather Series","title":"Getting Started with weathergenr","text":"Validating weather generator’s performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions. evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).              Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) }) # Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily_sim = rlz_sample,   daily_obs = obs_sample,   variables = variables,   variable_labels = variable_labels,   n_realizations = realization_num,   wet_quantile = 0.3,   extreme_quantile = 0.8,   output_dir = NULL,   save_plots = FALSE ) # Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\"               attr(,\"fit_summary\") # A tibble: 3 × 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 3         1         0.345            2.65          17.0              19.2 2 2         2         0.522            2.67          17.0              19.2 3 1         3         0.643            2.66          17.0              19.2 # ℹ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$n_realizations [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment_date [1] \"2026-01-21\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"purpose-of-evaluation","dir":"Articles","previous_headings":"","what":"Purpose of Evaluation","title":"Getting Started with weathergenr","text":"Validating weather generator’s performance crucial ensure synthetic weather series suitable impact modeling. evaluate_weather_generator() function provides comprehensive diagnostic comparisons simulated observed weather across multiple statistical dimensions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"preparing-data-for-evaluation","dir":"Articles","previous_headings":"","what":"Preparing Data for Evaluation","title":"Getting Started with weathergenr","text":"evaluation function requires: Observed weather data list format (one element per grid cell) Simulated weather data structured similarly Matching date columns datasets","code":"# Create day order indices for each realization day_order <- sapply(   1:realization_num,   function(n) match(stochastic_weather$resampled[[n]], ncdata$date) )  # Extract synthetic weather samples rlz_sample <- list() for (n in 1:realization_num) {   rlz_sample[[n]] <- lapply(ncdata$data[ncdata$grid$id], function(x) {     x[day_order[, n], ] %>%       select(precip, temp, temp_min, temp_max) %>%       mutate(date = stochastic_weather$dates, .before = 1)   }) }  # Prepare observed data obs_sample <- lapply(ncdata$data[ncdata$grid$id], function(x) {   x %>%     select(precip, temp, temp_min, temp_max) %>%     mutate(date = ncdata$date, .before = 1) })"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"running-the-evaluation","dir":"Articles","previous_headings":"","what":"Running the Evaluation","title":"Getting Started with weathergenr","text":"","code":"# Evaluate weather generator performance evaluation_plots <- evaluate_weather_generator(   daily_sim = rlz_sample,   daily_obs = obs_sample,   variables = variables,   variable_labels = variable_labels,   n_realizations = realization_num,   wet_quantile = 0.3,   extreme_quantile = 0.8,   output_dir = NULL,   save_plots = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"understanding-evaluation-metrics","dir":"Articles","previous_headings":"","what":"Understanding Evaluation Metrics","title":"Getting Started with weathergenr","text":"evaluation function computes visualizes several key aspects weather generator performance: Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather. precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns. Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns. Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"daily-statistics","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"1. Daily Statistics","title":"Getting Started with weathergenr","text":"Comparison mean, standard deviation, skewness variable across grid cells. assesses whether generator preserves central tendency, variability, distributional shape observed weather.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"wet-and-dry-day-frequencies","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"2. Wet and Dry Day Frequencies","title":"Getting Started with weathergenr","text":"precipitation, evaluation examines: Total number wet days (wet threshold) Number extreme precipitation days (extreme threshold) Dry day frequencies metrics reveal whether generator correctly reproduces precipitation occurrence patterns.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spell-length-distributions","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"3. Spell Length Distributions","title":"Getting Started with weathergenr","text":"Analysis consecutive wet dry periods: Mean wet spell length Mean dry spell length Distribution spell durations assesses generator’s ability capture persistence weather patterns.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"spatial-correlations","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"4. Spatial Correlations","title":"Getting Started with weathergenr","text":"Inter-site correlation matrices variable, comparing observed versus simulated spatial coherence. critical applications requiring realistic spatial patterns (e.g., regional hydrology).","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"viewing-evaluation-results","dir":"Articles","previous_headings":"","what":"Viewing Evaluation Results","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":"# Display all diagnostic plots evaluation_plots $daily_mean $daily_sd $spell_length $wetdry_days_count $crossgrid $intergrid $precip_cond_cor $annual_pattern_precip $annual_pattern_temp $annual_pattern_temp_min $annual_pattern_temp_max $monthly_cycle $annual_precip attr(,\"class\") [1] \"weather_assessment\" \"list\"               attr(,\"fit_summary\") # A tibble: 3 × 17   rlz    rank overall_score mae_mean_precip mae_mean_temp mae_mean_temp_max   <chr> <int>         <dbl>           <dbl>         <dbl>             <dbl> 1 3         1         0.345            2.65          17.0              19.2 2 2         2         0.522            2.67          17.0              19.2 3 1         3         0.643            2.66          17.0              19.2 # ℹ 11 more variables: mae_mean_temp_min <dbl>, mae_sd_precip <dbl>, #   mae_sd_temp <dbl>, mae_sd_temp_max <dbl>, mae_sd_temp_min <dbl>, #   mae_days_Dry <dbl>, mae_days_Wet <dbl>, mae_spell_Dry <dbl>, #   mae_spell_Wet <dbl>, mae_cor_crossgrid <dbl>, mae_cor_intervariable <dbl> attr(,\"metadata\") attr(,\"metadata\")$n_grids [1] 6  attr(,\"metadata\")$n_realizations [1] 3  attr(,\"metadata\")$variables [1] \"precip\"   \"temp\"     \"temp_min\" \"temp_max\"  attr(,\"metadata\")$assessment_date [1] \"2026-01-21\""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"interpreting-the-plots","dir":"Articles","previous_headings":"Evaluating Synthetic Weather Series","what":"Interpreting the Plots","title":"Getting Started with weathergenr","text":"Good weather generator performance indicated : Scatter plots near 1:1 line: Simulated statistics closely match observed values Overlapping distributions: Similar shapes ranges observed simulated Consistent correlation patterns: Spatial correlations preserved synthetic data Balanced residuals: systematic bias direction Discrepancies may indicate: Parameter tuning needed - adjust WARM Markov chain thresholds Insufficient historical analogue pool - increase KNN sample size Structural limitations specific climate regimes","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"other-features","dir":"Articles","previous_headings":"","what":"Other Features","title":"Getting Started with weathergenr","text":"weathergenr package supports additional capabilities covered basic tutorial: Use apply_climate_perturbations() modify synthetic weather based climate change scenarios: Explore low-frequency climate variability using wavelet transforms: large spatial domains, enable parallel processing accelerate computation: Results can written back NetCDF format use tools:","code":"# Example: Apply temperature increase and precipitation changes grid_with_lat <- ncdata$grid grid_with_lat$lat <- grid_with_lat$y  perturbed_weather <- apply_climate_perturbations(   data = synthetic_data[[1]],   grid = grid_with_lat,   date = stochastic_weather$dates,   precip_mean_factor = rep(1.1, 12),   precip_var_factor = rep(1.0, 12),   temp_delta = rep(2.0, 12),   temp_transient = FALSE,   precip_transient = FALSE,   compute_pet = FALSE ) # Analyze spectral characteristics of annual precipitation wavelet_results <- analyze_wavelet_spectrum(   series = annual_precip,   signif = 0.90,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = \"fast\" ) # Generate weather using multiple cores stochastic_weather <- generate_weather(   # ... other parameters ...   parallel = TRUE,   n_cores = 4 ) # Example: Write synthetic weather to NetCDF data_to_write <- lapply(synthetic_data[[1]], function(df) {   as.list(df[variables]) })  write_netcdf(   data = data_to_write,   grid = ncdata$grid,   out_dir = output_dir,   origin_date = stochastic_weather$dates[1],   calendar = \"noleap\",   template_path = ncfile,   file_prefix = \"synthetic_weather\",   file_suffix = \"rlz1\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"climate-scenario-analysis","dir":"Articles","previous_headings":"","what":"Climate Scenario Analysis","title":"Getting Started with weathergenr","text":"Use apply_climate_perturbations() modify synthetic weather based climate change scenarios:","code":"# Example: Apply temperature increase and precipitation changes grid_with_lat <- ncdata$grid grid_with_lat$lat <- grid_with_lat$y  perturbed_weather <- apply_climate_perturbations(   data = synthetic_data[[1]],   grid = grid_with_lat,   date = stochastic_weather$dates,   precip_mean_factor = rep(1.1, 12),   precip_var_factor = rep(1.0, 12),   temp_delta = rep(2.0, 12),   temp_transient = FALSE,   precip_transient = FALSE,   compute_pet = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"wavelet-spectral-analysis","dir":"Articles","previous_headings":"","what":"Wavelet Spectral Analysis","title":"Getting Started with weathergenr","text":"Explore low-frequency climate variability using wavelet transforms:","code":"# Analyze spectral characteristics of annual precipitation wavelet_results <- analyze_wavelet_spectrum(   series = annual_precip,   signif = 0.90,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = \"fast\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"parallel-computing","dir":"Articles","previous_headings":"","what":"Parallel Computing","title":"Getting Started with weathergenr","text":"large spatial domains, enable parallel processing accelerate computation:","code":"# Generate weather using multiple cores stochastic_weather <- generate_weather(   # ... other parameters ...   parallel = TRUE,   n_cores = 4 )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"saving-and-exporting-results","dir":"Articles","previous_headings":"","what":"Saving and Exporting Results","title":"Getting Started with weathergenr","text":"Results can written back NetCDF format use tools:","code":"# Example: Write synthetic weather to NetCDF data_to_write <- lapply(synthetic_data[[1]], function(df) {   as.list(df[variables]) })  write_netcdf(   data = data_to_write,   grid = ncdata$grid,   out_dir = output_dir,   origin_date = stochastic_weather$dates[1],   calendar = \"noleap\",   template_path = ncfile,   file_prefix = \"synthetic_weather\",   file_suffix = \"rlz1\" )"},{"path":"https://deltares-research.github.io/weathergenr/articles/getting_started.html","id":"further-reading","dir":"Articles","previous_headings":"","what":"Further Reading","title":"Getting Started with weathergenr","text":"Methodological details: See Steinschneider Brown (2013) theoretical foundation Package documentation: Use ?function_name access detailed help function Session Information","code":"R version 4.5.2 (2025-10-31 ucrt) Platform: x86_64-w64-mingw32/x64 Running under: Windows 11 x64 (build 26200)  Matrix products: default   LAPACK version 3.12.1  locale: [1] LC_COLLATE=English_United States.utf8  [2] LC_CTYPE=English_United States.utf8    [3] LC_MONETARY=English_United States.utf8 [4] LC_NUMERIC=C                           [5] LC_TIME=English_United States.utf8      time zone: Europe/Amsterdam tzcode source: internal  attached base packages: [1] stats     graphics  grDevices utils     datasets  methods   base       other attached packages: [1] ggplot2_4.0.1     dplyr_1.1.4       weathergenr_1.0.1  loaded via a namespace (and not attached):  [1] utf8_1.2.6         generics_0.1.4     tidyr_1.3.2        class_7.3-23        [5] lattice_0.22-7     digest_0.6.39      magrittr_2.0.4     evaluate_1.0.5      [9] grid_4.5.2         RColorBrewer_1.1-3 iterators_1.0.14   fastmap_1.2.0      [13] foreach_1.5.2      jsonlite_2.0.0     e1071_1.7-17       nnet_7.3-20        [17] forecast_9.0.0     purrr_1.2.1        viridisLite_0.4.2  scales_1.4.0       [21] isoband_0.3.0      textshaping_1.0.4  codetools_0.2-20   cli_3.6.5          [25] rlang_1.1.7        withr_3.0.2        yaml_2.3.12        otel_0.2.0         [29] tools_4.5.2        parallel_4.5.2     ncdf4_1.24         colorspace_2.1-2   [33] curl_7.0.0         vctrs_0.6.5        R6_2.6.1           zoo_1.8-15         [37] proxy_0.4-29       lifecycle_1.0.5    tseries_0.10-59    ragg_1.5.0         [41] urca_1.3-4         pkgconfig_2.0.3    pillar_1.11.1      gtable_0.3.6       [45] quantmod_0.4.28    glue_1.8.0         Rcpp_1.1.1         systemfonts_1.3.1  [49] xfun_0.55          tibble_3.3.1       lmtest_0.9-40      tidyselect_1.2.1   [53] rstudioapi_0.18.0  knitr_1.51         farver_2.1.2       nlme_3.1-168       [57] htmltools_0.5.9    patchwork_1.3.2    labeling_0.4.3     xts_0.14.1         [61] rmarkdown_2.30     timeDate_4051.111  fracdiff_1.5-3     compiler_4.5.2     [65] quadprog_1.5-8     S7_0.2.1           TTR_0.24.4"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"Running from Python","text":"vignette demonstrates run weathergenr R package Python environment using rpy2. workflow designed portable across machines operating systems avoids hard-coded, user-specific paths. recommended sequence : Install R make discoverable. Create Python environment rpy2. Configure minimal environment variables (R_HOME, PATH). Install call weathergenr Python.","code":""},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"prerequisites","dir":"Articles","previous_headings":"","what":"Prerequisites","title":"Running from Python","text":"Install latest version R CRAN verify available command line: Avoid setting PYTHONHOME PYTHONPATH unless debugging misconfigured environment.","code":"R --version conda create -n weathergenr-py python=3.11 -y conda activate weathergenr-py conda install -c conda-forge rpy2 -y pip install numpy pandas"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"install-r","dir":"Articles","previous_headings":"","what":"Install R","title":"Running from Python","text":"Install latest version R CRAN verify available command line:","code":"R --version"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"create-a-python-environment","dir":"Articles","previous_headings":"","what":"Create a Python environment","title":"Running from Python","text":"Avoid setting PYTHONHOME PYTHONPATH unless debugging misconfigured environment.","code":"conda create -n weathergenr-py python=3.11 -y conda activate weathergenr-py conda install -c conda-forge rpy2 -y pip install numpy pandas"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"configure-environment-variables-for-rpy2","dir":"Articles","previous_headings":"","what":"Configure environment variables for rpy2","title":"Running from Python","text":"","code":"import os import shutil from pathlib import Path  def _windows_guess_r_home():     candidates = [         Path(\"C:/Program Files/R\"),         Path(\"C:/Program Files (x86)/R\"),     ]     for base in candidates:         if base.exists():             versions = sorted(base.glob(\"R-*\"), reverse=True)             if versions:                 return str(versions[0])     return None  r_home = os.environ.get(\"R_HOME\")  if not r_home and os.name == \"nt\":     r_home = _windows_guess_r_home()  if r_home:     os.environ[\"R_HOME\"] = r_home     r_bin = Path(r_home) / \"bin\"     if os.name == \"nt\":         r_bin_x64 = r_bin / \"x64\"         if r_bin_x64.exists():             r_bin = r_bin_x64     os.environ[\"PATH\"] = str(r_bin) + os.pathsep + os.environ.get(\"PATH\", \"\") else:     if shutil.which(\"R\") is None:         raise RuntimeError(\"R not found. Install R or set R_HOME.\")  print(\"R_HOME:\", os.environ.get(\"R_HOME\", \"<not set>\")) print(\"R on PATH:\", shutil.which(\"R\") or \"<not found>\")"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"install-and-load-weathergenr-from-github","dir":"Articles","previous_headings":"","what":"Install and load weathergenr from GitHub","title":"Running from Python","text":"","code":"import rpy2.robjects as ro from rpy2.robjects.packages import importr  translations = {     \"package.dependencies\": \"package_dot_dependencies\",     \"package_dependencies\": \"package_uscore_dependencies\", }  base = importr(\"base\") utils = importr(\"utils\") utils.chooseCRANmirror(ind = 1)  if not ro.r('requireNamespace(\"devtools\", quietly = TRUE)')[0]:     utils.install_packages(\"devtools\")  devtools = importr(\"devtools\", robject_translations = translations) devtools.install_github(\"tanerumit/weathergenr\")  weathergenr = importr(\"weathergenr\", robject_translations = translations)"},{"path":"https://deltares-research.github.io/weathergenr/articles/running_from_python.html","id":"run-a-minimal-example","dir":"Articles","previous_headings":"","what":"Run a minimal example","title":"Running from Python","text":"","code":"import os from pathlib import Path import rpy2.robjects as ro from rpy2.robjects.packages import importr  base = importr(\"base\") weathergenr = importr(\"weathergenr\")  ncfile = base.system_file(\"extdata\", \"ntoum_era5_data.nc\", package=\"weathergenr\") ncdata = weathergenr.readNetcdf(ncfile)  outdir = Path(os.environ.get(\"WEATHERGENR_OUTDIR\", \"weathergenr-output\")).resolve() outdir.mkdir(parents=True, exist_ok=True)  variables = ro.StrVector([\"precip\", \"temp\", \"temp_min\", \"temp_max\"])  stochastic_weather <- weathergenr.generate_weather(   obs_data = ncdata[0],   obs_grid = ncdata[1],   obs_dates = ncdata[2],   vars = variables,   n_years = 20,   start_year = 2020,   year_start_month = 1,   n_realizations = 3,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 10000,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   output_path = str(outdir),   seed = seed,   parallel = False,   verbose = False )  print(\"Completed. Output written to:\", outdir)"},{"path":"https://deltares-research.github.io/weathergenr/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"M.Umit Taner. Maintainer.","code":""},{"path":"https://deltares-research.github.io/weathergenr/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Taner MU (2026). weathergenr: Gridded semi-parametric weather generator. R package version 1.0.1, https://deltares-research.github.io/weathergenr.","code":"@Manual{,   title = {weathergenr: Gridded semi-parametric weather generator},   author = {Mehmet Umit Taner},   year = {2026},   note = {R package version 1.0.1},   url = {https://deltares-research.github.io/weathergenr}, }"},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"weathergenr","text":"weathergenr R package implements semiparametric, multivariate, multisite stochastic weather generator designed climate risk stress-testing applications. approach conceptually based framework Steinschneider & Brown (2013) adapted gridded datasets modern NetCDF-based workflows. package intended workflows : climate risk stress testing hydrological water-resources modelling scenario analysis climate adaptation studies","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"methodological-framework","dir":"","previous_headings":"","what":"Methodological framework","title":"weathergenr","text":"generator represents climate variability across multiple time scales coupling low-frequency climate dynamics realistic daily weather sequences. consists three components: generator combines low-frequency climate variability realistic daily weather sequences using three-stage approach: 1. Low-frequency climate variability (WARM) Interannual decadal variability modeled wavelet autoregressive methods applied annual climate aggregates. preserves persistence spectral structure defines annual climate states condition daily weather. 2. Daily weather generation (Markov chain + KNN) Wet-dry persistence simulated multi-state Markov chain, daily precipitation temperature values generated via K-nearest-neighbour resampling. maintains seasonality, cross-variable dependence, spatial coherence. 3. Climate perturbation stress testing Quantile-based perturbations impose controlled changes means, variability, extremes, enabling systematic climate stress testing preserving internal consistency.","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"intended-use","dir":"","previous_headings":"","what":"Intended use","title":"weathergenr","text":"resulting framework intended bottom-climate vulnerability assessments explore system response wide range plausible climate conditions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"key-features","dir":"","previous_headings":"","what":"Key features","title":"weathergenr","text":"netcdf /o convenient coupling models efficient generation, filtering, evaluation large stochastic ensembles integrated diagnostics visualization validation analysis","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"weathergenr","text":"Install latest version GitHub:","code":"# install.packages(\"devtools\") # devtools::install_github(\"Deltares-research/weathergenr\")"},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"getting-started-1","dir":"","previous_headings":"","what":"Getting started","title":"weathergenr","text":"quick tutorial available : https://deltares-research.github.io/weathergenr/articles/getting_started.html","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"weathergenr","text":"Steinschneider, S., & Brown, C. (2013). semiparametric multivariate, multisite weather generator low-frequency variability use climate risk assessments. Water Resources Research, 49(11), 7205-7220. (https://doi.org/10.1002/wrcr.20528)","code":""},{"path":"https://deltares-research.github.io/weathergenr/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"weathergenr","text":"Licensed MIT License. See LICENSE details.","code":""},{"path":"https://deltares-research.github.io/weathergenr/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2021 Deltares Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/adjust_precipitation_qm.html","id":null,"dir":"Reference","previous_headings":"","what":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","title":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","text":"Applies month-wise **Gamma quantile mapping (QM)** daily precipitation impose prescribed changes **wet-day intensity** (monthly wet-day mean variance). workflow : Identify \"wet-day intensities\" precip > intensity_threshold. calendar month, fit **baseline Gamma distribution** wet-day     intensities using fitdistrplus::fitdist(). simulation year index y month m, construct     **target Gamma distribution** scaling baseline moments using     mean_factor[y, m] var_factor[y, m] (optionally     scale_var_with_mean). Map wet-day intensity baseline CDF (pgamma)     target inverse CDF (qgamma). Values <= intensity_threshold treated \"dry\" function returned unchanged. Therefore, function change wet-day frequency. need changes wet/dry spell structure, apply separate occurrence perturbation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/adjust_precipitation_qm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","text":"","code":"adjust_precipitation_qm(   precip = NULL,   mean_factor = NULL,   var_factor = NULL,   scale_var_with_mean = TRUE,   exaggerate_extremes = FALSE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   enforce_target_mean = TRUE,   month = NULL,   year = NULL,   intensity_threshold = 0,   fit_method = \"mme\",   min_events = 10,   validate_output = TRUE,   diagnostics = FALSE,   seed = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/adjust_precipitation_qm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","text":"precip Numeric vector. Daily precipitation (mm/day). Must >= 0. NA values allowed pass unchanged. mean_factor Numeric matrix dimensions (n_years x 12). Monthly multiplicative factors applied baseline wet-day mean month. Entry mean_factor[y, m] used simulation year index y calendar month m. var_factor Numeric matrix dimensions (n_years x 12). Monthly multiplicative factors applied baseline wet-day variance month. Entry var_factor[y, m] used simulation year index y calendar month m. scale_var_with_mean Logical scalar. TRUE, effective variance factor used build target distributions : $$var\\_factor\\_use = var\\_factor \\times mean\\_factor^2$$ tends keep coefficient variation (CV) stable mean changes applied. Default FALSE. exaggerate_extremes Logical scalar. TRUE, applies tail-exponent transform probability space extreme_prob_threshold mapping target distribution. amplifies relative changes upper tail keeping Gamma--Gamma mapping structure. Default FALSE. extreme_prob_threshold Numeric scalar (0, 1). Defines start \"extreme\" tail baseline probability space. example, 0.95 corresponds top 5% wet-day intensities baseline month-specific Gamma. Used exaggerate_extremes = TRUE. Default 0.95. extreme_k Numeric scalar > 0. Tail exponent controlling tail amplification exaggerate_extremes = TRUE. Values > 1 amplify extremes; values (0, 1) dampen . Default 1.2. enforce_target_mean Logical scalar. TRUE, rescales mapped wet-day values within (year index, month) group wet-day mean matches intended target mean baseline_mean(month) * mean_factor[y, m]. relevant exaggerate_extremes = TRUE tail amplification can shift mean away intended target. Default TRUE. month Integer vector, length precip. Calendar month day (1–12). year Integer vector, length precip. Simulation year index day (1 = first simulated year, 2 = second, ...). Must contiguous index set 1:n_years. pass calendar years. max(year) must equal nrow(mean_factor) nrow(var_factor). intensity_threshold Numeric scalar >= 0. Defines values treated wet-day intensities fitting mapping: precip > intensity_threshold. Values <= intensity_threshold returned unchanged. Default 0. fit_method Character scalar. Estimation method passed fitdistrplus::fitdist() Gamma fitting (e.g., \"mme\", \"mle\"). Default \"mme\". min_events Integer scalar. Minimum number wet-day intensities required within month fit baseline Gamma. Months fewer wet-day values skipped; wet-day values skipped months pass unchanged. Default 10. validate_output Logical scalar. TRUE, replaces Inf/NaN produced mapping original values positions clamps negative outputs zero. Default TRUE. diagnostics Logical scalar. TRUE, returns list containing: adjusted series, diagnostics validate_quantile_mapping(), fitted objects needed higher-level workflows (baseline target Gamma parameters). Default FALSE. seed Optional integer. provided, sets temporary RNG seed via set.seed(). previous RNG state restored exit. Default NULL. verbose Logical scalar. TRUE, prints progress warnings skipped months failed fits. Default FALSE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/adjust_precipitation_qm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","text":"diagnostics = FALSE, returns numeric vector length precip. returned vector attributes: perturbed_months: months (1–12) successfully fitted perturbed skipped_months: months (1–12) skipped due insufficient data failed fits n_failed_fits: number monthly Gamma fits failed diagnostics = TRUE, returns list: adjusted: numeric vector (attributes) diagnostics: output validate_quantile_mapping()","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/adjust_precipitation_qm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Adjust Daily Precipitation with Gamma Quantile Mapping Under Monthly Scenario Factors — adjust_precipitation_qm","text":"Interpretation mean/variance factors Factors apply wet-day intensities (precip > intensity_threshold). control wet-day frequency; apply separate occurrence model required.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"Performs continuous wavelet transform (CWT) analysis using Morlet mother wavelet (Torrence & Compo, 1998) returns wavelet power, cone influence (COI), global wavelet spectrum (GWS), significance thresholds. implementation includes: COI-aware global spectrum estimation, effective sample size (neff) based significance testing, AR(1) red-noise background estimation (Yule-Walker), optional scale-component reconstruction mode = \"complete\". function intended detection diagnostic analysis dominant time scales. Reconstructed scale components additive orthogonal.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"","code":"analyze_wavelet_spectrum(   series,   signif = 0.9,   noise = \"red\",   min_period = 2,   detrend = FALSE,   mode = c(\"fast\", \"complete\"),   diagnostics = FALSE,   lag1_ci = FALSE,   lag1_ci_level = 0.95,   lag1_boot_n = 500,   seed = NULL,   warn_neff = FALSE,   neff_warn_min = 5,   neff_warn_frac = 0.6 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"series Numeric vector. Input time series (regularly spaced, missing values). Minimum length 16 observations. signif Numeric scalar (0, 1). Significance level wavelet power GWS tests. Default 0.90. noise Character. Background noise model significance testing. One \"white\" \"red\" (default). red noise, AR(1) model estimated. min_period Numeric scalar. Minimum Fourier period (time units) used identifying significant scales (default: 2). detrend Logical. TRUE, removes linear-trend slope (mean preserved) prior analysis (default: FALSE). mode Character. \"fast\" (default) returns essential outputs ; \"complete\" additionally returns pointwise significance (optionally) reconstruction products. diagnostics Logical. TRUE, returns additional diagnostics list. mode = \"complete\", diagnostics also include reconstruction error metrics reconstructed components computed. lag1_ci Logical. TRUE, computes bootstrap confidence interval AR(1) coefficient (diagnostic ; affect inference). lag1_ci_level Numeric scalar (0, 1). Confidence level AR(1) bootstrap interval. lag1_boot_n Integer. Number bootstrap replicates AR(1) interval (>= 50). seed Optional numeric scalar. Random seed used bootstrap diagnostics. warn_neff Logical. TRUE, warns effective sample size small scales. neff_warn_min Numeric scalar. Threshold neff considered small. neff_warn_frac Numeric scalar (0, 1). Fraction scales neff < neff_warn_min required trigger warning.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"list. Always includes (minimum): gws Numeric vector. COI-masked global wavelet spectrum. gws_unmasked Numeric vector. Unmasked global wavelet spectrum (plotting ). period Numeric vector. Fourier periods corresponding wavelet scales. gws_signif Numeric vector. COI- neff-corrected GWS significance threshold (inference). gws_signif_unmasked Numeric vector. Unmasked GWS significance threshold (plotting ). has_significance Logical. Whether significant scales detected. signif_periods Integer vector. Indices significant scales retained (one per contiguous band). coi Numeric vector. Cone influence time units. power Numeric matrix. Wavelet power spectrum (scales x time). mode = \"complete\", additional fields may include: power_coi Numeric matrix. COI-masked wavelet power. sigm Numeric matrix. Pointwise significance ratio. sigm_coi Numeric matrix. COI-masked pointwise significance ratio. power_signif_coi Logical matrix. COI-masked pointwise significance mask. wave Complex matrix. Wavelet coefficients (scales x time). comps Numeric matrix. Reconstructed significant-scale components plus residual (computed). comps_names Character vector. Component names. gws_n_coi Numeric vector. Number time points inside COI per scale. neff Numeric vector. Effective sample size per scale (masked). neff_unmasked Numeric vector. Effective sample size per scale (unmasked). diagnostics List. Returned diagnostics = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/analyze_wavelet_spectrum.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Continuous Wavelet Spectral Analysis with COI-Aware Significance — analyze_wavelet_spectrum","text":"Torrence, C., & Compo, G. P. (1998). practical guide wavelet analysis. Bulletin American Meteorological Society, 79(1), 61-78.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","title":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","text":"Applies monthly climate perturbations daily gridded weather simulations modular physically interpretable way. function operates independently precipitation intensity, precipitation occurrence, temperature, (optionally) potential evapotranspiration (PET). perturbation workflow : 1. Construct simulation-year index `date` (`1..n_years`). 2. Optionally modify monthly wet-day probabilities within (year index, month) group. 3. Apply precipitation intensity perturbations wet days using Gamma-based quantile mapping    via [adjust_precipitation_qm()]. 4. Apply temperature perturbations using monthly additive deltas (step change transient ramp). 5. Optionally recompute PET perturbed temperature fields. function intended climate stress testing scenario analysis, controlled changes mean climate, variability, extremes required preserving realistic daily structure.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","text":"","code":"apply_climate_perturbations(   data = NULL,   grid = NULL,   date = NULL,   precip_mean_factor = NULL,   precip_var_factor = NULL,   precip_occurrence_factor = NULL,   precip_intensity_threshold = 0,   temp_delta = NULL,   temp_transient = TRUE,   precip_transient = TRUE,   precip_occurrence_transient = TRUE,   compute_pet = TRUE,   pet_method = \"hargreaves\",   qm_fit_method = \"mme\",   scale_var_with_mean = TRUE,   exaggerate_extremes = FALSE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   enforce_target_mean = TRUE,   precip_cap_mm_day = NULL,   precip_floor_mm_day = NULL,   precip_cap_quantile = NULL,   seed = NULL,   verbose = FALSE,   diagnostic = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","text":"data List data.frames, one per grid cell. data.frame must contain `precip`, `temp`, `temp_min`, `temp_max`. `compute_pet = TRUE`, column `pet` added overwritten. grid Data frame grid metadata `nrow(grid) == length(data)`. Must include latitude column: `lat` (preferred) `y` (legacy). date Date vector length equal number rows grid-cell data.frame. Used derive month simulation-year indices. precip_mean_factor Numeric vector length 12 numeric matrix `(n_years x 12)`. Monthly multiplicative factors applied wet-day precipitation mean intensity perturbation. precip_var_factor Numeric vector length 12 numeric matrix `(n_years x 12)`. Monthly multiplicative factors applied wet-day precipitation variance. precip_occurrence_factor Optional numeric vector length 12 numeric matrix `(n_years x 12)`. Multiplicative factors applied monthly wet-day probability. precip_intensity_threshold Numeric scalar `>= 0`. Defines wet days `precip > precip_intensity_threshold`. Also passed [adjust_precipitation_qm()] `intensity_threshold`. Default 0. temp_delta Numeric vector length 12. Monthly additive temperature deltas (degC) applied `temp`, `temp_min`, `temp_max`. temp_transient Logical. TRUE, temperature deltas ramp linearly zero twice `temp_delta` across simulation years, preserving mean change. precip_transient Logical. TRUE, precipitation mean variance factors ramp linearly across simulation years using transient logic. precip_occurrence_transient Logical. TRUE, precipitation occurrence factors ramp linearly across simulation years. compute_pet Logical. TRUE, recompute PET perturbed temperature using [calculate_monthly_pet()]. pet_method Character string specifying PET method passed [calculate_monthly_pet()] (default: \"hargreaves\"). qm_fit_method Character string specifying Gamma fitting method passed [adjust_precipitation_qm()] (e.g., \"mme\", \"mle\"). scale_var_with_mean Logical. TRUE, precipitation variance scaling computed `var_factor_use = precip_var_factor * precip_mean_factor^2`. exaggerate_extremes Logical. TRUE, amplify upper-tail wet-day precipitation intensity quantile mapping step (forwarded [adjust_precipitation_qm()]). extreme_prob_threshold Numeric scalar (0, 1). Probability threshold defining start tail region amplification [adjust_precipitation_qm()]. extreme_k Numeric scalar > 0. Tail exponent controlling amplification strength [adjust_precipitation_qm()]. Values > 1 amplify extremes; values (0, 1) dampen. enforce_target_mean Logical. TRUE, rescale mapped wet-day values within (year index, month) group wet-day mean matches intended target mean tail amplification. precip_cap_mm_day Optional numeric scalar. Absolute upper cap (mm/day) applied precipitation perturbations. precip_floor_mm_day Optional numeric scalar. Minimum precipitation amount (mm/day) applied wet days perturbation. precip_cap_quantile Optional numeric scalar (0, 1). Quantile-based cap computed perturbed precipitation series applied additional upper bound. seed Optional integer. Sets random seed reproducible precipitation occurrence perturbations stochastic components. verbose Logical. TRUE, prints progress messages warnings. diagnostic Logical. TRUE (default), return precipitation quantile-mapping diagnostics [adjust_precipitation_qm()] alongside perturbed data.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","text":"`diagnostic = TRUE` (default), list : * `data`: list data.frames (one per grid cell) * `diagnostic`: list per-grid diagnostic objects returned [adjust_precipitation_qm()], large   `adjusted` vector removed `diagnostic = FALSE`, list data.frames returned.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_climate_perturbations.html","id":"year-indexing-convention-critical-","dir":"Reference","previous_headings":"","what":"Year indexing convention (critical)","title":"Apply Monthly Climate Perturbations to Gridded Daily Weather Series — apply_climate_perturbations","text":"precipitation perturbations rely simulation-year index `year_idx = 1..n_years`, derived internally `date`. Calendar years passed downstream. factor matrices supplied `n_years x 12` indexed using simulation-year convention.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply Gamma-to-Gamma Quantile Mapping for Precipitation — apply_quantile_mapping","title":"Apply Gamma-to-Gamma Quantile Mapping for Precipitation — apply_quantile_mapping","text":"Internal helper implementing gamma-based quantile mapping precipitation: values mapped probability space baseline monthly gamma, mapped back precipitation target monthly/year gamma. Optionally applies tail-probability exaggeration enforcement step match target mean month-year subset level.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply Gamma-to-Gamma Quantile Mapping for Precipitation — apply_quantile_mapping","text":"","code":"apply_quantile_mapping(   precip,   mon,   year,   base_gamma,   target_gamma,   exaggerate_extremes = FALSE,   extreme_prob_threshold = 0.95,   extreme_k = 1.2,   enforce_target_mean = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply Gamma-to-Gamma Quantile Mapping for Precipitation — apply_quantile_mapping","text":"precip Numeric vector precipitation values (subset, typically wet days). mon Integer vector months (1-12), length `precip`. year Integer vector year indices used select columns `target_gamma$shape/scale/mean`. index (1..n_years), necessarily calendar year value. base_gamma Data frame `month`, `shape`, `scale` columns. target_gamma List produced `compute_target_parameters()`, containing `shape`, `scale`, `mean` matrices indexed `[month_row, year_index]`. exaggerate_extremes Logical. `TRUE`, modifies probabilities `extreme_prob_threshold` `u' = 1 - (1-u)^k`. extreme_prob_threshold Numeric (0,1). Tail threshold `u0`. extreme_k Positive numeric. Tail exponent `k`. enforce_target_mean Logical. `TRUE`, rescales mapped values within (month, year) subset match `target_gamma$mean`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/apply_quantile_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply Gamma-to-Gamma Quantile Mapping for Precipitation — apply_quantile_mapping","text":"Numeric vector mapped precipitation values, length `precip`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":null,"dir":"Reference","previous_headings":"","what":"Assign qualitative assessments for moment preservation — assess_moment_changes","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"Classifies moment changes based absolute percent change thresholds differ metric.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"","code":"assess_moment_changes(moments_df)"},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"moments_df Data.frame. Output compute_moment_diagnostics containing least metric pct_change.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"Character vector length nrow(moments_df) assessment labels.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/assess_moment_changes.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Assign qualitative assessments for moment preservation — assess_moment_changes","text":"function applies metric-specific thresholds: mean/variance: excellent < 5, good < 15, else poor cv: excellent < 10, good < 20, else poor others (sd, skewness, kurtosis): good < 15, acceptable < 30, else poor","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/build_historical_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Build Historical Date Table — build_historical_dates","title":"Build Historical Date Table — build_historical_dates","text":"Constructs tibble historical dates calendar water-year indices, restricts complete years (365 days ) returns longest contiguous block complete years.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/build_historical_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build Historical Date Table — build_historical_dates","text":"","code":"build_historical_dates(obs_dates, year_start_month, verbose = FALSE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/build_historical_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build Historical Date Table — build_historical_dates","text":"obs_dates Date vector observation dates (leap days already removed). year_start_month Integer 1-12. First month simulation year. verbose Logical. TRUE, logs summary information.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/build_historical_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build Historical Date Table — build_historical_dates","text":"list three elements: dates_df Tibble columns: dateo, year, wyear, month, day, date. wyear_idx Integer vector row indices obs_dates corresponding     complete years. complete_wyears Integer vector complete water years.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"Calculates monthly potential evapotranspiration (PET) using selected method. Currently supports Hargreaves temperature-based method.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"","code":"calculate_monthly_pet(month, temp, temp_range, lat_deg, method = \"hargreaves\")"},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"month Integer vector (1-12). Calendar month PET estimate. temp Numeric vector. Mean monthly air temperature (degC). temp_range Numeric vector. Monthly diurnal temperature range (Tmax - Tmin, degC). Must non-negative. lat_deg Numeric scalar. Latitude decimal degrees (positive north). method Character scalar. PET method. Currently \"hargreaves\".","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/calculate_monthly_pet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Monthly Potential Evapotranspiration (PET) — calculate_monthly_pet","text":"Numeric vector monthly PET values mm/day (length length(month)).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_area_averages.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Area-Averaged Daily and Annual Climate Series — compute_area_averages","title":"Compute Area-Averaged Daily and Annual Climate Series — compute_area_averages","text":"Computes area-averaged (mean across grid cells) daily climate values aggregates annual means water year.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_area_averages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Area-Averaged Daily and Annual Climate Series — compute_area_averages","text":"","code":"compute_area_averages(obs_data, wyear_idx, wyear, vars)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_area_averages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Area-Averaged Daily and Annual Climate Series — compute_area_averages","text":"obs_data Named list data frames (one per grid cell). wyear_idx Integer vector row indices extract data frame. wyear Integer vector water years corresponding wyear_idx. vars Character vector variable names average.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_area_averages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Area-Averaged Daily and Annual Climate Series — compute_area_averages","text":"list two elements: daily Data frame area-averaged daily values columns     variable plus wyear. annual Tibble annual means columns wyear plus variable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_dryday_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute dry-day and wet-day frequency diagnostics (intended preserved) — compute_dryday_diagnostics","title":"Compute dry-day and wet-day frequency diagnostics (intended preserved) — compute_dryday_diagnostics","text":"Compute dry-day wet-day frequency diagnostics (intended preserved)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_dryday_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute dry-day and wet-day frequency diagnostics (intended preserved) — compute_dryday_diagnostics","text":"","code":"compute_dryday_diagnostics(   precip_ref,   precip_adj,   wet_thresh,   tol_freq_abs = 0.01 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_extreme_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute extreme-value diagnostics (tail ratios) — compute_extreme_diagnostics","title":"Compute extreme-value diagnostics (tail ratios) — compute_extreme_diagnostics","text":"Compute extreme-value diagnostics (tail ratios)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_extreme_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute extreme-value diagnostics (tail ratios) — compute_extreme_diagnostics","text":"","code":"compute_extreme_diagnostics(precip_ref, precip_adj)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sample excess kurtosis — compute_kurtosis","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Computes (non-bias-corrected) fourth standardized central moment minus 3 (excess kurtosis) numeric vector, excluding NA values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sample excess kurtosis — compute_kurtosis","text":"","code":"compute_kurtosis(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sample excess kurtosis — compute_kurtosis","text":"x Numeric vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Numeric scalar. Excess kurtosis estimate, NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_kurtosis.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute sample excess kurtosis — compute_kurtosis","text":"Returns NA fewer 4 non-missing values available standard deviation zero.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_moment_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute moment diagnostics (scenario-aware when factors + month/year are available) — compute_moment_diagnostics","title":"Compute moment diagnostics (scenario-aware when factors + month/year are available) — compute_moment_diagnostics","text":"Compute moment diagnostics (scenario-aware factors + month/year available)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_moment_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute moment diagnostics (scenario-aware when factors + month/year are available) — compute_moment_diagnostics","text":"","code":"compute_moment_diagnostics(   precip_ref,   precip_adj,   mask,   month = NULL,   year = NULL,   mean_factor = NULL,   var_factor = NULL,   tol_mean = 0.05,   tol_var = 0.1 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_monthly_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute month-by-month diagnostics (scenario-aware when factors + year are available) — compute_monthly_diagnostics","title":"Compute month-by-month diagnostics (scenario-aware when factors + year are available) — compute_monthly_diagnostics","text":"Compute month--month diagnostics (scenario-aware factors + year available)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_monthly_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute month-by-month diagnostics (scenario-aware when factors + year are available) — compute_monthly_diagnostics","text":"","code":"compute_monthly_diagnostics(   precip_ref,   precip_adj,   month,   mean_factor = NULL,   var_factor = NULL,   year = NULL,   tol_mean = 0.05,   tol_var = 0.1 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_quantile_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute quantile diagnostics (reports change; no scenario-aware target by default) — compute_quantile_diagnostics","title":"Compute quantile diagnostics (reports change; no scenario-aware target by default) — compute_quantile_diagnostics","text":"Compute quantile diagnostics (reports change; scenario-aware target default)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_quantile_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute quantile diagnostics (reports change; no scenario-aware target by default) — compute_quantile_diagnostics","text":"","code":"compute_quantile_diagnostics(precip_ref, precip_adj, probs)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute sample skewness — compute_skewness","title":"Compute sample skewness — compute_skewness","text":"Computes (non-bias-corrected) third standardized central moment (skewness) numeric vector, excluding NA values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute sample skewness — compute_skewness","text":"","code":"compute_skewness(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute sample skewness — compute_skewness","text":"x Numeric vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute sample skewness — compute_skewness","text":"Numeric scalar. Skewness estimate, NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_skewness.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute sample skewness — compute_skewness","text":"Returns NA fewer 3 non-missing values available standard deviation zero (yields undefined standardization).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute wet and dry spell-length diagnostics (intended preserved) — compute_spell_diagnostics","title":"Compute wet and dry spell-length diagnostics (intended preserved) — compute_spell_diagnostics","text":"Compute wet dry spell-length diagnostics (intended preserved)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute wet and dry spell-length diagnostics (intended preserved) — compute_spell_diagnostics","text":"","code":"compute_spell_diagnostics(   precip_ref,   precip_adj,   wet_thresh,   tol_mean_ratio = 0.2 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Computes consecutive run lengths dry wet states relative threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"","code":"compute_spell_lengths(x, threshold, below = TRUE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"x Numeric vector. Precipitation values. threshold Numeric scalar. Wet-day threshold. Logical. TRUE, defines spells x < threshold (dry spells). FALSE, defines spells x >= threshold (wet spells).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Numeric vector positive integers giving spell lengths. May length zero.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_spell_lengths.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute run-lengths (spell lengths) for dry or wet states — compute_spell_lengths","text":"Uses rle() logical state series identify consecutive runs. spells requested type occur, function returns numeric(0).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_summary_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute summary metrics (no qualitative grades; no scoring) — compute_summary_metrics","title":"Compute summary metrics (no qualitative grades; no scoring) — compute_summary_metrics","text":"Compute summary metrics (qualitative grades; scoring)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_summary_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute summary metrics (no qualitative grades; no scoring) — compute_summary_metrics","text":"","code":"compute_summary_metrics(   moments,   quant_metrics,   extreme_metrics,   spell_metrics,   dryday_metrics )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"Computes tail-mass metrics based lower upper tail quantile thresholds. Uses robust scale estimation (IQR -> MAD -> SD fallback) normalizes tail deficit/excess masses series length scale.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"","code":"compute_tailmass_metrics(   obs_use,   sim_series_stats,   tail_low_p,   tail_high_p,   tail_eps )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"obs_use Numeric vector observed values. sim_series_stats Numeric matrix simulated values (n_use x n_realizations). tail_low_p Lower tail quantile probability (e.g., 0.10). tail_high_p Upper tail quantile probability (e.g., 0.90). tail_eps Epsilon log transform avoid log(0).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_tailmass_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute tail-mass metrics for filtering — compute_tailmass_metrics","text":"List tail thresholds, scale, masses, log-distance metrics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Target Gamma Parameters from Baseline and Change Factors — compute_target_parameters","title":"Compute Target Gamma Parameters from Baseline and Change Factors — compute_target_parameters","text":"Computes year-specific target gamma distribution parameters month scaling baseline monthly mean variance using change factors, converting target moments gamma `shape` `scale`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Target Gamma Parameters from Baseline and Change Factors — compute_target_parameters","text":"","code":"compute_target_parameters(   base_gamma,   mean_factor,   var_factor,   months_ok,   n_years )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Target Gamma Parameters from Baseline and Change Factors — compute_target_parameters","text":"base_gamma Data frame produced `fit_monthly_distributions()`, columns `month`, `mean`, `var` (typically `shape`, `scale`). mean_factor Numeric matrix multiplicative mean factors dimensions `n_years x 12` (year x month). var_factor Numeric matrix multiplicative variance factors dimensions `n_years x 12` (year x month). months_ok Integer vector months expected represented (kept interface consistency; function uses `base_gamma$month`). n_years Integer. Number years (must match `nrow(mean_factor)` `nrow(var_factor)`).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_target_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Target Gamma Parameters from Baseline and Change Factors — compute_target_parameters","text":"list elements: `months` Integer vector months (`base_gamma$month`). `shape` Numeric matrix `[n_months x n_years]` target shapes. `scale` Numeric matrix `[n_months x n_years]` target scales. `mean` Numeric matrix `[n_months x n_years]` target means. `var` Numeric matrix `[n_months x n_years]` target variances.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_temporal_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute temporal diagnostics (no subjective categories) — compute_temporal_diagnostics","title":"Compute temporal diagnostics (no subjective categories) — compute_temporal_diagnostics","text":"Compute temporal diagnostics (subjective categories)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_temporal_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute temporal diagnostics (no subjective categories) — compute_temporal_diagnostics","text":"","code":"compute_temporal_diagnostics(precip_ref, precip_adj, month, year, mask)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate water year from a date vector — compute_water_year","title":"Calculate water year from a date vector — compute_water_year","text":"Assigns water year date based custom starting month. water year groups months across calendar years (e.g., Oct-Sep).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate water year from a date vector — compute_water_year","text":"","code":"compute_water_year(date, water_year_start_month = 1)"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate water year from a date vector — compute_water_year","text":"date vector Date objects. water_year_start_month Integer (1-12) indicating first month water year. example, 10 October 6 June. Default 1 (calendar year).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate water year from a date vector — compute_water_year","text":"integer vector length date, giving water year date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_water_year.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate water year from a date vector — compute_water_year","text":"","code":"dates <- as.Date(c(\"2022-09-30\", \"2022-10-01\", \"2023-06-15\")) compute_water_year(dates, water_year_start_month = 10) #> [1] 2022 2023 2023"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"performs wavelet analysis observed series simulated realizations. Identifies significant periods, computes regional power contrast metrics, caches masked (filtering) unmasked (plotting) GWS.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"","code":"compute_wavelet_metrics(   obs_use,   sim_series_stats,   wavelet_pars,   padding,   min_bg )"},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"obs_use Numeric vector observed values. sim_series_stats Numeric matrix simulated values. wavelet_pars List wavelet parameters (signif_level, noise_type, etc.). padding Logical period padding. min_bg Minimum background power threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/compute_wavelet_metrics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute wavelet metrics for all realizations — compute_wavelet_metrics","text":"List wavelet filter diagnostics cached spectra.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":null,"dir":"Reference","previous_headings":"","what":"Create all diagnostic plots — create_all_diagnostic_plots","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"Runs full set diagnostic plotting routines returns named list ggplot objects. Optionally saves plots disk (delegated individual plot exporters).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"","code":"create_all_diagnostic_plots(   plot_data,   plot_config,   variables,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"plot_data List precomputed diagnostic datasets produced evaluation pipeline. plot_config List plotting configuration options (theme, alpha, colors, subtitle). variables Character vector variable names loop monthly pattern plots. show_title Logical; TRUE, titles/subtitles added plots supported. save_plots Logical; TRUE, plots written output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"Named list ggplot objects diagnostics created.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"helper expects precomputed plot data returned evaluation pipeline. validate plot input structure beyond basic use downstream plotting.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/create_all_diagnostic_plots.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create all diagnostic plots — create_all_diagnostic_plots","text":"","code":"if (FALSE) { # \\dontrun{   plot_data <- list()   plot_config <- list(     subtitle = \"Example\",     alpha = 0.4,     colors = c(Observed = \"blue3\", Simulated = \"gray40\"),     theme = ggplot2::theme_bw()   )   plots <- create_all_diagnostic_plots(     plot_data = plot_data,     plot_config = plot_config,     variables = c(\"precip\", \"temp\"),     show_title = FALSE,     save_plots = FALSE,     output_dir = NULL   ) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/criteria_string_compact.html","id":null,"dir":"Reference","previous_headings":"","what":"Compact criteria string for a filter — criteria_string_compact","title":"Compact criteria string for a filter — criteria_string_compact","text":"Compact criteria string filter","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/criteria_string_compact.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compact criteria string for a filter — criteria_string_compact","text":"","code":"criteria_string_compact(   filter_name,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars )"},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_precip_qm.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_precip_qm","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_precip_qm","text":"Computes diagnostics comparing reference quantile-mapped precipitation series. Reports moment changes, quantiles, tail metrics, dry/wet-day frequencies, spell lengths, optional temporal/monthly patterns. `mean_factor`/`var_factor` provided together `month` `year`, moment monthly diagnostics compared intended perturbations (scenario-aware null hypothesis).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_precip_qm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_precip_qm","text":"","code":"diagnose_precip_qm(   precip_ref,   precip_adj,   month = NULL,   year = NULL,   mean_factor = NULL,   var_factor = NULL,   wet_thresh = 0.1,   probs = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_precip_qm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_precip_qm","text":"precip_ref Numeric vector. Reference (original) precipitation values. precip_adj Numeric vector. Adjusted precipitation values (length `precip_ref`). month Integer vector (optional). Month index (1–12) observation. year Integer vector (optional). Year index (1..n_years) observation. mean_factor Numeric matrix (optional). Target mean scaling factors (n_years x 12). var_factor Numeric matrix (optional). Target variance scaling factors (n_years x 12). wet_thresh Numeric. Threshold defining wet days (default = 0.1 mm). probs Numeric vector. Quantile probabilities evaluate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/diagnose_precip_qm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Diagnostics for Precipitation Quantile Mapping — diagnose_precip_qm","text":"list class `precip_qm_diagnostics` elements: `moments`: moment diagnostics table `quantiles`: quantile comparison table `extremes`: tail metrics table `temporal`: temporal metrics table (optional) `monthly`: month--month diagnostics table (optional) `spells`: wet/dry spell diagnostics table `drydays`: wet/dry frequency diagnostics table `summary`: compact summary list","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-add_line_if_possible.html","id":null,"dir":"Reference","previous_headings":"","what":"Add geom_line only for groups with >= 2 observations — .add_line_if_possible","title":"Add geom_line only for groups with >= 2 observations — .add_line_if_possible","text":"Add geom_line groups >= 2 observations","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-add_line_if_possible.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add geom_line only for groups with >= 2 observations — .add_line_if_possible","text":"","code":".add_line_if_possible(p, data, mapping, group_col, ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":null,"dir":"Reference","previous_headings":"","what":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"Applies chosen window consistently across grids realizations removing leap days. window drawn longest contiguous full-year blocks available series.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"","code":".align_obs_sim_periods(daily_obs, daily_sim, n_realizations, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"daily_obs List observed data frames (one per grid). daily_sim List simulated realizations; realization list grids. n_realizations Integer number realizations. variables Character vector variables used evaluation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-align_obs_sim_periods.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Standardize obs and sim to the same full-year length via random windowing — .align_obs_sim_periods","text":"List standardized `daily_obs`, `daily_sim`, window metadata.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Build data for plotting — .build_plot_data","title":"Build data for plotting — .build_plot_data","text":"Build data plotting","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build data for plotting — .build_plot_data","text":"","code":".build_plot_data(obs_results, sim_results, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build data for plotting — .build_plot_data","text":"obs_results Output `.summarize_observed_data()`. sim_results Output `.summarize_simulated_data()`. variables Character vector variable names.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-build_plot_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build data for plotting — .build_plot_data","text":"List standardized data frames diagnostic plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"Compute correlation matrix monthly anomalies","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"","code":".compute_anomaly_correlations(data, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"data Data frame `date`, `id`, variables. variables Character vector variable names correlate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_anomaly_correlations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute correlation matrix on monthly anomalies — .compute_anomaly_correlations","text":"Long-format data frame upper-triangle pairwise correlations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":null,"dir":"Reference","previous_headings":"","what":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"Conditional precip-X correlations within grid","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"","code":".compute_conditional_precip_correlations(   data,   variables,   mc_thresholds = NULL,   wet_def = c(\"gt0\", \"monthly_quantile\"),   use_anom = TRUE,   use_log_precip_on_wet = TRUE,   method = \"pearson\",   min_pairs = 50 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"data Data frame daily values `date`/`id` columns. variables Character vector variable names (must include `\"precip\"`). mc_thresholds Optional wet-day thresholds (required `wet_def = \"monthly_quantile\"`). wet_def Wet-day definition: `\"gt0\"` `\"monthly_quantile\"`. use_anom Logical; subtract monthly means correlation. use_log_precip_on_wet Logical; apply `log1p` precip wet days. method Correlation method passed `stats::cor`. min_pairs Minimum number paired values required report correlation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_conditional_precip_correlations.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Conditional precip-X correlations within each grid — .compute_conditional_precip_correlations","text":"Data frame conditional correlations grid, regime, variable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_intended_ratios.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute intended scaling ratios over the evaluated subset (time-weighted) — .compute_intended_ratios","title":"Compute intended scaling ratios over the evaluated subset (time-weighted) — .compute_intended_ratios","text":"Compute intended scaling ratios evaluated subset (time-weighted)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_intended_ratios.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute intended scaling ratios over the evaluated subset (time-weighted) — .compute_intended_ratios","text":"","code":".compute_intended_ratios(mask, month, year, mean_factor, var_factor)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute time series statistics — .compute_timeseries_stats","title":"Compute time series statistics — .compute_timeseries_stats","text":"Compute time series statistics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute time series statistics — .compute_timeseries_stats","text":"","code":".compute_timeseries_stats(data, variables, mc_thresholds)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute time series statistics — .compute_timeseries_stats","text":"data Data frame daily values `date` column. variables Character vector variable names summarize. mc_thresholds Data frame wet-day thresholds grid month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-compute_timeseries_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute time series statistics — .compute_timeseries_stats","text":"List seasonal, monthly, annual stats plus wet/dry correlation data.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"Compares annual mean precipitation time series: simulated realizations plotted multiple lines/points observed series overlaid single reference series.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"","code":".create_annual_precip_plot(   stats_annual_aavg_sim,   stats_annual_aavg_obs,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"stats_annual_aavg_sim Data frame simulated annual aggregated statistics. stats_annual_aavg_obs Data frame observed annual aggregated statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title plot. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_annual_precip_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create annual mean precipitation diagnostic plot — .create_annual_precip_plot","text":"ggplot object returned invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"Observed-vs-simulated comparison cross-grid correlations, faceted first variable correlation pair. Uses dummy points enforce symmetric axes.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"","code":".create_crossgrid_cor_plot(   stats_crosscor,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"stats_crosscor Data frame cross-grid correlation summaries columns Observed, Simulated, variable1. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_crossgrid_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create cross-grid correlation diagnostic plot — .create_crossgrid_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily mean diagnostic plot — .create_daily_mean_plot","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"Faceted observed-vs-simulated comparison daily mean values variable, using summary ranges medians across grid cells/months. Optionally saves plot.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"","code":".create_daily_mean_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"daily_stats_season Data frame seasonal daily statistics including columns stat, Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_mean_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create daily mean diagnostic plot — .create_daily_mean_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"Faceted observed-vs-simulated comparison daily standard deviations variable, using summary ranges medians across grid cells/months. Optionally saves plot.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"","code":".create_daily_sd_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"daily_stats_season Data frame seasonal daily statistics including columns stat, Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_daily_sd_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create daily standard deviation diagnostic plot — .create_daily_sd_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"Observed-vs-simulated comparison inter-variable correlations, faceted variable. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"","code":".create_intergrid_cor_plot(   stats_intercor,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"stats_intercor Data frame inter-variable correlation summaries columns Observed, Simulated, variable. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_intergrid_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create inter-variable correlation diagnostic plot — .create_intergrid_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"Plots annual cycles month variable: simulated cycles shown realizations, observed cycle shown single reference line.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"","code":".create_monthly_cycle_plot(   daily_stats_season,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"daily_stats_season Data frame daily seasonal statistics including mean values. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_cycle_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create monthly cycle diagnostic plot — .create_monthly_cycle_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"Compares observed simulated monthly distributions (boxplots) given variable, faceted statistic. Simulated distributions shown across realizations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"","code":".create_monthly_pattern_plot(   stats_mon_aavg_sim,   stats_mon_aavg_obs,   variable,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"stats_mon_aavg_sim Data frame simulated monthly aggregated statistics. stats_mon_aavg_obs Data frame observed monthly aggregated statistics. variable Character; variable name plot (must exist inputs). plot_config List plotting configuration options (theme, alpha, colors, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_monthly_pattern_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create monthly pattern plot for a single variable — .create_monthly_pattern_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"Observed-vs-simulated within-grid correlations precipitation variables, stratified precipitation regime (e.g., /wet/dry). Faceted regime (rows) variable pair (columns).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"","code":".create_precip_cond_cor_plot(   stats_precip_cor_cond,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"stats_precip_cor_cond Data frame conditional correlation summaries columns variable1, variable2, id1, id2, regime, Observed, Simulated. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_precip_cond_cor_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create conditional precipitation correlation diagnostic plot — .create_precip_cond_cor_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"Observed-vs-simulated comparison average wet dry spell lengths, faceted spell type/statistic. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"","code":".create_spell_length_plot(   stats_wetdry,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"stats_wetdry Data frame wet/dry diagnostics including spell statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_spell_length_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create wet/dry spell length diagnostic plot — .create_spell_length_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"Observed-vs-simulated comparison average monthly wet dry day counts, faceted statistic. Uses dummy points enforce symmetric axes per facet.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"","code":".create_wetdry_days_plot(   stats_wetdry,   plot_config,   show_title,   save_plots,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"stats_wetdry Data frame wet/dry diagnostics including day-count statistics. plot_config List plotting configuration options (theme, alpha, subtitle, etc.). show_title Logical; TRUE, adds title/subtitle. save_plots Logical; TRUE, writes plot output_dir. output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-create_wetdry_days_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create wet/dry day count diagnostic plot — .create_wetdry_days_plot","text":"ggplot object (returned invisibly .export_multipanel_plot()).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":null,"dir":"Reference","previous_headings":"","what":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"Adds title/subtitle (optional) saves plot disk (optional), using facet layout infer width/height. Returns plot invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"","code":".export_multipanel_plot(   p,   filename,   show_title,   save_plots,   title = NULL,   subtitle = NULL,   output_dir )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"p ggplot object, typically faceted via facet_wrap() facet_grid(). filename Character; output filename (e.g., \"daily_mean.png\"). show_title Logical; TRUE, adds title/subtitle via labs(). save_plots Logical; TRUE, writes plot output_dir. title Character; plot title (used show_title = TRUE). subtitle Character; plot subtitle (used show_title = TRUE). output_dir Character; output directory saved plots.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-export_multipanel_plot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Export a faceted (multi-panel) ggplot — .export_multipanel_plot","text":"ggplot object p, returned invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"Filter correlations type (cross-grid inter-variable)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"","code":".filter_correlation_pairs(   cor_data,   same_var,   same_id,   allowed_pairs,   pair_type )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"cor_data Data frame correlations. same_var Logical; require -variable pairs. same_id Logical; require -grid pairs. allowed_pairs Character vector allowed pair keys. pair_type `\"id\"` grid pairs `\"variable\"` variable pairs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_correlation_pairs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter correlations by type (cross-grid or inter-variable) — .filter_correlation_pairs","text":"Filtered data frame correlations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"Filter single grid data frame selected years (keeps original columns)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"","code":".filter_grid_years(df, years_keep)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"df Data frame `date` column. years_keep Integer vector years retain.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-filter_grid_years.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter a single grid data frame to selected years (keeps original columns) — .filter_grid_years","text":"Filtered data frame columns `df`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"Find full (365-day) years leap-day removal return longest contiguous block","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"","code":".get_full_year_run(dates)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"dates Date vector (leap days already removed).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-get_full_year_run.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find full (365-day) years after leap-day removal and return longest contiguous block — .get_full_year_run","text":"List `years` integer vector. Empty full-year blocks exist.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":null,"dir":"Reference","previous_headings":"","what":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"Checks whether object numeric scalar representing finite integer value. helper intended lightweight input validation strict integer typing required integer-valued numerics acceptable.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"","code":".is_int_scalar(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"x Object test.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"Logical scalar indicating whether x finite integer-valued scalar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-is_int_scalar.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Test Whether an Object Is a Finite Integer Scalar — .is_int_scalar","text":"function returns TRUE : x numeric, x length 1, x finite (NA, NaN, Inf), x fractional component (x %% 1 == 0). Logical, character, integer vectors length greater one return FALSE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":null,"dir":"Reference","previous_headings":"","what":"Package-wide internal logger — .log","title":"Package-wide internal logger — .log","text":"Unified internal logging helper package. Features: - Single entry point logging - Brace interpolation resolved caller environment (base R, glue) - Supports log levels (info, warn, error) - Silent unless verbose = TRUE - Timestamps ISO format","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Package-wide internal logger — .log","text":"","code":".log(msg, level = c(\"info\", \"warn\", \"error\"), verbose = TRUE, tag = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Package-wide internal logger — .log","text":"msg Character scalar. Log message template {variable} syntax. level Character scalar. One \"info\", \"warn\", \"error\". verbose Logical. FALSE, suppress output. tag Optional character scalar. Component tag (e.g. \"WARM\", \"KNN\").","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-log.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Package-wide internal logger — .log","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_drywet_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build dry/wet day count table for printing — .make_drywet_table","title":"Build dry/wet day count table for printing — .make_drywet_table","text":"Build dry/wet day count table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_drywet_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build dry/wet day count table for printing — .make_drywet_table","text":"","code":".make_drywet_table(drydays)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_extremes_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build extremes table for printing — .make_extremes_table","title":"Build extremes table for printing — .make_extremes_table","text":"Build extremes table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_extremes_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build extremes table for printing — .make_extremes_table","text":"","code":".make_extremes_table(extremes)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_moments_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build moments table for printing — .make_moments_table","title":"Build moments table for printing — .make_moments_table","text":"Build moments table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_moments_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build moments table for printing — .make_moments_table","text":"","code":".make_moments_table(moments)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_monthly_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build monthly table for printing — .make_monthly_table","title":"Build monthly table for printing — .make_monthly_table","text":"Build monthly table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_monthly_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build monthly table for printing — .make_monthly_table","text":"","code":".make_monthly_table(monthly)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_quantiles_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build quantiles table for printing — .make_quantiles_table","title":"Build quantiles table for printing — .make_quantiles_table","text":"Build quantiles table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_quantiles_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build quantiles table for printing — .make_quantiles_table","text":"","code":".make_quantiles_table(quantiles)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_spells_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Build spell lengths table for printing — .make_spells_table","title":"Build spell lengths table for printing — .make_spells_table","text":"Build spell lengths table printing","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-make_spells_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build spell lengths table for printing — .make_spells_table","text":"","code":".make_spells_table(spells)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pet_monthly_hargreaves.html","id":null,"dir":"Reference","previous_headings":"","what":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","title":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","text":"Monthly PET via Hargreaves (FAO-56)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pet_monthly_hargreaves.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Monthly PET via Hargreaves (FAO-56) — .pet_monthly_hargreaves","text":"","code":".pet_monthly_hargreaves(month, temp, temp_range, lat_deg)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":null,"dir":"Reference","previous_headings":"","what":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"Pick random contiguous window years length `window_years` year vector","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"","code":".pick_contiguous_year_window(years, window_years)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"years Integer vector available years. window_years Integer number contiguous years sample.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-pick_contiguous_year_window.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pick a random contiguous window of years of length `window_years` from a year vector — .pick_contiguous_year_window","text":"Integer vector selected years chronological order.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":null,"dir":"Reference","previous_headings":"","what":"Display fit summary table for all realizations — .print_fit_summary_table","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"Formats prints compact summary fit metrics across realizations. primarily intended interactive review model performance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"","code":".print_fit_summary_table(fit_summary)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"fit_summary Data frame returned `.summarize_realization_fit()`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-print_fit_summary_table.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Display fit summary table for all realizations — .print_fit_summary_table","text":"Invisibly returns `fit_summary`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"Computes correlation coefficient two numeric vectors using finite paired observations. number valid pairs required minimum, correlation computed.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"","code":".safe_cor(x, y, min_pairs = 3L, method = \"pearson\")"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"x, y Numeric vectors equal length. pairs values finite used. min_pairs Integer >= 1. Minimum number paired observations required compute correlation. method Character. Correlation method passed stats::cor(). One \"pearson\", \"spearman\", \"kendall\".","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-safe_cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Safely Compute Correlation with Pairwise Completeness Check — .safe_cor","text":"Named numeric vector elements: value: correlation coefficient, NA_real_, n: number finite paired observations.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize grouped statistics — .summarize_grouped_stats","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"Summarize grouped statistics","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"","code":".summarize_grouped_stats(df, variables, group_vars, stat_fns)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"df Data frame summarize. variables Character vector variables summarize. group_vars Character vector grouping columns. stat_fns Named list summary functions.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_grouped_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize grouped statistics — .summarize_grouped_stats","text":"Long-format data frame `variable`, `stat`, `value`.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_observed_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize observed weather data — .summarize_observed_data","title":"Summarize observed weather data — .summarize_observed_data","text":"Summarize observed weather data","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_observed_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize observed weather data — .summarize_observed_data","text":"","code":".summarize_observed_data(   daily_obs,   variables,   grid_count,   wet_quantile,   extreme_quantile )"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute fit metrics for each realization — .summarize_realization_fit","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"Computes Mean Absolute Error (MAE) key metrics. MAE measures average magnitude errors simulated observed values. Lower MAE indicates better fit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"","code":".summarize_realization_fit(obs_results, sim_results, variables)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_realization_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute fit metrics for each realization — .summarize_realization_fit","text":"obs_results Observed data results .summarize_observed_data sim_results Simulated data results .summarize_simulated_data variables Character vector variable names","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_simulated_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize simulated weather data — .summarize_simulated_data","title":"Summarize simulated weather data — .summarize_simulated_data","text":"Summarize simulated weather data","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-summarize_simulated_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize simulated weather data — .summarize_simulated_data","text":"","code":".summarize_simulated_data(daily_sim, n_realizations, variables, mc_thresholds)"},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-validate_assessment_inputs.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate inputs for weather assessment — .validate_assessment_inputs","title":"Validate inputs for weather assessment — .validate_assessment_inputs","text":"Validate inputs weather assessment","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/dot-validate_assessment_inputs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate inputs for weather assessment — .validate_assessment_inputs","text":"","code":".validate_assessment_inputs(   daily_sim,   daily_obs,   variables,   n_realizations,   wet_quantile,   extreme_quantile,   verbose )"},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"Estimates month-specific transition probabilities three-state precipitation occurrence Markov chain (dry, wet, wet) observed daily precipitation data, maps probabilities onto simulated time axis. Transition probabilities inferred observed lag-1 lag-0 precipitation pairs using month-dependent wet extreme thresholds. Dirichlet-type smoothing applied avoid zero-probability transitions, effective smoothing strength decreasing automatically number observed transitions per month. function supports calendar-year water-year simulations. regime inferred month_order: month_order[1] == 1, calendar-year logic used; otherwise, water-year logic assumed. Optional spell-persistence modifiers applied dry wet states influence transition persistence. adjustments, transition probabilities explicitly normalized ensure stochastic validity (non-negativity rows summing one). estimated monthly transition probabilities assigned simulated days fall within target simulation year corresponding calendar month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"","code":"estimate_monthly_markov_probs(   precip_lag0,   precip_lag1,   month_lag0,   month_lag1,   year_lag0 = NULL,   year_lag1 = NULL,   wet_threshold,   extreme_threshold,   month_order,   sim_month,   sim_wyear,   year_idx,   sim_start_year,   dry_spell_factor_month,   wet_spell_factor_month,   n_days_sim,   dirichlet_alpha = 1 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"precip_lag0 Numeric vector. Observed daily precipitation lag 0 (current day) used estimate state transitions. precip_lag1 Numeric vector. Observed daily precipitation lag 1 (previous day) used estimate state transitions. month_lag0 Integer vector (1-12). Calendar month corresponding precip_lag0. month_lag1 Integer vector (1-12). Calendar month corresponding precip_lag1. year_lag0 Optional integer vector. Calendar year water year corresponding precip_lag0. provided together year_lag1, transitions restricted -year pairs. year_lag1 Optional integer vector. Calendar year water year corresponding precip_lag1. wet_threshold Numeric vector length 12. Monthly precipitation thresholds separating dry wet states, aligned month_order. extreme_threshold Numeric vector length 12. Monthly precipitation thresholds separating wet wet states, aligned month_order. month_order Integer vector length 12 defining simulated ordering months (example 1:12 calendar years c(10:12, 1:9) October-start water years). sim_month Integer vector. Calendar month simulated day. sim_wyear Integer vector. Simulation year (calendar water year, depending regime) simulated day. year_idx Integer. Index current simulated year (1-based). sim_start_year Integer. First year simulation, interpreted calendar year water year depending simulation regime. dry_spell_factor_month Numeric vector length 12. Monthly multiplicative factors controlling dry-state persistence. wet_spell_factor_month Numeric vector length 12. Monthly multiplicative factors controlling wet-state persistence. n_days_sim Integer. Total number simulated days. Determines length returned probability vectors. dirichlet_alpha Numeric. Base smoothing strength transition-probability estimation. effective smoothing applied month dirichlet_alpha / sqrt(n_transitions_m), n_transitions_m number observed transitions month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"named list nine numeric vectors, length n_days_sim, representing time-varying transition probabilities: p00_final: P(dry dry) p01_final: P(dry wet) p02_final: P(dry wet) p10_final: P(wet dry) p11_final: P(wet wet) p12_final: P(wet wet) p20_final: P(wet dry) p21_final: P(wet wet) p22_final: P(wet wet)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/estimate_monthly_markov_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Monthly Occurrence-State Markov Transition Probabilities — estimate_monthly_markov_probs","text":"Precipitation occurrence states defined : Dry Precipitation less equal monthly wet threshold Wet Precipitation greater wet threshold less              equal extreme threshold wet Precipitation greater extreme threshold transition-probability rows explicitly normalized smoothing spell adjustments ensure valid Markov-chain behavior.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":null,"dir":"Reference","previous_headings":"","what":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"Run comprehensive diagnostic evaluation comparing synthetic weather simulations historical observations across multiple grid cells. Computes summary statistics, wet/dry day counts, spell lengths, inter-site correlations, generates diagnostic plots assess stochastic weather generator performance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"","code":"evaluate_weather_generator(   daily_sim = NULL,   daily_obs = NULL,   variables = NULL,   variable_labels = NULL,   n_realizations = NULL,   wet_quantile = 0.2,   extreme_quantile = 0.8,   output_dir = NULL,   save_plots = TRUE,   show_title = TRUE,   verbose = TRUE,   max_grids = 25,   seed = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"daily_sim List simulated weather realizations. element list data frames (one per grid cell), containing daily values `date` column. daily_obs List observed weather data frames (one per grid cell). contain `date` column variables specified `variables`. variables Character vector variable names evaluate (e.g., `c(\"precip\", \"temp\")`). Must include \"precip\" wet/dry spell analysis. variable_labels Optional character vector variable labels plots. Defaults `variables` `NULL`. n_realizations Integer. Number synthetic realizations `daily_sim`. wet_quantile Numeric 0 1. Quantile threshold wet days (default = 0.2). extreme_quantile Numeric 0 1. Quantile threshold extremely wet days (default = 0.8). output_dir Character. Directory path save generated plots. `NULL`, plots saved disk. save_plots Logical. Whether save plots `output_dir` (default = `TRUE`). show_title Logical. Whether display titles plots (default = `TRUE`). verbose Logical. Whether emit console messages fit summary table. max_grids Integer. Maximum number grid cells evaluate (default = 25). grids provided, random subsample used control memory. seed Optional integer. Random seed reproducible grid subsampling year window selection. NULL, results vary runs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"named list `ggplot2` plot objects class \"weather_assessment\".   returned object also contains attributes: fit_summary: data frame per-realization fit metrics ranks. metadata: list n_grids, n_realizations,       variables, assessment_date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"function standardizes simulated observed series full-year windows (leap-day removal), optionally subsamples grid cells manage memory, returns diagnostic plots alongside summarized fit table. Missing values ignored summary statistics (`na.rm = TRUE`), correlations use pairwise complete observations. Use `seed` reproducible subsampling window selection; original RNG state restored exit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/evaluate_weather_generator.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Evaluate Stochastic Weather Generator Performance — evaluate_weather_generator","text":"","code":"set.seed(1) dates <- seq.Date(as.Date(\"2001-01-01\"), as.Date(\"2001-12-31\"), by = \"day\") dates <- dates[format(dates, \"%m-%d\") != \"02-29\"] obs_grid <- list(data.frame(   date = dates,   precip = rgamma(length(dates), shape = 2, scale = 2),   temp = rnorm(length(dates), mean = 10, sd = 3) )) sim_grid <- list(list(data.frame(   date = dates,   precip = rgamma(length(dates), shape = 2, scale = 2),   temp = rnorm(length(dates), mean = 10, sd = 3) ))) out <- evaluate_weather_generator(   daily_sim = sim_grid,   daily_obs = obs_grid,   variables = c(\"precip\", \"temp\"),   n_realizations = 1,   output_dir = NULL,   save_plots = FALSE,   show_title = FALSE ) #> [2026-01-21 23:25:50] [EVAL] Start | grids = 1 | realizations = 1 #> [2026-01-21 23:25:50] [EVAL] Variables = precip,temp #> [2026-01-21 23:25:50] [EVAL] Parameters: wet.q = 0.2 | extreme.q = 0.8 #> [2026-01-21 23:25:50] [EVAL] Standardizing obs/sim periods to full years and equal length #> [2026-01-21 23:25:50] [EVAL] Standardized period | Obs = 2001-2001 | Sim = 2001-2001 #> [2026-01-21 23:25:50] [EVAL] Processing observed data #> [2026-01-21 23:25:50] [EVAL] Processing simulated data (1 realizations) #> [2026-01-21 23:25:50] [EVAL] Preparing diagnostic data for plotting #> [2026-01-21 23:25:50] [EVAL] Generating diagnostic plots #> Warning: There were 2 warnings in `dplyr::summarise()`. #> The first warning was: #> ℹ In argument: `.min = min(c(.data[[\"Observed\"]], .data[[\"Simulated\"]]), na.rm #>   = TRUE)`. #> Caused by warning in `min()`: #> ! no non-missing arguments to min; returning Inf #> ℹ Run dplyr::last_dplyr_warnings() to see the 1 remaining warning. #> [2026-01-21 23:25:51] [EVAL] Generated 11 diagnostic plots. #> [2026-01-21 23:25:51] [EVAL] Computing fit metrics for all realizations #> Warning: There were 2 warnings in `dplyr::mutate()`. #> The first warning was: #> ℹ In argument: `dplyr::across(...)`. #> Caused by warning in `min()`: #> ! no non-missing arguments to min; returning Inf #> ℹ Run dplyr::last_dplyr_warnings() to see the 1 remaining warning. #> [2026-01-21 23:25:51] [EVAL] Displaying fit assessment summary #>  #> ===============================================================================================  #>  FIT ASSESSMENT SUMMARY - ALL REALIZATIONS #> ===============================================================================================  #>  #>  Metrics shown (Mean Absolute Error, lower is better): #>   MAE measures average magnitude of errors between simulated and observed #>  #>   - Mean.precip   : MAE of monthly means #>   - SD.precip     : MAE of monthly standard deviations #>   - Days.Wet   : MAE of wet/dry day counts #>   - Spell.Wet  : MAE of wet/dry spell lengths (days) #>   - Cor.Cross   : MAE of cross-grid correlations #>   - Cor.Inter   : MAE of inter-variable correlations #>   - Score       : Normalized overall score across all metrics #>  #>    Rlz   Rank   Mean.precip   SD.precip   Days.Wet   Spell.Wet   Cor.Cross   Cor.Inter    Score  #> -----------------------------------------------------------------------------------------------  #>      1      1        1.6773      1.1552    11.5091     10.2257          NA      0.0479   0.0000  #> ===============================================================================================  #>  #>  Summary: #>   - Best realization  : 1 (score = 0.0000) #>   - Worst realization : 1 (score = 0.0000) #>   - Median score      : 0.0000 #>  #> [2026-01-21 23:25:51] [EVAL] Assessment completed successfully class(out) #> [1] \"weather_assessment\" \"list\""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Expand Index Positions by Fixed Offsets — expand_indices","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"Expands vector base index positions adding set integer offsets, returning valid index positions within specified upper bound. typically used generate moving windows neighborhood indices around reference positions (e.g., expanding event days adjacent days).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"","code":"expand_indices(base_idx, offset_vec, n_max)"},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"base_idx Integer vector base index positions expanded. offset_vec Integer vector offsets apply element base_idx. Offsets may positive, negative, zero. n_max Integer. Maximum allowable index length; expanded indices constrained range 1:(n_max - 1).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"Integer vector expanded index positions satisfy validity constraints.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"element base_idx, values offset_vec added. Resulting indices less equal zero, index + 1 > n_max, discarded. function enforce uniqueness sorting output.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/expand_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Expand Index Positions by Fixed Offsets — expand_indices","text":"","code":"base_idx <- c(5, 10) offset_vec <- -1:1 weathergenr:::expand_indices(base_idx, offset_vec, n_max = 15) #> [1]  4  5  6  9 10 11"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Global-Spectrum Significance Curve — extract_signif_curve","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"Extracts global-spectrum significance curve wavelet analysis output list. Intended small compatibility helper downstream code expects single numeric vector. found, returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"","code":"extract_signif_curve(wavelet)"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"wavelet List output analyze_wavelet_spectrum.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_signif_curve.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Global-Spectrum Significance Curve — extract_signif_curve","text":"Numeric vector significance values, NULL found.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":null,"dir":"Reference","previous_headings":"","what":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"Reconstructs time-domain components selected wavelet scales using Torrence & Compo (1998) inverse transform approximation. Optionally adds residual component representing non-selected scales ensure additive closure.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"","code":"extract_wavelet_components(   wave,   signif_periods,   scale,   dj = 0.25,   dt = 1,   series_sd,   series_mean = 0,   Cdelta = 0.776,   w0_0 = pi^(-1/4),   include_residual = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"wave Complex matrix (scales x time). Wavelet coefficients. signif_periods Integer vector. Scale indices reconstruct. scale Numeric vector. Scale values aligned nrow(wave). dj Numeric scalar. Scale resolution used transform. dt Numeric scalar. Time step series. series_sd Numeric scalar. Standard deviation original series (pre-standardization). series_mean Numeric scalar. Mean original series; added back residual. Cdelta Numeric scalar. Morlet reconstruction constant (default: 0.776). w0_0 Numeric scalar. \\(\\psi_0(0)\\) constant (default: \\(\\pi^{-1/4}\\)). include_residual Logical. TRUE, adds residual (non-selected) component.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/extract_wavelet_components.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reconstruct Wavelet Components from Selected Scales — extract_wavelet_components","text":"Numeric matrix one column per selected component , requested,   final \"Noise\" residual column.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"Fills missing values numeric vector propagating nearest available non-missing value. deterministic forward-fill followed backward-fill. mainly used stabilize curves interpolation (e.g., regridded spectra).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"","code":"fill_nearest(x)"},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"x Numeric vector possibly containing NA.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fill_nearest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill NA Values with the Nearest Non-NA Neighbor — fill_nearest","text":"Numeric vector missing values filled. x NA,   returned unchanged.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":null,"dir":"Reference","previous_headings":"","what":"WARM filtering default bounds — filter_warm_bounds_defaults","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"Internal defaults filter_warm_pool() bounds. Users usually override entries via filter_bounds = list(...).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"","code":"filter_warm_bounds_defaults()"},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_bounds_defaults.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"WARM filtering default bounds — filter_warm_bounds_defaults","text":"Named list defaults (snake_case keys).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"Filters ensemble WARM-generated annual realizations observed annual series using three criterion families: Distributional: relative differences mean standard deviation. Tail behaviour: lower/upper tail mass relative observed quantile thresholds. Spectral: observed-relevant global wavelet spectrum (GWS) filtering. fewer n_select realizations pass, function relaxes criteria iteratively (filter_bounds$relax_max_iter) loosening currently restrictive active filter (lowest pass rate). still insufficient, deterministic fallback returns n_select realizations smallest absolute relative mean difference.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"","code":"filter_warm_pool(   obs_series = NULL,   sim_series = NULL,   n_select = 5,   seed = NULL,   pad_periods = TRUE,   relax_order = c(\"wavelet\", \"sd\", \"tail_low\", \"tail_high\", \"mean\"),   filter_bounds = list(),   wavelet_args = list(signif_level = 0.8, noise_type = \"red\", period_lower_limit = 2,     detrend = TRUE),   make_plots = FALSE,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"obs_series Numeric vector. Observed annual series used reference. sim_series Numeric matrix. Simulated annual realizations years rows realizations columns. n_select Integer scalar. Number realizations return selected. seed Optional integer scalar. Random seed used window selection (lengths differ) sampling final candidate pool. pad_periods Logical scalar. TRUE, expands observed significant-period band one index side checking simulated presence observed-relevant band. relax_order Character vector. Relaxation priority ordering criteria. Must contain c(\"mean\",\"sd\",\"tail_low\",\"tail_high\",\"wavelet\") exactly . filter_bounds Named list. Filtering thresholds relaxation controls. entry overrides internal defaults. Uses snake_case keys (e.g. tail_low_p, tail.low.p). wavelet_args Named list passed analyze_wavelet_spectrum observed simulated series (e.g., signif_level, noise_type, period_lower_limit, detrend). make_plots Logical scalar. TRUE, returns diagnostic plots plots. verbose Logical scalar. TRUE, logs per-iteration pass rates relaxation steps.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/filter_warm_pool.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter and sample WARM realizations using distributional, tail, and wavelet criteria — filter_warm_pool","text":"list : pool Numeric matrix. Final candidate pool (subset columns sim_series). selected Numeric matrix. n_select realizations selected final pool. summary Data frame summarising pass counts/rates selection mode. diagnostics List window metadata, indices, relaxation log, final bounds. plots NULL named list ggplot objects make_plots = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"Scans vector dates returns integer indices elements correspond February 29. vector contains leap days, returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"","code":"find_leap_day_indices(date)"},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"date vector coercible Date.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"Integer vector indices dates equal February 29, NULL none.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/find_leap_day_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Find leap-day (Feb 29) indices in a date vector — find_leap_day_indices","text":"","code":"find_leap_day_indices(as.Date(c(\"1980-02-28\", \"1980-02-29\", \"1981-01-01\"))) #> [1] 2 find_leap_day_indices(as.Date(c(\"2001-01-01\", \"2001-12-31\"))) #> NULL"},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":null,"dir":"Reference","previous_headings":"","what":"Fit Monthly Gamma Distributions for Wet-Day Precipitation — fit_monthly_distributions","title":"Fit Monthly Gamma Distributions for Wet-Day Precipitation — fit_monthly_distributions","text":"Fits gamma distribution wet-day precipitation amounts month `months_ok`. Uses `fitdistrplus::fitdist()` returns month-specific gamma parameters implied moments. Months fail fit dropped.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fit Monthly Gamma Distributions for Wet-Day Precipitation — fit_monthly_distributions","text":"","code":"fit_monthly_distributions(   precip_wet,   month_wet,   months_ok,   fit_method,   verbose )"},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fit Monthly Gamma Distributions for Wet-Day Precipitation — fit_monthly_distributions","text":"precip_wet Numeric vector wet-day precipitation values (strictly > 0 recommended). Length must match `month_wet`. month_wet Integer vector months (1-12) corresponding element `precip_wet`. months_ok Integer vector months attempt fitting (subset 1-12). fit_method Character scalar. Estimation method forwarded `fitdistrplus::fitdist()` (e.g., `\"mle\"`, `\"mme\"`). verbose Logical. `TRUE`, emits warning monthly fit fails.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/fit_monthly_distributions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fit Monthly Gamma Distributions for Wet-Day Precipitation — fit_monthly_distributions","text":"`data.frame` columns: `month` Month number. `shape` Gamma shape parameter. `scale` Gamma scale parameter. `mean` Implied mean (`shape * scale`). `var` Implied variance (`shape * scale^2`). Months failed fits removed. returned data frame attribute `n_failed_fits` number failed months.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/format_elapsed.html","id":null,"dir":"Reference","previous_headings":"","what":"Format Elapsed Time for Display — format_elapsed","title":"Format Elapsed Time for Display — format_elapsed","text":"Computes elapsed time start time formats human-readable string appropriate units (seconds, minutes, hours).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/format_elapsed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format Elapsed Time for Display — format_elapsed","text":"","code":"format_elapsed(start_time)"},{"path":"https://deltares-research.github.io/weathergenr/reference/format_elapsed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format Elapsed Time for Display — format_elapsed","text":"start_time POSIXct object. start time measure .","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/format_elapsed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format Elapsed Time for Display — format_elapsed","text":"Character string formatted elapsed time.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"Constructs continuous sequence dates starting given start date, using -leap calendar (.e., February 29 removed). function repeats 365-day month-day template increments year every 365 days.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"","code":"generate_noleap_dates(start_date, n_days)"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"start_date Date character coercible Date. first date sequence. date February 29, mapped February 28 -leap template include Feb 29. n_days Integer. Total number dates generate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"vector class Date length n_days, following   -leap (365-day) calendar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_noleap_dates.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a no-leap (365-day) daily date sequence — generate_noleap_dates","text":"","code":"generate_noleap_dates(\"1980-01-01\", 365) #>   [1] \"1980-01-01\" \"1980-01-02\" \"1980-01-03\" \"1980-01-04\" \"1980-01-05\" #>   [6] \"1980-01-06\" \"1980-01-07\" \"1980-01-08\" \"1980-01-09\" \"1980-01-10\" #>  [11] \"1980-01-11\" \"1980-01-12\" \"1980-01-13\" \"1980-01-14\" \"1980-01-15\" #>  [16] \"1980-01-16\" \"1980-01-17\" \"1980-01-18\" \"1980-01-19\" \"1980-01-20\" #>  [21] \"1980-01-21\" \"1980-01-22\" \"1980-01-23\" \"1980-01-24\" \"1980-01-25\" #>  [26] \"1980-01-26\" \"1980-01-27\" \"1980-01-28\" \"1980-01-29\" \"1980-01-30\" #>  [31] \"1980-01-31\" \"1980-02-01\" \"1980-02-02\" \"1980-02-03\" \"1980-02-04\" #>  [36] \"1980-02-05\" \"1980-02-06\" \"1980-02-07\" \"1980-02-08\" \"1980-02-09\" #>  [41] \"1980-02-10\" \"1980-02-11\" \"1980-02-12\" \"1980-02-13\" \"1980-02-14\" #>  [46] \"1980-02-15\" \"1980-02-16\" \"1980-02-17\" \"1980-02-18\" \"1980-02-19\" #>  [51] \"1980-02-20\" \"1980-02-21\" \"1980-02-22\" \"1980-02-23\" \"1980-02-24\" #>  [56] \"1980-02-25\" \"1980-02-26\" \"1980-02-27\" \"1980-02-28\" \"1980-03-01\" #>  [61] \"1980-03-02\" \"1980-03-03\" \"1980-03-04\" \"1980-03-05\" \"1980-03-06\" #>  [66] \"1980-03-07\" \"1980-03-08\" \"1980-03-09\" \"1980-03-10\" \"1980-03-11\" #>  [71] \"1980-03-12\" \"1980-03-13\" \"1980-03-14\" \"1980-03-15\" \"1980-03-16\" #>  [76] \"1980-03-17\" \"1980-03-18\" \"1980-03-19\" \"1980-03-20\" \"1980-03-21\" #>  [81] \"1980-03-22\" \"1980-03-23\" \"1980-03-24\" \"1980-03-25\" \"1980-03-26\" #>  [86] \"1980-03-27\" \"1980-03-28\" \"1980-03-29\" \"1980-03-30\" \"1980-03-31\" #>  [91] \"1980-04-01\" \"1980-04-02\" \"1980-04-03\" \"1980-04-04\" \"1980-04-05\" #>  [96] \"1980-04-06\" \"1980-04-07\" \"1980-04-08\" \"1980-04-09\" \"1980-04-10\" #> [101] \"1980-04-11\" \"1980-04-12\" \"1980-04-13\" \"1980-04-14\" \"1980-04-15\" #> [106] \"1980-04-16\" \"1980-04-17\" \"1980-04-18\" \"1980-04-19\" \"1980-04-20\" #> [111] \"1980-04-21\" \"1980-04-22\" \"1980-04-23\" \"1980-04-24\" \"1980-04-25\" #> [116] \"1980-04-26\" \"1980-04-27\" \"1980-04-28\" \"1980-04-29\" \"1980-04-30\" #> [121] \"1980-05-01\" \"1980-05-02\" \"1980-05-03\" \"1980-05-04\" \"1980-05-05\" #> [126] \"1980-05-06\" \"1980-05-07\" \"1980-05-08\" \"1980-05-09\" \"1980-05-10\" #> [131] \"1980-05-11\" \"1980-05-12\" \"1980-05-13\" \"1980-05-14\" \"1980-05-15\" #> [136] \"1980-05-16\" \"1980-05-17\" \"1980-05-18\" \"1980-05-19\" \"1980-05-20\" #> [141] \"1980-05-21\" \"1980-05-22\" \"1980-05-23\" \"1980-05-24\" \"1980-05-25\" #> [146] \"1980-05-26\" \"1980-05-27\" \"1980-05-28\" \"1980-05-29\" \"1980-05-30\" #> [151] \"1980-05-31\" \"1980-06-01\" \"1980-06-02\" \"1980-06-03\" \"1980-06-04\" #> [156] \"1980-06-05\" \"1980-06-06\" \"1980-06-07\" \"1980-06-08\" \"1980-06-09\" #> [161] \"1980-06-10\" \"1980-06-11\" \"1980-06-12\" \"1980-06-13\" \"1980-06-14\" #> [166] \"1980-06-15\" \"1980-06-16\" \"1980-06-17\" \"1980-06-18\" \"1980-06-19\" #> [171] \"1980-06-20\" \"1980-06-21\" \"1980-06-22\" \"1980-06-23\" \"1980-06-24\" #> [176] \"1980-06-25\" \"1980-06-26\" \"1980-06-27\" \"1980-06-28\" \"1980-06-29\" #> [181] \"1980-06-30\" \"1980-07-01\" \"1980-07-02\" \"1980-07-03\" \"1980-07-04\" #> [186] \"1980-07-05\" \"1980-07-06\" \"1980-07-07\" \"1980-07-08\" \"1980-07-09\" #> [191] \"1980-07-10\" \"1980-07-11\" \"1980-07-12\" \"1980-07-13\" \"1980-07-14\" #> [196] \"1980-07-15\" \"1980-07-16\" \"1980-07-17\" \"1980-07-18\" \"1980-07-19\" #> [201] \"1980-07-20\" \"1980-07-21\" \"1980-07-22\" \"1980-07-23\" \"1980-07-24\" #> [206] \"1980-07-25\" \"1980-07-26\" \"1980-07-27\" \"1980-07-28\" \"1980-07-29\" #> [211] \"1980-07-30\" \"1980-07-31\" \"1980-08-01\" \"1980-08-02\" \"1980-08-03\" #> [216] \"1980-08-04\" \"1980-08-05\" \"1980-08-06\" \"1980-08-07\" \"1980-08-08\" #> [221] \"1980-08-09\" \"1980-08-10\" \"1980-08-11\" \"1980-08-12\" \"1980-08-13\" #> [226] \"1980-08-14\" \"1980-08-15\" \"1980-08-16\" \"1980-08-17\" \"1980-08-18\" #> [231] \"1980-08-19\" \"1980-08-20\" \"1980-08-21\" \"1980-08-22\" \"1980-08-23\" #> [236] \"1980-08-24\" \"1980-08-25\" \"1980-08-26\" \"1980-08-27\" \"1980-08-28\" #> [241] \"1980-08-29\" \"1980-08-30\" \"1980-08-31\" \"1980-09-01\" \"1980-09-02\" #> [246] \"1980-09-03\" \"1980-09-04\" \"1980-09-05\" \"1980-09-06\" \"1980-09-07\" #> [251] \"1980-09-08\" \"1980-09-09\" \"1980-09-10\" \"1980-09-11\" \"1980-09-12\" #> [256] \"1980-09-13\" \"1980-09-14\" \"1980-09-15\" \"1980-09-16\" \"1980-09-17\" #> [261] \"1980-09-18\" \"1980-09-19\" \"1980-09-20\" \"1980-09-21\" \"1980-09-22\" #> [266] \"1980-09-23\" \"1980-09-24\" \"1980-09-25\" \"1980-09-26\" \"1980-09-27\" #> [271] \"1980-09-28\" \"1980-09-29\" \"1980-09-30\" \"1980-10-01\" \"1980-10-02\" #> [276] \"1980-10-03\" \"1980-10-04\" \"1980-10-05\" \"1980-10-06\" \"1980-10-07\" #> [281] \"1980-10-08\" \"1980-10-09\" \"1980-10-10\" \"1980-10-11\" \"1980-10-12\" #> [286] \"1980-10-13\" \"1980-10-14\" \"1980-10-15\" \"1980-10-16\" \"1980-10-17\" #> [291] \"1980-10-18\" \"1980-10-19\" \"1980-10-20\" \"1980-10-21\" \"1980-10-22\" #> [296] \"1980-10-23\" \"1980-10-24\" \"1980-10-25\" \"1980-10-26\" \"1980-10-27\" #> [301] \"1980-10-28\" \"1980-10-29\" \"1980-10-30\" \"1980-10-31\" \"1980-11-01\" #> [306] \"1980-11-02\" \"1980-11-03\" \"1980-11-04\" \"1980-11-05\" \"1980-11-06\" #> [311] \"1980-11-07\" \"1980-11-08\" \"1980-11-09\" \"1980-11-10\" \"1980-11-11\" #> [316] \"1980-11-12\" \"1980-11-13\" \"1980-11-14\" \"1980-11-15\" \"1980-11-16\" #> [321] \"1980-11-17\" \"1980-11-18\" \"1980-11-19\" \"1980-11-20\" \"1980-11-21\" #> [326] \"1980-11-22\" \"1980-11-23\" \"1980-11-24\" \"1980-11-25\" \"1980-11-26\" #> [331] \"1980-11-27\" \"1980-11-28\" \"1980-11-29\" \"1980-11-30\" \"1980-12-01\" #> [336] \"1980-12-02\" \"1980-12-03\" \"1980-12-04\" \"1980-12-05\" \"1980-12-06\" #> [341] \"1980-12-07\" \"1980-12-08\" \"1980-12-09\" \"1980-12-10\" \"1980-12-11\" #> [346] \"1980-12-12\" \"1980-12-13\" \"1980-12-14\" \"1980-12-15\" \"1980-12-16\" #> [351] \"1980-12-17\" \"1980-12-18\" \"1980-12-19\" \"1980-12-20\" \"1980-12-21\" #> [356] \"1980-12-22\" \"1980-12-23\" \"1980-12-24\" \"1980-12-25\" \"1980-12-26\" #> [361] \"1980-12-27\" \"1980-12-28\" \"1980-12-29\" \"1980-12-30\" \"1980-12-31\" generate_noleap_dates(as.Date(\"1995-02-28\"), 1000) #>    [1] \"1995-02-28\" \"1995-03-01\" \"1995-03-02\" \"1995-03-03\" \"1995-03-04\" #>    [6] \"1995-03-05\" \"1995-03-06\" \"1995-03-07\" \"1995-03-08\" \"1995-03-09\" #>   [11] \"1995-03-10\" \"1995-03-11\" \"1995-03-12\" \"1995-03-13\" \"1995-03-14\" #>   [16] \"1995-03-15\" \"1995-03-16\" \"1995-03-17\" \"1995-03-18\" \"1995-03-19\" #>   [21] \"1995-03-20\" \"1995-03-21\" \"1995-03-22\" \"1995-03-23\" \"1995-03-24\" #>   [26] \"1995-03-25\" \"1995-03-26\" \"1995-03-27\" \"1995-03-28\" \"1995-03-29\" #>   [31] \"1995-03-30\" \"1995-03-31\" \"1995-04-01\" \"1995-04-02\" \"1995-04-03\" #>   [36] \"1995-04-04\" \"1995-04-05\" \"1995-04-06\" \"1995-04-07\" \"1995-04-08\" #>   [41] \"1995-04-09\" \"1995-04-10\" \"1995-04-11\" \"1995-04-12\" \"1995-04-13\" #>   [46] \"1995-04-14\" \"1995-04-15\" \"1995-04-16\" \"1995-04-17\" \"1995-04-18\" #>   [51] \"1995-04-19\" \"1995-04-20\" \"1995-04-21\" \"1995-04-22\" \"1995-04-23\" #>   [56] \"1995-04-24\" \"1995-04-25\" \"1995-04-26\" \"1995-04-27\" \"1995-04-28\" #>   [61] \"1995-04-29\" \"1995-04-30\" \"1995-05-01\" \"1995-05-02\" \"1995-05-03\" #>   [66] \"1995-05-04\" \"1995-05-05\" \"1995-05-06\" \"1995-05-07\" \"1995-05-08\" #>   [71] \"1995-05-09\" \"1995-05-10\" \"1995-05-11\" \"1995-05-12\" \"1995-05-13\" #>   [76] \"1995-05-14\" \"1995-05-15\" \"1995-05-16\" \"1995-05-17\" \"1995-05-18\" #>   [81] \"1995-05-19\" \"1995-05-20\" \"1995-05-21\" \"1995-05-22\" \"1995-05-23\" #>   [86] \"1995-05-24\" \"1995-05-25\" \"1995-05-26\" \"1995-05-27\" \"1995-05-28\" #>   [91] \"1995-05-29\" \"1995-05-30\" \"1995-05-31\" \"1995-06-01\" \"1995-06-02\" #>   [96] \"1995-06-03\" \"1995-06-04\" \"1995-06-05\" \"1995-06-06\" \"1995-06-07\" #>  [101] \"1995-06-08\" \"1995-06-09\" \"1995-06-10\" \"1995-06-11\" \"1995-06-12\" #>  [106] \"1995-06-13\" \"1995-06-14\" \"1995-06-15\" \"1995-06-16\" \"1995-06-17\" #>  [111] \"1995-06-18\" \"1995-06-19\" \"1995-06-20\" \"1995-06-21\" \"1995-06-22\" #>  [116] \"1995-06-23\" \"1995-06-24\" \"1995-06-25\" \"1995-06-26\" \"1995-06-27\" #>  [121] \"1995-06-28\" \"1995-06-29\" \"1995-06-30\" \"1995-07-01\" \"1995-07-02\" #>  [126] \"1995-07-03\" \"1995-07-04\" \"1995-07-05\" \"1995-07-06\" \"1995-07-07\" #>  [131] \"1995-07-08\" \"1995-07-09\" \"1995-07-10\" \"1995-07-11\" \"1995-07-12\" #>  [136] \"1995-07-13\" \"1995-07-14\" \"1995-07-15\" \"1995-07-16\" \"1995-07-17\" #>  [141] \"1995-07-18\" \"1995-07-19\" \"1995-07-20\" \"1995-07-21\" \"1995-07-22\" #>  [146] \"1995-07-23\" \"1995-07-24\" \"1995-07-25\" \"1995-07-26\" \"1995-07-27\" #>  [151] \"1995-07-28\" \"1995-07-29\" \"1995-07-30\" \"1995-07-31\" \"1995-08-01\" #>  [156] \"1995-08-02\" \"1995-08-03\" \"1995-08-04\" \"1995-08-05\" \"1995-08-06\" #>  [161] \"1995-08-07\" \"1995-08-08\" \"1995-08-09\" \"1995-08-10\" \"1995-08-11\" #>  [166] \"1995-08-12\" \"1995-08-13\" \"1995-08-14\" \"1995-08-15\" \"1995-08-16\" #>  [171] \"1995-08-17\" \"1995-08-18\" \"1995-08-19\" \"1995-08-20\" \"1995-08-21\" #>  [176] \"1995-08-22\" \"1995-08-23\" \"1995-08-24\" \"1995-08-25\" \"1995-08-26\" #>  [181] \"1995-08-27\" \"1995-08-28\" \"1995-08-29\" \"1995-08-30\" \"1995-08-31\" #>  [186] \"1995-09-01\" \"1995-09-02\" \"1995-09-03\" \"1995-09-04\" \"1995-09-05\" #>  [191] \"1995-09-06\" \"1995-09-07\" \"1995-09-08\" \"1995-09-09\" \"1995-09-10\" #>  [196] \"1995-09-11\" \"1995-09-12\" \"1995-09-13\" \"1995-09-14\" \"1995-09-15\" #>  [201] \"1995-09-16\" \"1995-09-17\" \"1995-09-18\" \"1995-09-19\" \"1995-09-20\" #>  [206] \"1995-09-21\" \"1995-09-22\" \"1995-09-23\" \"1995-09-24\" \"1995-09-25\" #>  [211] \"1995-09-26\" \"1995-09-27\" \"1995-09-28\" \"1995-09-29\" \"1995-09-30\" #>  [216] \"1995-10-01\" \"1995-10-02\" \"1995-10-03\" \"1995-10-04\" \"1995-10-05\" #>  [221] \"1995-10-06\" \"1995-10-07\" \"1995-10-08\" \"1995-10-09\" \"1995-10-10\" #>  [226] \"1995-10-11\" \"1995-10-12\" \"1995-10-13\" \"1995-10-14\" \"1995-10-15\" #>  [231] \"1995-10-16\" \"1995-10-17\" \"1995-10-18\" \"1995-10-19\" \"1995-10-20\" #>  [236] \"1995-10-21\" \"1995-10-22\" \"1995-10-23\" \"1995-10-24\" \"1995-10-25\" #>  [241] \"1995-10-26\" \"1995-10-27\" \"1995-10-28\" \"1995-10-29\" \"1995-10-30\" #>  [246] \"1995-10-31\" \"1995-11-01\" \"1995-11-02\" \"1995-11-03\" \"1995-11-04\" #>  [251] \"1995-11-05\" \"1995-11-06\" \"1995-11-07\" \"1995-11-08\" \"1995-11-09\" #>  [256] \"1995-11-10\" \"1995-11-11\" \"1995-11-12\" \"1995-11-13\" \"1995-11-14\" #>  [261] \"1995-11-15\" \"1995-11-16\" \"1995-11-17\" \"1995-11-18\" \"1995-11-19\" #>  [266] \"1995-11-20\" \"1995-11-21\" \"1995-11-22\" \"1995-11-23\" \"1995-11-24\" #>  [271] \"1995-11-25\" \"1995-11-26\" \"1995-11-27\" \"1995-11-28\" \"1995-11-29\" #>  [276] \"1995-11-30\" \"1995-12-01\" \"1995-12-02\" \"1995-12-03\" \"1995-12-04\" #>  [281] \"1995-12-05\" \"1995-12-06\" \"1995-12-07\" \"1995-12-08\" \"1995-12-09\" #>  [286] \"1995-12-10\" \"1995-12-11\" \"1995-12-12\" \"1995-12-13\" \"1995-12-14\" #>  [291] \"1995-12-15\" \"1995-12-16\" \"1995-12-17\" \"1995-12-18\" \"1995-12-19\" #>  [296] \"1995-12-20\" \"1995-12-21\" \"1995-12-22\" \"1995-12-23\" \"1995-12-24\" #>  [301] \"1995-12-25\" \"1995-12-26\" \"1995-12-27\" \"1995-12-28\" \"1995-12-29\" #>  [306] \"1995-12-30\" \"1995-12-31\" \"1996-01-01\" \"1996-01-02\" \"1996-01-03\" #>  [311] \"1996-01-04\" \"1996-01-05\" \"1996-01-06\" \"1996-01-07\" \"1996-01-08\" #>  [316] \"1996-01-09\" \"1996-01-10\" \"1996-01-11\" \"1996-01-12\" \"1996-01-13\" #>  [321] \"1996-01-14\" \"1996-01-15\" \"1996-01-16\" \"1996-01-17\" \"1996-01-18\" #>  [326] \"1996-01-19\" \"1996-01-20\" \"1996-01-21\" \"1996-01-22\" \"1996-01-23\" #>  [331] \"1996-01-24\" \"1996-01-25\" \"1996-01-26\" \"1996-01-27\" \"1996-01-28\" #>  [336] \"1996-01-29\" \"1996-01-30\" \"1996-01-31\" \"1996-02-01\" \"1996-02-02\" #>  [341] \"1996-02-03\" \"1996-02-04\" \"1996-02-05\" \"1996-02-06\" \"1996-02-07\" #>  [346] \"1996-02-08\" \"1996-02-09\" \"1996-02-10\" \"1996-02-11\" \"1996-02-12\" #>  [351] \"1996-02-13\" \"1996-02-14\" \"1996-02-15\" \"1996-02-16\" \"1996-02-17\" #>  [356] \"1996-02-18\" \"1996-02-19\" \"1996-02-20\" \"1996-02-21\" \"1996-02-22\" #>  [361] \"1996-02-23\" \"1996-02-24\" \"1996-02-25\" \"1996-02-26\" \"1996-02-27\" #>  [366] \"1996-02-28\" \"1996-03-01\" \"1996-03-02\" \"1996-03-03\" \"1996-03-04\" #>  [371] \"1996-03-05\" \"1996-03-06\" \"1996-03-07\" \"1996-03-08\" \"1996-03-09\" #>  [376] \"1996-03-10\" \"1996-03-11\" \"1996-03-12\" \"1996-03-13\" \"1996-03-14\" #>  [381] \"1996-03-15\" \"1996-03-16\" \"1996-03-17\" \"1996-03-18\" \"1996-03-19\" #>  [386] \"1996-03-20\" \"1996-03-21\" \"1996-03-22\" \"1996-03-23\" \"1996-03-24\" #>  [391] \"1996-03-25\" \"1996-03-26\" \"1996-03-27\" \"1996-03-28\" \"1996-03-29\" #>  [396] \"1996-03-30\" \"1996-03-31\" \"1996-04-01\" \"1996-04-02\" \"1996-04-03\" #>  [401] \"1996-04-04\" \"1996-04-05\" \"1996-04-06\" \"1996-04-07\" \"1996-04-08\" #>  [406] \"1996-04-09\" \"1996-04-10\" \"1996-04-11\" \"1996-04-12\" \"1996-04-13\" #>  [411] \"1996-04-14\" \"1996-04-15\" \"1996-04-16\" \"1996-04-17\" \"1996-04-18\" #>  [416] \"1996-04-19\" \"1996-04-20\" \"1996-04-21\" \"1996-04-22\" \"1996-04-23\" #>  [421] \"1996-04-24\" \"1996-04-25\" \"1996-04-26\" \"1996-04-27\" \"1996-04-28\" #>  [426] \"1996-04-29\" \"1996-04-30\" \"1996-05-01\" \"1996-05-02\" \"1996-05-03\" #>  [431] \"1996-05-04\" \"1996-05-05\" \"1996-05-06\" \"1996-05-07\" \"1996-05-08\" #>  [436] \"1996-05-09\" \"1996-05-10\" \"1996-05-11\" \"1996-05-12\" \"1996-05-13\" #>  [441] \"1996-05-14\" \"1996-05-15\" \"1996-05-16\" \"1996-05-17\" \"1996-05-18\" #>  [446] \"1996-05-19\" \"1996-05-20\" \"1996-05-21\" \"1996-05-22\" \"1996-05-23\" #>  [451] \"1996-05-24\" \"1996-05-25\" \"1996-05-26\" \"1996-05-27\" \"1996-05-28\" #>  [456] \"1996-05-29\" \"1996-05-30\" \"1996-05-31\" \"1996-06-01\" \"1996-06-02\" #>  [461] \"1996-06-03\" \"1996-06-04\" \"1996-06-05\" \"1996-06-06\" \"1996-06-07\" #>  [466] \"1996-06-08\" \"1996-06-09\" \"1996-06-10\" \"1996-06-11\" \"1996-06-12\" #>  [471] \"1996-06-13\" \"1996-06-14\" \"1996-06-15\" \"1996-06-16\" \"1996-06-17\" #>  [476] \"1996-06-18\" \"1996-06-19\" \"1996-06-20\" \"1996-06-21\" \"1996-06-22\" #>  [481] \"1996-06-23\" \"1996-06-24\" \"1996-06-25\" \"1996-06-26\" \"1996-06-27\" #>  [486] \"1996-06-28\" \"1996-06-29\" \"1996-06-30\" \"1996-07-01\" \"1996-07-02\" #>  [491] \"1996-07-03\" \"1996-07-04\" \"1996-07-05\" \"1996-07-06\" \"1996-07-07\" #>  [496] \"1996-07-08\" \"1996-07-09\" \"1996-07-10\" \"1996-07-11\" \"1996-07-12\" #>  [501] \"1996-07-13\" \"1996-07-14\" \"1996-07-15\" \"1996-07-16\" \"1996-07-17\" #>  [506] \"1996-07-18\" \"1996-07-19\" \"1996-07-20\" \"1996-07-21\" \"1996-07-22\" #>  [511] \"1996-07-23\" \"1996-07-24\" \"1996-07-25\" \"1996-07-26\" \"1996-07-27\" #>  [516] \"1996-07-28\" \"1996-07-29\" \"1996-07-30\" \"1996-07-31\" \"1996-08-01\" #>  [521] \"1996-08-02\" \"1996-08-03\" \"1996-08-04\" \"1996-08-05\" \"1996-08-06\" #>  [526] \"1996-08-07\" \"1996-08-08\" \"1996-08-09\" \"1996-08-10\" \"1996-08-11\" #>  [531] \"1996-08-12\" \"1996-08-13\" \"1996-08-14\" \"1996-08-15\" \"1996-08-16\" #>  [536] \"1996-08-17\" \"1996-08-18\" \"1996-08-19\" \"1996-08-20\" \"1996-08-21\" #>  [541] \"1996-08-22\" \"1996-08-23\" \"1996-08-24\" \"1996-08-25\" \"1996-08-26\" #>  [546] \"1996-08-27\" \"1996-08-28\" \"1996-08-29\" \"1996-08-30\" \"1996-08-31\" #>  [551] \"1996-09-01\" \"1996-09-02\" \"1996-09-03\" \"1996-09-04\" \"1996-09-05\" #>  [556] \"1996-09-06\" \"1996-09-07\" \"1996-09-08\" \"1996-09-09\" \"1996-09-10\" #>  [561] \"1996-09-11\" \"1996-09-12\" \"1996-09-13\" \"1996-09-14\" \"1996-09-15\" #>  [566] \"1996-09-16\" \"1996-09-17\" \"1996-09-18\" \"1996-09-19\" \"1996-09-20\" #>  [571] \"1996-09-21\" \"1996-09-22\" \"1996-09-23\" \"1996-09-24\" \"1996-09-25\" #>  [576] \"1996-09-26\" \"1996-09-27\" \"1996-09-28\" \"1996-09-29\" \"1996-09-30\" #>  [581] \"1996-10-01\" \"1996-10-02\" \"1996-10-03\" \"1996-10-04\" \"1996-10-05\" #>  [586] \"1996-10-06\" \"1996-10-07\" \"1996-10-08\" \"1996-10-09\" \"1996-10-10\" #>  [591] \"1996-10-11\" \"1996-10-12\" \"1996-10-13\" \"1996-10-14\" \"1996-10-15\" #>  [596] \"1996-10-16\" \"1996-10-17\" \"1996-10-18\" \"1996-10-19\" \"1996-10-20\" #>  [601] \"1996-10-21\" \"1996-10-22\" \"1996-10-23\" \"1996-10-24\" \"1996-10-25\" #>  [606] \"1996-10-26\" \"1996-10-27\" \"1996-10-28\" \"1996-10-29\" \"1996-10-30\" #>  [611] \"1996-10-31\" \"1996-11-01\" \"1996-11-02\" \"1996-11-03\" \"1996-11-04\" #>  [616] \"1996-11-05\" \"1996-11-06\" \"1996-11-07\" \"1996-11-08\" \"1996-11-09\" #>  [621] \"1996-11-10\" \"1996-11-11\" \"1996-11-12\" \"1996-11-13\" \"1996-11-14\" #>  [626] \"1996-11-15\" \"1996-11-16\" \"1996-11-17\" \"1996-11-18\" \"1996-11-19\" #>  [631] \"1996-11-20\" \"1996-11-21\" \"1996-11-22\" \"1996-11-23\" \"1996-11-24\" #>  [636] \"1996-11-25\" \"1996-11-26\" \"1996-11-27\" \"1996-11-28\" \"1996-11-29\" #>  [641] \"1996-11-30\" \"1996-12-01\" \"1996-12-02\" \"1996-12-03\" \"1996-12-04\" #>  [646] \"1996-12-05\" \"1996-12-06\" \"1996-12-07\" \"1996-12-08\" \"1996-12-09\" #>  [651] \"1996-12-10\" \"1996-12-11\" \"1996-12-12\" \"1996-12-13\" \"1996-12-14\" #>  [656] \"1996-12-15\" \"1996-12-16\" \"1996-12-17\" \"1996-12-18\" \"1996-12-19\" #>  [661] \"1996-12-20\" \"1996-12-21\" \"1996-12-22\" \"1996-12-23\" \"1996-12-24\" #>  [666] \"1996-12-25\" \"1996-12-26\" \"1996-12-27\" \"1996-12-28\" \"1996-12-29\" #>  [671] \"1996-12-30\" \"1996-12-31\" \"1997-01-01\" \"1997-01-02\" \"1997-01-03\" #>  [676] \"1997-01-04\" \"1997-01-05\" \"1997-01-06\" \"1997-01-07\" \"1997-01-08\" #>  [681] \"1997-01-09\" \"1997-01-10\" \"1997-01-11\" \"1997-01-12\" \"1997-01-13\" #>  [686] \"1997-01-14\" \"1997-01-15\" \"1997-01-16\" \"1997-01-17\" \"1997-01-18\" #>  [691] \"1997-01-19\" \"1997-01-20\" \"1997-01-21\" \"1997-01-22\" \"1997-01-23\" #>  [696] \"1997-01-24\" \"1997-01-25\" \"1997-01-26\" \"1997-01-27\" \"1997-01-28\" #>  [701] \"1997-01-29\" \"1997-01-30\" \"1997-01-31\" \"1997-02-01\" \"1997-02-02\" #>  [706] \"1997-02-03\" \"1997-02-04\" \"1997-02-05\" \"1997-02-06\" \"1997-02-07\" #>  [711] \"1997-02-08\" \"1997-02-09\" \"1997-02-10\" \"1997-02-11\" \"1997-02-12\" #>  [716] \"1997-02-13\" \"1997-02-14\" \"1997-02-15\" \"1997-02-16\" \"1997-02-17\" #>  [721] \"1997-02-18\" \"1997-02-19\" \"1997-02-20\" \"1997-02-21\" \"1997-02-22\" #>  [726] \"1997-02-23\" \"1997-02-24\" \"1997-02-25\" \"1997-02-26\" \"1997-02-27\" #>  [731] \"1997-02-28\" \"1997-03-01\" \"1997-03-02\" \"1997-03-03\" \"1997-03-04\" #>  [736] \"1997-03-05\" \"1997-03-06\" \"1997-03-07\" \"1997-03-08\" \"1997-03-09\" #>  [741] \"1997-03-10\" \"1997-03-11\" \"1997-03-12\" \"1997-03-13\" \"1997-03-14\" #>  [746] \"1997-03-15\" \"1997-03-16\" \"1997-03-17\" \"1997-03-18\" \"1997-03-19\" #>  [751] \"1997-03-20\" \"1997-03-21\" \"1997-03-22\" \"1997-03-23\" \"1997-03-24\" #>  [756] \"1997-03-25\" \"1997-03-26\" \"1997-03-27\" \"1997-03-28\" \"1997-03-29\" #>  [761] \"1997-03-30\" \"1997-03-31\" \"1997-04-01\" \"1997-04-02\" \"1997-04-03\" #>  [766] \"1997-04-04\" \"1997-04-05\" \"1997-04-06\" \"1997-04-07\" \"1997-04-08\" #>  [771] \"1997-04-09\" \"1997-04-10\" \"1997-04-11\" \"1997-04-12\" \"1997-04-13\" #>  [776] \"1997-04-14\" \"1997-04-15\" \"1997-04-16\" \"1997-04-17\" \"1997-04-18\" #>  [781] \"1997-04-19\" \"1997-04-20\" \"1997-04-21\" \"1997-04-22\" \"1997-04-23\" #>  [786] \"1997-04-24\" \"1997-04-25\" \"1997-04-26\" \"1997-04-27\" \"1997-04-28\" #>  [791] \"1997-04-29\" \"1997-04-30\" \"1997-05-01\" \"1997-05-02\" \"1997-05-03\" #>  [796] \"1997-05-04\" \"1997-05-05\" \"1997-05-06\" \"1997-05-07\" \"1997-05-08\" #>  [801] \"1997-05-09\" \"1997-05-10\" \"1997-05-11\" \"1997-05-12\" \"1997-05-13\" #>  [806] \"1997-05-14\" \"1997-05-15\" \"1997-05-16\" \"1997-05-17\" \"1997-05-18\" #>  [811] \"1997-05-19\" \"1997-05-20\" \"1997-05-21\" \"1997-05-22\" \"1997-05-23\" #>  [816] \"1997-05-24\" \"1997-05-25\" \"1997-05-26\" \"1997-05-27\" \"1997-05-28\" #>  [821] \"1997-05-29\" \"1997-05-30\" \"1997-05-31\" \"1997-06-01\" \"1997-06-02\" #>  [826] \"1997-06-03\" \"1997-06-04\" \"1997-06-05\" \"1997-06-06\" \"1997-06-07\" #>  [831] \"1997-06-08\" \"1997-06-09\" \"1997-06-10\" \"1997-06-11\" \"1997-06-12\" #>  [836] \"1997-06-13\" \"1997-06-14\" \"1997-06-15\" \"1997-06-16\" \"1997-06-17\" #>  [841] \"1997-06-18\" \"1997-06-19\" \"1997-06-20\" \"1997-06-21\" \"1997-06-22\" #>  [846] \"1997-06-23\" \"1997-06-24\" \"1997-06-25\" \"1997-06-26\" \"1997-06-27\" #>  [851] \"1997-06-28\" \"1997-06-29\" \"1997-06-30\" \"1997-07-01\" \"1997-07-02\" #>  [856] \"1997-07-03\" \"1997-07-04\" \"1997-07-05\" \"1997-07-06\" \"1997-07-07\" #>  [861] \"1997-07-08\" \"1997-07-09\" \"1997-07-10\" \"1997-07-11\" \"1997-07-12\" #>  [866] \"1997-07-13\" \"1997-07-14\" \"1997-07-15\" \"1997-07-16\" \"1997-07-17\" #>  [871] \"1997-07-18\" \"1997-07-19\" \"1997-07-20\" \"1997-07-21\" \"1997-07-22\" #>  [876] \"1997-07-23\" \"1997-07-24\" \"1997-07-25\" \"1997-07-26\" \"1997-07-27\" #>  [881] \"1997-07-28\" \"1997-07-29\" \"1997-07-30\" \"1997-07-31\" \"1997-08-01\" #>  [886] \"1997-08-02\" \"1997-08-03\" \"1997-08-04\" \"1997-08-05\" \"1997-08-06\" #>  [891] \"1997-08-07\" \"1997-08-08\" \"1997-08-09\" \"1997-08-10\" \"1997-08-11\" #>  [896] \"1997-08-12\" \"1997-08-13\" \"1997-08-14\" \"1997-08-15\" \"1997-08-16\" #>  [901] \"1997-08-17\" \"1997-08-18\" \"1997-08-19\" \"1997-08-20\" \"1997-08-21\" #>  [906] \"1997-08-22\" \"1997-08-23\" \"1997-08-24\" \"1997-08-25\" \"1997-08-26\" #>  [911] \"1997-08-27\" \"1997-08-28\" \"1997-08-29\" \"1997-08-30\" \"1997-08-31\" #>  [916] \"1997-09-01\" \"1997-09-02\" \"1997-09-03\" \"1997-09-04\" \"1997-09-05\" #>  [921] \"1997-09-06\" \"1997-09-07\" \"1997-09-08\" \"1997-09-09\" \"1997-09-10\" #>  [926] \"1997-09-11\" \"1997-09-12\" \"1997-09-13\" \"1997-09-14\" \"1997-09-15\" #>  [931] \"1997-09-16\" \"1997-09-17\" \"1997-09-18\" \"1997-09-19\" \"1997-09-20\" #>  [936] \"1997-09-21\" \"1997-09-22\" \"1997-09-23\" \"1997-09-24\" \"1997-09-25\" #>  [941] \"1997-09-26\" \"1997-09-27\" \"1997-09-28\" \"1997-09-29\" \"1997-09-30\" #>  [946] \"1997-10-01\" \"1997-10-02\" \"1997-10-03\" \"1997-10-04\" \"1997-10-05\" #>  [951] \"1997-10-06\" \"1997-10-07\" \"1997-10-08\" \"1997-10-09\" \"1997-10-10\" #>  [956] \"1997-10-11\" \"1997-10-12\" \"1997-10-13\" \"1997-10-14\" \"1997-10-15\" #>  [961] \"1997-10-16\" \"1997-10-17\" \"1997-10-18\" \"1997-10-19\" \"1997-10-20\" #>  [966] \"1997-10-21\" \"1997-10-22\" \"1997-10-23\" \"1997-10-24\" \"1997-10-25\" #>  [971] \"1997-10-26\" \"1997-10-27\" \"1997-10-28\" \"1997-10-29\" \"1997-10-30\" #>  [976] \"1997-10-31\" \"1997-11-01\" \"1997-11-02\" \"1997-11-03\" \"1997-11-04\" #>  [981] \"1997-11-05\" \"1997-11-06\" \"1997-11-07\" \"1997-11-08\" \"1997-11-09\" #>  [986] \"1997-11-10\" \"1997-11-11\" \"1997-11-12\" \"1997-11-13\" \"1997-11-14\" #>  [991] \"1997-11-15\" \"1997-11-16\" \"1997-11-17\" \"1997-11-18\" \"1997-11-19\" #>  [996] \"1997-11-20\" \"1997-11-21\" \"1997-11-22\" \"1997-11-23\" \"1997-11-24\""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"Creates invisible points x = y min/max range per facet force ggplot use symmetric x/y limits within facet scales free.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"","code":"generate_symmetric_dummy_points(df, facet_var, x_col, y_col)"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"df Data frame containing plotted data. facet_var Character; name facet column df. x_col Character; name x column df. y_col Character; name y column df.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"Data frame columns facet_var, Observed, Simulated   (using x_col y_col names) containing min/max dummy points.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"output includes two points per facet (min max). points can added geom_blank() enforce consistent axis limits without affecting visible data.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_symmetric_dummy_points.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Dummy Points to Enforce Symmetric Facet Axes — generate_symmetric_dummy_points","text":"","code":"df <- data.frame(   variable = c(\"precip\", \"precip\", \"temp\", \"temp\"),   Observed = c(1, 5, 10, 12),   Simulated = c(0.5, 6, 9, 13) ) generate_symmetric_dummy_points(df, \"variable\", \"Observed\", \"Simulated\") #> # A tibble: 4 × 3 #>   variable Observed Simulated #>   <chr>       <dbl>     <dbl> #> 1 precip        0.5       0.5 #> 2 temp          9         9   #> 3 precip        6         6   #> 4 temp         13        13"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate Synthetic Gridded Daily Weather Series — generate_weather","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"Generates stochastic gridded daily weather coupling annual-scale low-frequency generator daily-scale resampling persistence logic. workflow combines: Wavelet Autoregressive Modeling (WARM) annual aggregate     warm_var simulate low-frequency variability, annual K-nearest-neighbor (KNN) matching select historical analogue years, three-state (dry, wet, extreme) daily Markov chain control spell persistence, daily KNN resampling precipitation temperature anomalies. simulation-year definition inferred year_start_month: year_start_month == 1: calendar-year simulation, year_start_month != 1: water-year simulation starting year_start_month.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"","code":"generate_weather(   obs_data = NULL,   obs_grid = NULL,   obs_dates = NULL,   vars = NULL,   n_years = NULL,   start_year = 2020,   year_start_month = 1,   n_realizations = 5,   warm_var = \"precip\",   warm_signif = 0.9,   warm_pool_size = 5000,   warm_filter_bounds = list(),   warm_filter_relax_order = c(\"wavelet\", \"sd\", \"tail_low\", \"tail_high\", \"mean\"),   annual_knn_n = 120,   wet_q = 0.3,   extreme_q = 0.8,   dry_spell_factor = rep(1, 12),   wet_spell_factor = rep(1, 12),   out_dir = tempdir(),   seed = NULL,   parallel = FALSE,   n_cores = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"obs_data Named list data.frames (one per grid cell) observed daily weather. data.frame must one row per day corresponding obs_dates, columns vars. obs_grid Data.frame describing grid cells. Must contain columns xind, yind, x, y. id missing, created sequential index. obs_dates Vector class Date corresponding rows obs_data[[]]. May include Feb 29; Feb 29 removed internally along corresponding rows obs_data. vars Character vector daily variables simulate (e.g., c(\"precip\",\"temp\")). n_years Integer number years simulate. NULL, defaults number complete historical simulation-years available enforcing 365-day calendar restricting longest contiguous block complete years. start_year Integer first simulation year (calendar year year_start_month == 1, otherwise first water year label). year_start_month Integer 1:12. First month simulation year. Use 1 calendar years; use 10 Oct–Sep water years, etc. n_realizations Integer number realizations generate. warm_var Character name annual driver variable used WARM. Must present vars. warm_signif Numeric (0,1). Wavelet significance level used retain low-frequency components WARM. warm_pool_size Integer number candidate annual traces generate filtering n_realizations. warm_filter_bounds Named list filtering thresholds relaxation controls forwarded filter_warm_pool filter_bounds. entry overrides internal defaults. Uses snake_case keys (e.g. tail_low_p). warm_filter_relax_order Character vector giving relaxation priority WARM filtering, forwarded filter_warm_pool relax_order. Must contain c(\"mean\",\"sd\",\"tail_low\",\"tail_high\",\"wavelet\") exactly . Filters relaxed iteratively loosening currently restrictive criterion (lowest pass rate), subject priority ordering. annual_knn_n Integer number historical analogue years considered annual KNN step disaggregation. wet_q Numeric (0,1). Wet-day threshold quantile used daily Markov chain classification. extreme_q Numeric (0,1). Extreme-day threshold quantile used daily Markov chain classification. Must greater wet_q. dry_spell_factor Numeric length-12 vector monthly dry-spell adjustment factors applied Markov-chain persistence logic. wet_spell_factor Numeric length-12 vector monthly wet-spell adjustment factors applied Markov-chain persistence logic. out_dir Character directory diagnostics CSV outputs. directory created exist. seed Optional integer seed reproducibility. Used initialize RNG streams annual (WARM) daily resampling components. parallel Logical; TRUE, run daily disaggregation across realizations parallel using PSOCK cluster. n_cores Optional integer number cores parallel execution. NULL parallel = TRUE, defaults max(1, parallel::detectCores() - 1). verbose Logical; TRUE, emits progress logs via .log().","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"list : resampled Tibble/data.frame one column per realization.     column contains historical observation dates (dateo) selected     analogues simulated day. Column names rlz_1, rlz_2, ... dates Vector class Date giving simulated daily time axis     (Feb 29 excluded).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"Calendar handling (robust Gregorian input): Inputs may Gregorian calendar may include Feb 29. Internally, function enforces 365-day calendar removing Feb 29 obs_dates dropping corresponding rows every element obs_data. downstream processing outputs therefore use 365-day calendar. Workflow: Historical preprocessing: Enforce 365-day calendar, compute     calendar/water-year indices, build historical dates table used     KNN matching Markov chain sequencing. Annual WARM simulation: Aggregate historical daily data annual     means (water year applicable), run wavelet analysis annual     series, simulate candidate annual traces via simulate_warm,     subset traces using filter_warm_pool. Daily disaggregation: realization, call     resample_weather_dates generate simulated sequence     historical analogue dates (internal 365-day calendar). Output construction: Map resampled internal dates back     historical observation dates (dateo) return simulated dates.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/generate_weather.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate Synthetic Gridded Daily Weather Series — generate_weather","text":"","code":"if (FALSE) { # \\dontrun{ # obs_data: list of grid-cell data.frames with columns precip/temp # obs_grid: data.frame with xind/yind/x/y # obs_dates: Date vector aligned with rows of each obs_data[[i]] out <- generate_weather(   obs_data = obs_data,   obs_grid = obs_grid,   obs_dates = obs_dates,   vars = c(\"precip\", \"temp\"),   start_year = 2020,   n_years = 30,   year_start_month = 10,   n_realizations = 20,   warm_var = \"precip\",   warm_signif = 0.90,   warm_pool_size = 5000,   annual_knn_n = 120,   wet_q = 0.30,   extreme_q = 0.80,   out_dir = tempdir(),   seed = 123,   parallel = TRUE,   n_cores = 4,   verbose = TRUE ) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Safely Get or Sample an Index from a Vector — get_result_index","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"Returns valid index `candidate_precip` based provided `idx`. `idx` missing, bounds, invalid, random index sampled instead. `candidate_precip` empty, `NA_integer_` returned.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"","code":"get_result_index(idx, candidate_precip)"},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"idx Integer-valued scalar. Proposed index retrieving element `candidate_precip`. Non-integer invalid values trigger resampling. candidate_precip Numeric vector. set candidate precipitation values (e.g., next day).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"Integer. valid index `candidate_precip`, `NA_integer_` `candidate_precip` empty.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/get_result_index.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Safely Get or Sample an Index from a Vector — get_result_index","text":"","code":"candidate_precip <- c(0, 5, 10, 20) get_result_index(2, candidate_precip) #> [1] 2  set.seed(1) get_result_index(10, candidate_precip) #> [1] 1  get_result_index(NA, candidate_precip) #> [1] 4 get_result_index(1, numeric(0)) #> [1] NA"},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":null,"dir":"Reference","previous_headings":"","what":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"Linearly interpolates global wavelet spectrum wavelet analysis output onto target period grid fills edge values using nearest-neighbor filling.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"","code":"gws_regrid(wavelet, target_period, use_unmasked = FALSE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"wavelet List output analyze_wavelet_spectrum. target_period Numeric vector. Target periods interpolation. use_unmasked Logical. TRUE available, uses wavelet$gws_unmasked; otherwise uses wavelet$gws.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/gws_regrid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regrid Global Wavelet Spectrum to a Target Period Grid — gws_regrid","text":"Numeric vector interpolated GWS values target_period.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"Given set candidate vectors target vector, selects indices k nearest candidates (using weighted Euclidean distance) target, samples n indices neighbors, either uniformly rank-based distance-based probabilities. Optionally, random seed can set reproducibility.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"","code":"knn_sample(   candidates,   target,   k,   n = 1,   prob = FALSE,   weights = NULL,   seed = NULL,   sampling = c(\"rank\", \"distance\"),   bandwidth = NULL,   epsilon = 1e-08 )"},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"candidates Numeric matrix data frame. row candidate vector. target Numeric vector. target vector comparison. k Integer. Number nearest neighbors consider (k <= number candidates). n Integer. Number samples draw (default = 1). prob Logical. TRUE, sampling probabilities favor closer neighbors; FALSE (default), sampling uniform among k nearest neighbors. weights Optional numeric vector length equal ncol(candidates). Feature weights distance calculation. Default equal weights. seed Optional integer. provided, sets random seed reproducible sampling. seed state restored exit. sampling Character. Sampling method prob = TRUE. Either \"rank\" (default, probability decreases neighbor rank: 1, 1/2, 1/3, ...) \"distance\" (probability based Gaussian kernel distances). Ignored prob = FALSE. bandwidth Numeric. Bandwidth parameter distance-based sampling kernel. NULL (default), uses median nearest neighbor distance. used sampling = \"distance\" prob = TRUE. epsilon Numeric. Small constant added distance-based probabilities prevent zero probabilities (default = 1e-8). used sampling = \"distance\" prob = TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"Integer vector length n, giving indices sampled candidates (rows candidates).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"function computes weighted Euclidean distance candidate target. k nearest neighbors (smallest distances) identified. Sampling modes: prob = FALSE k neighbors sampled equal probability (uniform) prob = TRUE, sampling = \"rank\" Probability = 1/rank, normalized.         Closest neighbor highest probability. prob = TRUE, sampling = \"distance\" Probability based Gaussian         kernel: exp(-distance^2 / (2 * bandwidth^2)) Sampling replacement. seed set, random seed temporarily changed restored exit.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/knn_sample.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"K-Nearest Neighbor (KNN) Sampling from Candidates — knn_sample","text":"","code":"set.seed(42) candidates <- matrix(rnorm(50), ncol = 2) target <- c(0, 0)  # Sample 1 index from 5 nearest neighbors, uniform probability knn_sample(candidates, target, k = 5, n = 1) #> [1] 21  # Sample 3 indices from 5 nearest neighbors, rank-weighted probability knn_sample(candidates, target, k = 5, n = 3, prob = TRUE, seed = 123) #> [1] 15  6 15  # Using feature weights (weight first dimension more heavily) knn_sample(candidates, target, k = 5, n = 2, weights = c(2, 1), seed = 10) #> [1] 17 10  # Distance-based sampling with custom bandwidth knn_sample(candidates, target, k = 10, n = 5, prob = TRUE,            sampling = \"distance\", bandwidth = 1.5) #> [1]  6  6 10  8  8"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":null,"dir":"Reference","previous_headings":"","what":"Log initial setup information — log_filtering_start","title":"Log initial setup information — log_filtering_start","text":"Internal helper. Displays general information start filtering.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log initial setup information — log_filtering_start","text":"","code":"log_filtering_start(   n_obs,   n_sim,   n_realizations,   sample_target,   relax_priority )"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log initial setup information — log_filtering_start","text":"n_obs Integer scalar. Number observations observed series. n_sim Integer scalar. Number years simulated series used windowing. n_realizations Integer scalar. Number candidate realizations. sample_target Integer scalar. Target number select. relax_priority Character vector. Relaxation priority vector.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filtering_start.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log initial setup information — log_filtering_start","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":null,"dir":"Reference","previous_headings":"","what":"Log filter iteration details — log_filter_iteration","title":"Log filter iteration details — log_filter_iteration","text":"Internal helper. Prints iteration diagnostics compact table-like format.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log filter iteration details — log_filter_iteration","text":"","code":"log_filter_iteration(   iter,   passes,   pool,   n_total,   target,   bounds,   tail_metrics,   wavelet_active,   wavelet_pars,   note = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log filter iteration details — log_filter_iteration","text":"iter Integer scalar. Iteration number. passes Named list logical vectors. Per-filter pass vectors. pool Integer vector. Pool indices passing active filters. n_total Integer scalar. Total number realizations. target Integer scalar. Target pool size. bounds Environment list bounds. tail_metrics List. Tail metrics used criteria display. wavelet_active Logical scalar. wavelet_pars List. Wavelet parameter list. note Optional character scalar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_filter_iteration.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log filter iteration details — log_filter_iteration","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":null,"dir":"Reference","previous_headings":"","what":"Log final filtering summary — log_final_summary","title":"Log final filtering summary — log_final_summary","text":"Internal helper. Displays final filtering results.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Log final filtering summary — log_final_summary","text":"","code":"log_final_summary(pool_size, n_total, n_sampled, relaxation_level)"},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Log final filtering summary — log_final_summary","text":"pool_size Integer scalar. Final pool size. n_total Integer scalar. Total realizations. n_sampled Integer scalar. Number sampled. relaxation_level Character scalar. Selection mode / relaxation level reached.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/log_final_summary.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Log final filtering summary — log_final_summary","text":"Invisibly returns NULL.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Determine Next State in a First-Order Markov Chain — markov_next_state","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"Given previous state random number `u_rand`, function returns next state 3-state first-order Markov chain. transition probabilities state- index-specific.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"","code":"markov_next_state(state_prev, u_rand, idx, p00, p01, p10, p11, p20, p21)"},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"state_prev Integer. current (previous) state (0, 1, 2). u_rand Numeric. random number [0, 1] used sample next state. idx Integer. Index selecting transition probabilities (e.g., time step spatial location). p00 Numeric vector. Probability transition state 0 0. p01 Numeric vector. Probability transition state 0 1. p10 Numeric vector. Probability transition state 1 0. p11 Numeric vector. Probability transition state 1 1. p20 Numeric vector. Probability transition state 2 0. p21 Numeric vector. Probability transition state 2 1.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"Integer. next state (0, 1, 2).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"States typically defined : - 0: Dry - 1: Wet - 2: Extreme transition determined using cumulative probabilities transitions state 0 1. remaining probability assigned state 2.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/markov_next_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Determine Next State in a First-Order Markov Chain — markov_next_state","text":"","code":"set.seed(123) u_rand <- runif(1) markov_next_state(   state_prev = 1,   u_rand = u_rand,   idx = 5,   p00 = rep(0.7, 10),   p01 = rep(0.2, 10),   p10 = rep(0.3, 10),   p11 = rep(0.4, 10),   p20 = rep(0.1, 10),   p21 = rep(0.3, 10) ) #> [1] 0"},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":null,"dir":"Reference","previous_headings":"","what":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Returns positions within `day0_idx` specified state transition occurs, based wet/dry/extreme day thresholds.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"","code":"match_transition_positions(   state_from,   state_to,   precip_vec,   day0_idx,   wet_threshold,   extreme_threshold )"},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"state_from Integer. current occurrence state (0 = dry, 1 = wet, 2 = extreme). state_to Integer. next occurrence state (0 = dry, 1 = wet, 2 = extreme). precip_vec Numeric vector precipitation values. day0_idx Integer vector indices representing candidate \"day 0\" positions time series. wet_threshold Numeric. Threshold separating dry wet days. extreme_threshold Numeric. Threshold days considered extreme.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Integer vector positions within `day0_idx` transition `state_from` `state_to` occurs.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"Occurrence states defined : - 0: Dry day (precipitation <= wet_threshold) - 1: Wet day (precipitation > wet_threshold <= extreme_threshold) - 2: Extreme wet day (precipitation > extreme_threshold)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/match_transition_positions.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Get Positions of a Specific Occurrence State Transition Within Candidate Indices — match_transition_positions","text":"","code":"precip_vec <- c(0, 0, 5, 15, 30, 0, 2, 25, 40, 0) day0_idx <- 1:(length(precip_vec) - 1) wet_threshold <- 1 extreme_threshold <- 20  match_transition_positions(0, 1, precip_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 2 6 match_transition_positions(1, 2, precip_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 4 7 match_transition_positions(2, 0, precip_vec, day0_idx, wet_threshold, extreme_threshold) #> [1] 5 9"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Morlet Wavelet Parameters — morlet_parameters","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"Computes key parameters Morlet wavelets: Fourier factor (scale->period), cone--influence (COI) e-folding time, minimum degrees freedom.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"","code":"morlet_parameters(k0 = 6)"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"k0 Numeric scalar. Morlet nondimensional frequency (default: 6).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Morlet Wavelet Parameters — morlet_parameters","text":"Named numeric vector: fourier_factor, coi, dofmin.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":null,"dir":"Reference","previous_headings":"","what":"Morlet Wavelet in Fourier Domain — morlet_wavelet","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"Computes Morlet wavelet \"daughter\" Fourier space given scale. Normalization follows Torrence & Compo (1998).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"","code":"morlet_wavelet(k, scale, k0 = 6)"},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"k Numeric vector. Angular frequencies FFT ordering. scale Numeric scalar. Wavelet scale (inverse frequency), must positive. k0 Numeric scalar. Morlet nondimensional frequency (default: 6).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/morlet_wavelet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Morlet Wavelet in Fourier Domain — morlet_wavelet","text":"Numeric vector (complex). Morlet wavelet Fourier space.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_calendar.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize Calendar to 365 Days — normalize_calendar","title":"Normalize Calendar to 365 Days — normalize_calendar","text":"Removes February 29 (leap days) observation dates corresponding rows grid cell data frames enforce 365-day calendar.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_calendar.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize Calendar to 365 Days — normalize_calendar","text":"","code":"normalize_calendar(obs_dates, obs_data, verbose = FALSE)"},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_calendar.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize Calendar to 365 Days — normalize_calendar","text":"obs_dates Date vector observation dates. obs_data Named list data frames (one per grid cell). verbose Logical. TRUE, logs number dropped days.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_calendar.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize Calendar to 365 Days — normalize_calendar","text":"list two elements: dates Date vector leap days removed. data List data frames corresponding rows removed.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":null,"dir":"Reference","previous_headings":"","what":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"Normalizes numeric vector sum one, treating non-finite negative values zero. total mass zero cleaning, fallback distribution returned instead.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"","code":"normalize_probs(prob, fallback_prob = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"prob Numeric vector (unnormalized) probabilities weights. Non-finite values (NA, NaN, Inf) negative values set zero prior normalization. fallback_prob Optional numeric vector return prob zero total mass cleaning. NULL (default), uniform distribution length length(prob) returned.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"Numeric vector probabilities summing one. fallback used, returned vector either fallback_prob uniform distribution.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"helper intended internal use stochastic probabilistic workflows degenerate numerically unstable probability vectors may arise. function check fallback_prob sums one; assumed ensured caller.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/normalize_probs.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Normalize a Probability Vector with Robust Fallback Handling — normalize_probs","text":"","code":"if (FALSE) { # \\dontrun{ prob <- c(0.2, NA, -0.1, 0.5) normalize_probs(prob)  normalize_probs(c(0, 0, 0))  normalize_probs(c(0, 0, 0), fallback_prob = c(0.7, 0.2, 0.1)) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"Internal function used filter_warm_pool() create diagnostic plots. Shows time series, statistics scatter, wavelet GWS comparisons.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"","code":"plot_filter_diagnostics(   obs_series,   sim_series,   pool,   rel_diff_mean,   rel_diff_sd,   tail_metrics,   power_period,   power_obs,   power_signif,   gws_cache,   wavelet_q = c(0.05, 0.95) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"obs_series Numeric vector observed values sim_series Numeric matrix simulated values pool Integer vector pool indices rel_diff_mean Relative differences mean rel_diff_sd Relative differences SD tail_metrics Tail metrics list power_period Wavelet periods power_obs Observed GWS power_signif Significance curve gws_cache Cached GWS matrix (n_periods x n_realizations) wavelet_q Two quantiles ribbon (e.g., c(0.50, 0.95))","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_filter_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create diagnostic plots for filtered pool — plot_filter_diagnostics","text":"List ggplot objects (timeseries, stats, wavelet_gws)","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"Plots global wavelet spectrum (time-averaged wavelet power period) observed series, together period-wise significance threshold. Optionally overlays ensemble mean simulated global spectra.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"","code":"plot_wavelet_global_spectrum(period, signif, obs_power, sim_power = NULL)"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"period Numeric vector wavelet periods (scales), typically years (days). strictly increasing meaningful interpretation. signif Numeric vector length length(period) giving global-spectrum significance threshold period. obs_power Numeric vector length length(period) giving observed global wavelet spectrum. sim_power Optional numeric matrix simulated global spectra nrow(sim_power) == length(period) one column per simulation.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"ggplot object.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"plot Identify dominant variability scales (peaks global power). Compare observed spectral structure simulated ensemble. Interpret variability relative significance threshold. Ensemble behavior sim_power provided, function adds ensemble mean solid line. function intentionally keeps default view simple; want ensemble envelope (e.g., min/max quantiles) add outside function.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_global_spectrum.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Global Wavelet Spectrum — plot_wavelet_global_spectrum","text":"","code":"if (FALSE) { # \\dontrun{ p <- plot_wavelet_global_spectrum(   period   = w$period,   signif   = w$gws_signif,   obs_power = w$gws,   sim_power = w$gws_sim  # matrix: period x n_sim (optional) ) print(p) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"Produces two-panel diagnostic figure 1D time series wavelet analysis: (1) time-period wavelet power field (2) global wavelet spectrum (time-averaged power period) significance threshold.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"","code":"plot_wavelet_power(   series,   time = NULL,   period,   power,   gws,   gws_signif,   coi,   signif_mask,   unit = \"mm\" )"},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"series Numeric vector. time series used define time dimension (length must match number columns power). time Optional numeric vector length length(series) used x-axis. Must strictly increasing. NULL, uses seq_len(length(series)). period Numeric vector wavelet periods (scales), typically years (days), strictly increasing. power Numeric matrix wavelet power dimensions length(period) x length(series). gws Numeric vector. Global wavelet spectrum (mean power period). Must length length(period). gws_signif Numeric vector. Significance threshold gws. Must length length(period). coi Numeric vector length length(series) giving cone influence units period. Values outside plotted period range ignored. signif_mask Numeric matrix dimensions length(period) x length(series). contour drawn 1. typically significance ratio binary mask encoded 0/1 (NA). unit Character. Unit label used global spectrum axis label (default: \"mm\").","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"patchwork object combining power-field panel global spectrum panel.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"plot Identify specific periodicities active time (power field). Summarize dominant variability scales across full record (global spectrum). Check edge effects statistical significance (COI contour). Key plotting choices Power shown \\(\\log_2\\) scale discarding non-finite values   non-positive power. power field drawn native wavelet grid (interpolation) using   explicit cell boundaries, avoids smoothing artifacts. Color limits set using robust quantiles (5th-95th percentile) avoid   low-contrast fields dynamic range large. Inputs must consistent n_time = length(series) n_period = length(period). power signif_mask must dimensions   n_period x n_time. coi must length n_time. period must strictly increasing. supplied, time must strictly increasing length n_time.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/plot_wavelet_power.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot Wavelet Power and Global Wavelet Spectrum — plot_wavelet_power","text":"","code":"if (FALSE) { # \\dontrun{ # Assuming you computed wavelet outputs elsewhere: # w <- analyze_wavelet_spectrum(series) p <- plot_wavelet_power(   series      = series,   time        = years,   period      = w$period,   power       = w$power,   gws         = w$gws,   gws_signif  = w$gws_signif,   coi         = w$coi,   signif_mask = w$signif_mask,   unit        = \"mm\" ) print(p) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Prepare Generator Output for Evaluation — prepare_evaluation_data","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"Transforms output generate_weather format required evaluate_weather_generator. helper function handles date resampling, complete-year filtering, data extraction typically needed generation evaluation steps.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"","code":"prepare_evaluation_data(   gen_output,   obs_data,   obs_dates,   grid_ids,   variables,   min_days_per_year = 365L,   verbose = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"gen_output List returned generate_weather, containing resampled (tibble resampled observation dates per realization) dates (vector simulated dates). obs_data Named list data frames read_netcdf$data, one per grid cell. data frame must contain columns variables. obs_dates Date vector corresponding rows obs_data element. Typically read_netcdf()$date. grid_ids Character integer vector grid cell identifiers include evaluation. Must match names indices obs_data. variables Character vector variable names extract (e.g., c(\"precip\", \"temp\")). min_days_per_year Integer. Minimum number days required consider year complete. Default 365. Use 360 360-day calendars. verbose Logical. TRUE, prints progress messages console via internal .log() function. Default TRUE.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"list two elements: sim_data List length n_realizations. element     list data frames (one per grid cell) columns date followed     requested variables. obs_data List data frames (one per grid cell) columns     date followed requested variables.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"function performs following transformations: Maps resampled dates back row indices original observations Filters simulation period complete years (>= 365 days) Extracts specified variables observed data using resampled indices Formats simulated observed data required evaluator Complete years identified calendar year boundaries. water-year simulations, users ensure simulation spans full water years.","code":""},{"path":[]},{"path":"https://deltares-research.github.io/weathergenr/reference/prepare_evaluation_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Prepare Generator Output for Evaluation — prepare_evaluation_data","text":"","code":"if (FALSE) { # \\dontrun{ # After running generate_weather() ncdata <- read_netcdf(\"climate_data.nc\") gen_output <- generate_weather(   obs_data = ncdata$data,   obs_grid = ncdata$grid,   obs_dates = ncdata$date,   ... )  # Prepare data for evaluation eval_data <- prepare_evaluation_data(   gen_output = gen_output,   obs_data   = ncdata$data,   obs_dates  = ncdata$date,   grid_ids   = ncdata$grid$id,   variables  = c(\"precip\", \"temp\") )  # Run evaluation results <- evaluate_weather_generator(   daily_sim = eval_data$sim_data,   daily_obs = eval_data$obs_data,   ... ) } # }"},{"path":"https://deltares-research.github.io/weathergenr/reference/print.precip_qm_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for precipitation QM diagnostics — print.precip_qm_diagnostics","title":"Print method for precipitation QM diagnostics — print.precip_qm_diagnostics","text":"Prints formatted summary precipitation quantile mapping diagnostics multiple tables showing key metrics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/print.precip_qm_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for precipitation QM diagnostics — print.precip_qm_diagnostics","text":"","code":"# S3 method for class 'precip_qm_diagnostics' print(x, ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/print.precip_qm_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for precipitation QM diagnostics — print.precip_qm_diagnostics","text":"x object class `precip_qm_diagnostics`. ... used. Included S3 method consistency.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/print.precip_qm_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for precipitation QM diagnostics — print.precip_qm_diagnostics","text":"input `x`, invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Read NetCDF variables into tidy data frames — read_netcdf","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Reads one variables NetCDF file returns named list data.frames (one per variable). data.frame contains coordinate columns (e.g., lon/lat/time) plus single value column (optionally renamed).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"","code":"read_netcdf(   nc_path,   var = NULL,   var_name = NULL,   keep_leap_day = TRUE,   drop_all_na = TRUE,   spatial_ref = \"spatial_ref\",   signif_digits = NULL,   verbose = FALSE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"nc_path Character. Path NetCDF file. var Character vector NULL. Variables read. NULL, reads non-coordinate variables (excludes `spatial_ref` present). var_name NULL, named character vector. - named: names original variable names values new names. Renaming applies output list names value-column name. keep_leap_day Logical. FALSE time convertible Date, removes Feb 29 rows. drop_all_na Logical. TRUE, drop variables whose values NA applying _FillValue/missing_value handling. spatial_ref Character. Name spatial reference variable ignore auto-selecting variables (common CF/CRS-encoded files). signif_digits Integer NULL. provided, rounds numeric values via signif(x, signif_digits). verbose Logical. TRUE, prints basic progress messages.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Named list data.frames.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/read_netcdf.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Read NetCDF variables into tidy data frames — read_netcdf","text":"Robust common NetCDF conventions avoids \"replacement N rows, data 0\" failure always building coordinate table correct length assigning values.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":null,"dir":"Reference","previous_headings":"","what":"Relax bounds for one filter — relax_bounds_one_filter","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"Applies one relaxation step single filter. Updates bounds place.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"","code":"relax_bounds_one_filter(   filter_name,   bounds_env,   wavelet_active_env,   recompute_tailmass_fn )"},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"filter_name Character. Name filter relax. bounds_env Environment containing bounds (snake_case keys). wavelet_active_env Environment containing wavelet_active flag. recompute_tailmass_fn Function recompute tail mass thresholds change.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/relax_bounds_one_filter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Relax bounds for one filter — relax_bounds_one_filter","text":"List changed (logical) msg (character).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":null,"dir":"Reference","previous_headings":"","what":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"Resamples daily precipitation temperature sequences combining: annual K-nearest-neighbor (KNN) selection observed years, three-state Markov chain wet dry spell persistence, daily KNN resampling precipitation temperature anomalies. function supports calendar-year water-year simulations. regime inferred automatically `year_start_month`: `year_start_month == 1`, calendar-year logic used; otherwise, water-year logic assumed.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"","code":"resample_weather_dates(   sim_annual_precip,   obs_annual_precip,   obs_daily_precip,   obs_daily_temp,   year_start,   n_years,   obs_dates_df,   sim_dates_df,   year_start_month = 1,   annual_knn_n = 100,   wet_q = 0.2,   extreme_q = 0.8,   dry_spell_factor = rep(1, 12),   wet_spell_factor = rep(1, 12),   seed = NULL )"},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"sim_annual_precip Numeric vector length `n_years`. Synthetic annual precipitation totals generated annual model (e.g., WARM), indexed simulated year. obs_annual_precip Numeric vector. Observed annual precipitation totals corresponding historical water years. obs_daily_precip Numeric vector. Observed daily precipitation values (leap days), aligned `obs_dates_df`. obs_daily_temp Numeric vector. Observed daily temperature values (leap days), aligned `obs_dates_df`. year_start Integer. First simulation year (calendar year `year_start_month == 1`, otherwise first water year). n_years Integer. Number simulated years. obs_dates_df Data frame containing observed date information. Must include columns `date`, `month`, `day`, `wyear`. sim_dates_df Data frame containing simulated date information (leap days). Must include columns `month`, `day`, `wyear`. year_start_month Integer 1:12. First month simulation year. Use 1 calendar-year simulations, another month water-year simulations. annual_knn_n Integer. Number historical years sampled annual KNN step. wet_q Numeric 0 1. Quantile used define wet threshold daily precipitation states. extreme_q Numeric 0 1. Quantile used define wet (extreme) precipitation threshold. dry_spell_factor Numeric vector length 12. Monthly adjustment factors controlling dry spell persistence Markov chain. wet_spell_factor Numeric vector length 12. Monthly adjustment factors controlling wet spell persistence Markov chain. seed Optional integer. Base random seed reproducibility.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"`Date` vector length equal `nrow(sim_dates_df)`, giving resampled observed dates corresponding simulated day.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/resample_weather_dates.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Resample Daily Weather Dates Using Annual KNN and Markov Chain Logic — resample_weather_dates","text":"simulated year, subset observed water years selected using annual KNN matching `sim_annual_precip`. Daily weather generated sequentially: first day simulated year sampled observed         days matching simulated month day. Subsequent days generated using Markov chain simulate         wet dry states. Conditional simulated state, candidate observed days         selected using calendar constraints expanded search windows. daily KNN step precipitation temperature anomalies         used select next-day weather values. calendar-year mode (`year_start_month == 1`), transitions cross December January explicitly excluded avoid cross-year contamination.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":null,"dir":"Reference","previous_headings":"","what":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"Simulates synthetic series modeling wavelet component ARIMA model, simulating component forward, summing across components. Optionally rescales simulated components match observed component variance.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"","code":"simulate_warm(   components = NULL,   n = NULL,   n_sim = 1000,   seed = NULL,   match_variance = TRUE,   var_tol = 0.1,   check_diagnostics = FALSE,   verbose = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"components Matrix, data.frame, list numeric vectors. Wavelet components, typically produced extract_wavelet_components. n Integer. Length simulated series. n_sim Integer. Number realizations generate. seed Optional integer. Base RNG seed reproducibility. match_variance Logical. TRUE, rescales simulated component match observed component standard deviation. var_tol Numeric [0, 1]. Relative tolerance used trigger variance rescaling. check_diagnostics Logical. TRUE, runs simple ARIMA diagnostics warns issues. verbose Logical. TRUE, emits informational logs (via logger::log_info available).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/simulate_warm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wavelet Autoregressive Modeling (WARM) — simulate_warm","text":"Numeric matrix dimension n x n_sim. column simulated realization.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.precip_qm_diagnostics.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize precipitation QM diagnostics — summary.precip_qm_diagnostics","title":"Summarize precipitation QM diagnostics — summary.precip_qm_diagnostics","text":"Prints compact numeric summary key QM diagnostic metrics.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.precip_qm_diagnostics.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize precipitation QM diagnostics — summary.precip_qm_diagnostics","text":"","code":"# S3 method for class 'precip_qm_diagnostics' summary(object, ...)"},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.precip_qm_diagnostics.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize precipitation QM diagnostics — summary.precip_qm_diagnostics","text":"object `precip_qm_diagnostics` object. ... Unused.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/summary.precip_qm_diagnostics.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize precipitation QM diagnostics — summary.precip_qm_diagnostics","text":"input `object`, invisibly.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":null,"dir":"Reference","previous_headings":"","what":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"Convenience wrapper around `diagnose_precip_qm()` argument names aligned QM workflows.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"","code":"validate_quantile_mapping(   precip_org,   precip_adjusted,   month = NULL,   year = NULL,   mean_factor = NULL,   var_factor = NULL,   wet_thresh = 0.1,   probs = c(0.05, 0.1, 0.25, 0.5, 0.75, 0.9, 0.95, 0.99) )"},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"precip_org Numeric vector. Original precipitation values. precip_adjusted Numeric vector. Adjusted precipitation values (length `precip_org`). month Integer vector (optional). Month index (1–12) observation. year Integer vector (optional). Year index (1..n_years) observation. mean_factor Numeric matrix (optional). Target mean scaling factors (n_years x 12). var_factor Numeric matrix (optional). Target variance scaling factors (n_years x 12). wet_thresh Numeric. Threshold defining wet days (default = 0.1 mm). probs Numeric vector. Quantile probabilities evaluate.","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/validate_quantile_mapping.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Validate precipitation quantile mapping adjustments — validate_quantile_mapping","text":"`precip_qm_diagnostics` object (see `diagnose_precip_qm()`).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":null,"dir":"Reference","previous_headings":"","what":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"Writes gridded climate/weather time series NetCDF file using template NetCDF schema source (dimensions, spatial reference variable, global attributes).","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"","code":"write_netcdf(   data = NULL,   grid = NULL,   out_dir = NULL,   origin_date = NULL,   calendar = \"noleap\",   template_path = NULL,   compression = 4,   spatial_ref = \"spatial_ref\",   file_prefix = \"clim_change_rlz\",   file_suffix = \"\",   signif_digits = NULL,   verbose = TRUE )"},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"data List length nrow(grid). element named list numeric vectors (time series) variable written. list elements must identical variable names equal length. grid data.frame least xind yind integer indices mapping list element output grid cell. out_dir Character. Output directory. origin_date Character Date. Origin date used NetCDF time units (e.g., \"1970-01-01\"). calendar Character. NetCDF calendar type (e.g., \"noleap\"). template_path Character. Path template NetCDF file. compression Integer 0-9. NetCDF4 deflation level. spatial_ref Character. Spatial reference variable name template. file_prefix Character. Prefix output filename. file_suffix Character. Optional suffix appended filename. signif_digits Integer. NULL, round values many significant digits. verbose Logical. TRUE, emit progress logs via .log().","code":""},{"path":"https://deltares-research.github.io/weathergenr/reference/write_netcdf.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write Gridded Data to a NetCDF File (Template-Based) — write_netcdf","text":"Invisibly returns written file path.","code":""}]
