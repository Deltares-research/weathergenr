<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Continuous Wavelet Spectral Analysis with COI-Aware Significance — wavelet_spectral_analysis • weathergenr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Continuous Wavelet Spectral Analysis with COI-Aware Significance — wavelet_spectral_analysis"><meta name="description" content="Performs continuous wavelet transform (CWT) analysis using the Morlet mother
wavelet following Torrence &amp;amp; Compo (1998), with extensions for:
cone-of-influence (COI) aware global spectrum estimation,
effective sample size (neff)-based significance testing,
defensible AR(1) red-noise background estimation,
stable and complete signal reconstruction from significant scales.


The function is designed for **detection and diagnostic analysis of dominant
time scales**, not for producing orthogonal components. Reconstructed components
are scale-localized but not independent."><meta property="og:description" content="Performs continuous wavelet transform (CWT) analysis using the Morlet mother
wavelet following Torrence &amp;amp; Compo (1998), with extensions for:
cone-of-influence (COI) aware global spectrum estimation,
effective sample size (neff)-based significance testing,
defensible AR(1) red-noise background estimation,
stable and complete signal reconstruction from significant scales.


The function is designed for **detection and diagnostic analysis of dominant
time scales**, not for producing orthogonal components. Reconstructed components
are scale-localized but not independent."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weathergenr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Continuous Wavelet Spectral Analysis with COI-Aware Significance</h1>

      <div class="d-none name"><code>wavelet_spectral_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Performs continuous wavelet transform (CWT) analysis using the Morlet mother
wavelet following Torrence &amp; Compo (1998), with extensions for:</p><ul><li><p>cone-of-influence (COI) aware global spectrum estimation,</p></li>
<li><p>effective sample size (neff)-based significance testing,</p></li>
<li><p>defensible AR(1) red-noise background estimation,</p></li>
<li><p>stable and complete signal reconstruction from significant scales.</p></li>
</ul><p>The function is designed for **detection and diagnostic analysis of dominant
time scales**, not for producing orthogonal components. Reconstructed components
are scale-localized but not independent.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wavelet_spectral_analysis</span><span class="op">(</span></span>
<span>  <span class="va">variable</span>,</span>
<span>  signif.level <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  noise.type <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  period.lower.limit <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  mode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fast"</span>, <span class="st">"complete"</span><span class="op">)</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_recon_error <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lag1_ci <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  lag1_ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  lag1_boot_n <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  warn_neff <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  neff_warn_min <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  neff_warn_frac <span class="op">=</span> <span class="fl">0.6</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-variable">variable<a class="anchor" aria-label="anchor" href="#arg-variable"></a></dt>
<dd><p>Numeric vector. Input time series (regularly spaced, no missing
values). Minimum length is 16 observations.</p></dd>


<dt id="arg-signif-level">signif.level<a class="anchor" aria-label="anchor" href="#arg-signif-level"></a></dt>
<dd><p>Numeric scalar in (0, 1). Significance level for wavelet
power and global wavelet spectrum tests. Default is 0.90.</p></dd>


<dt id="arg-noise-type">noise.type<a class="anchor" aria-label="anchor" href="#arg-noise-type"></a></dt>
<dd><p>Character. Background noise model for significance testing.
One of <code>"white"</code> or <code>"red"</code> (default). For red noise, an AR(1) model
is estimated using Yule-Walker.</p></dd>


<dt id="arg-period-lower-limit">period.lower.limit<a class="anchor" aria-label="anchor" href="#arg-period-lower-limit"></a></dt>
<dd><p>Numeric scalar. Minimum Fourier period (in time units)
to consider when identifying significant scales. Default is 2.</p></dd>


<dt id="arg-detrend">detrend<a class="anchor" aria-label="anchor" href="#arg-detrend"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, removes a linear trend **slope only**
(preserves the series mean level) before wavelet analysis. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-mode">mode<a class="anchor" aria-label="anchor" href="#arg-mode"></a></dt>
<dd><p>Character. Computation mode: <code>"fast"</code> (default) for speed-optimized
filtering with essential outputs only, or <code>"complete"</code> for comprehensive analysis
including reconstruction and diagnostics. Fast mode returns 9 outputs (~50 KB),
complete mode returns 18+ outputs (~5 MB). Fast mode is ~3x faster by skipping
signal reconstruction and detailed diagnostics.</p></dd>


<dt id="arg-return-diagnostics">return_diagnostics<a class="anchor" aria-label="anchor" href="#arg-return-diagnostics"></a></dt>
<dd><p>Logical. DEPRECATED. Use <code>mode = "complete"</code> instead.
If <code>TRUE</code>, forces complete mode and returns internal diagnostic quantities.</p></dd>


<dt id="arg-return-recon-error">return_recon_error<a class="anchor" aria-label="anchor" href="#arg-return-recon-error"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, returns scalar reconstruction
error metrics verifying closure of reconstructed components.</p></dd>


<dt id="arg-lag-ci">lag1_ci<a class="anchor" aria-label="anchor" href="#arg-lag-ci"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, computes a bootstrap confidence interval
for the AR(1) coefficient (diagnostic only; does not affect inference).</p></dd>


<dt id="arg-lag-ci-level">lag1_ci_level<a class="anchor" aria-label="anchor" href="#arg-lag-ci-level"></a></dt>
<dd><p>Numeric scalar in (0, 1). Confidence level for the AR(1)
bootstrap interval. Default is 0.95.</p></dd>


<dt id="arg-lag-boot-n">lag1_boot_n<a class="anchor" aria-label="anchor" href="#arg-lag-boot-n"></a></dt>
<dd><p>Integer. Number of bootstrap replicates used to estimate the
AR(1) confidence interval. Default is 500.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Optional numeric scalar. Random seed for reproducible bootstrap
diagnostics. Default is <code>NULL</code>.</p></dd>


<dt id="arg-warn-neff">warn_neff<a class="anchor" aria-label="anchor" href="#arg-warn-neff"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), emits a warning when the
effective sample size is small for most scales.</p></dd>


<dt id="arg-neff-warn-min">neff_warn_min<a class="anchor" aria-label="anchor" href="#arg-neff-warn-min"></a></dt>
<dd><p>Numeric scalar. Threshold below which neff is considered
small. Default is 5.</p></dd>


<dt id="arg-neff-warn-frac">neff_warn_frac<a class="anchor" aria-label="anchor" href="#arg-neff-warn-frac"></a></dt>
<dd><p>Numeric scalar in (0, 1). Fraction of scales with
<code>neff &lt; neff_warn_min</code> required to trigger a warning. Default is 0.60.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with outputs depending on mode:</p>
<p><strong>Fast mode (9 outputs):</strong></p><dl><dt>gws</dt>
<dd><p>Numeric vector. COI-masked global wavelet spectrum.</p></dd>

  <dt>gws_unmasked</dt>
<dd><p>Numeric vector. Unmasked global wavelet spectrum (plotting only).</p></dd>

  <dt>gws_period</dt>
<dd><p>Numeric vector. Fourier periods corresponding to wavelet scales.</p></dd>

  <dt>gws_signif</dt>
<dd><p>Numeric vector. COI- and neff-corrected significance threshold (inference).</p></dd>

  <dt>gws_signif_unmasked</dt>
<dd><p>Numeric vector. Unmasked significance threshold (plotting only).</p></dd>

  <dt>has_significance</dt>
<dd><p>Logical. Indicates whether any significant scales were found.</p></dd>

  <dt>signif_periods</dt>
<dd><p>Integer vector. Indices of significant wavelet scales.</p></dd>

  <dt>coi</dt>
<dd><p>Numeric vector. Cone of influence in time units.</p></dd>

  <dt>power</dt>
<dd><p>Numeric matrix. Wavelet power spectrum (for basic plotting).</p></dd>


</dl><p><strong>Complete mode (additional 10+ outputs):</strong></p><dl><dt>power_coi</dt>
<dd><p>Numeric matrix. COI-masked wavelet power.</p></dd>

  <dt>sigm</dt>
<dd><p>Numeric matrix. Pointwise significance ratio (unmasked).</p></dd>

  <dt>sigm_coi</dt>
<dd><p>Numeric matrix. COI-masked pointwise significance ratio.</p></dd>

  <dt>power_signif_coi</dt>
<dd><p>Logical matrix. COI-masked pointwise significance mask.</p></dd>

  <dt>wave</dt>
<dd><p>Complex matrix. Wavelet coefficients (scales x time).</p></dd>

  <dt>comps</dt>
<dd><p>Numeric matrix. Reconstructed components at significant scales plus residual.</p></dd>

  <dt>comps_names</dt>
<dd><p>Character vector. Column names of comps.</p></dd>

  <dt>gws_n_coi</dt>
<dd><p>Numeric vector. Number of time points inside the COI per scale.</p></dd>

  <dt>gws_neff</dt>
<dd><p>Numeric vector. Effective sample size per scale (masked).</p></dd>

  <dt>gws_neff_unmasked</dt>
<dd><p>Numeric vector. Effective sample size per scale (unmasked).</p></dd>

  <dt>diagnostics</dt>
<dd><p>List. Returned only if <code>return_diagnostics = TRUE</code>.</p></dd>

  <dt>reconstruction_error</dt>
<dd><p>List. Returned only if <code>return_recon_error = TRUE</code>.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The implementation follows Torrence &amp; Compo (1998) for the Morlet wavelet,
with the following methodological refinements:</p><ul><li><p>two-sided (TC98-consistent) wavelet normalization,</p></li>
<li><p>COI-masked global wavelet spectrum,</p></li>
<li><p>effective degrees of freedom based on wavelet decorrelation time,</p></li>
<li><p>separation of inference curves from plotting curves.</p></li>
</ul><p>Reconstructed components correspond to **individual wavelet scales** and are
additive but not orthogonal. They should not be interpreted as independent
stochastic modes.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Torrence, C., &amp; Compo, G. P. (1998). A practical guide to wavelet analysis.
<em>Bulletin of the American Meteorological Society</em>, 79(1), 61-78.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="morlet_wavelet.html">morlet_wavelet</a></code>, <code><a href="extract_wavelet_components.html">extract_wavelet_components</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by M.Umit Taner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

