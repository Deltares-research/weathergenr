<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Apply Climate Change Perturbations to Gridded Weather Data — apply_climate_perturbations • weathergenr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Apply Climate Change Perturbations to Gridded Weather Data — apply_climate_perturbations"><meta name="description" content="Applies climate change perturbations to gridded daily weather data by modifying
precipitation and temperature using monthly change factors. Perturbations can be
applied as step changes or gradual transient changes. Both approaches are
constructed to yield the same mean change over the simulation period."><meta property="og:description" content="Applies climate change perturbations to gridded daily weather data by modifying
precipitation and temperature using monthly change factors. Perturbations can be
applied as step changes or gradual transient changes. Both approaches are
constructed to yield the same mean change over the simulation period."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">weathergenr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Apply Climate Change Perturbations to Gridded Weather Data</h1>

      <div class="d-none name"><code>apply_climate_perturbations.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies climate change perturbations to gridded daily weather data by modifying
precipitation and temperature using monthly change factors. Perturbations can be
applied as step changes or gradual transient changes. Both approaches are
constructed to yield the same mean change over the simulation period.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apply_climate_perturbations</span><span class="op">(</span></span>
<span>  climate.data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  climate.grid <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sim.dates <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  change.factor.precip.mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  change.factor.precip.variance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  change.factor.temp.mean <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transient.temp.change <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  transient.precip.change <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  calculate.pet <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fit.method <span class="op">=</span> <span class="st">"mme"</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-climate-data">climate.data<a class="anchor" aria-label="anchor" href="#arg-climate-data"></a></dt>
<dd><p>List of data frames, one per grid cell. Each data frame must
contain columns <code>precip</code>, <code>temp</code>, <code>temp_min</code>, <code>temp_max</code>,
and optionally <code>pet</code>.</p></dd>


<dt id="arg-climate-grid">climate.grid<a class="anchor" aria-label="anchor" href="#arg-climate-grid"></a></dt>
<dd><p>Data frame containing grid cell metadata. Must include a
column <code>y</code> representing latitude in decimal degrees.</p></dd>


<dt id="arg-sim-dates">sim.dates<a class="anchor" aria-label="anchor" href="#arg-sim-dates"></a></dt>
<dd><p>Vector of <code>Date</code> objects corresponding to the rows of each
element in <code>climate.data</code>.</p></dd>


<dt id="arg-change-factor-precip-mean">change.factor.precip.mean<a class="anchor" aria-label="anchor" href="#arg-change-factor-precip-mean"></a></dt>
<dd><p>Numeric vector of length 12. Monthly
multiplicative factors for precipitation mean representing the desired average
change over the simulation period.</p></dd>


<dt id="arg-change-factor-precip-variance">change.factor.precip.variance<a class="anchor" aria-label="anchor" href="#arg-change-factor-precip-variance"></a></dt>
<dd><p>Numeric vector of length 12. Monthly
multiplicative factors applied to precipitation variance.</p></dd>


<dt id="arg-change-factor-temp-mean">change.factor.temp.mean<a class="anchor" aria-label="anchor" href="#arg-change-factor-temp-mean"></a></dt>
<dd><p>Numeric vector of length 12. Monthly additive
temperature changes in degrees Celsius representing the desired average change.</p></dd>


<dt id="arg-transient-temp-change">transient.temp.change<a class="anchor" aria-label="anchor" href="#arg-transient-temp-change"></a></dt>
<dd><p>Logical. If TRUE, temperature changes increase
linearly from zero to twice the specified factor so that the target mean change
is achieved. If FALSE, the full factor is applied uniformly.</p></dd>


<dt id="arg-transient-precip-change">transient.precip.change<a class="anchor" aria-label="anchor" href="#arg-transient-precip-change"></a></dt>
<dd><p>Logical. If TRUE, precipitation change factors
increase linearly from 1.0 to a calculated endpoint that yields the target mean.
If FALSE, the full factor is applied uniformly.</p></dd>


<dt id="arg-calculate-pet">calculate.pet<a class="anchor" aria-label="anchor" href="#arg-calculate-pet"></a></dt>
<dd><p>Logical. If TRUE, potential evapotranspiration is
recalculated from perturbed temperatures using the Hargreaves method.</p></dd>


<dt id="arg-fit-method">fit.method<a class="anchor" aria-label="anchor" href="#arg-fit-method"></a></dt>
<dd><p>Character string specifying the distribution fitting method
passed to <code>quantile_mapping</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If TRUE, progress messages are printed.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of data frames with the same structure as <code>climate.data</code>,
  containing perturbed weather variables. Invalid values are replaced with zero.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Climate change perturbations are applied using the following mechanisms:</p>
<ul><li><p>Precipitation is adjusted using quantile mapping with mean and variance scaling.</p></li>
<li><p>Temperature variables are adjusted using additive monthly shifts.</p></li>
<li><p>Potential evapotranspiration is recalculated using the Hargreaves equation
  when requested.</p></li>
</ul><p>Step and transient perturbations are formulated to produce the same mean change
over the full simulation period. Step changes apply the specified factor
uniformly across all years. Transient changes increase linearly from a baseline
to an endpoint that yields the same mean effect.</p>
<p>For precipitation, transient factors ramp from 1.0 to a computed upper value.
For temperature, transient changes ramp from zero to twice the specified mean
change. This ensures comparability between step and transient scenarios while
representing different temporal pathways.</p>
<p>During transient precipitation adjustments, a minimum factor of 0.01 is enforced
to prevent numerical instabilities.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="quantile_mapping.html">quantile_mapping</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">perturbed_step</span> <span class="op">&lt;-</span> <span class="fu">apply_climate_perturbations</span><span class="op">(</span></span></span>
<span class="r-in"><span>  climate.data <span class="op">=</span> <span class="va">weather_grids</span>,</span></span>
<span class="r-in"><span>  climate.grid <span class="op">=</span> <span class="va">grid_meta</span>,</span></span>
<span class="r-in"><span>  sim.dates <span class="op">=</span> <span class="va">dates</span>,</span></span>
<span class="r-in"><span>  change.factor.precip.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  change.factor.precip.variance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  change.factor.temp.mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2.0</span>, <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  transient.temp.change <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>  transient.precip.change <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by M.Umit Taner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

